{"version":3,"sources":["lib/assets/ButtonContent.tsx","lib/assets/GoogleIcon.tsx","lib/utils/SynapseConstants.ts","lib/utils/SynapseClient.ts","lib/containers/Login.tsx","lib/containers/EntityForm.tsx","lib/containers/colorPalette.ts","lib/containers/ColorGradient.tsx","lib/utils/modules/rollupCompatibleModules.ts","lib/utils/modules/queryUtils.ts","lib/utils/modules/facetUtils.ts","lib/containers/row_renderers/utils/CardFooter.tsx","lib/containers/row_renderers/utils/ChipContainer.tsx","lib/containers/row_renderers/utils/Icon.tsx","lib/containers/row_renderers/utils/ShowMore.tsx","lib/containers/HeaderCard.tsx","lib/containers/GenericCard.tsx","lib/utils/modules/sqlFunctions.ts","lib/containers/ModalDownload.FormSchema.ts","lib/containers/ModalDownload.tsx","lib/containers/EntityLink.tsx","lib/containers/TotalQueryResults.tsx","lib/containers/getUserData.tsx","lib/containers/UserCardSmall.tsx","lib/containers/UserCardContextMenu.tsx","lib/containers/UserCardLarge.tsx","lib/assets/icons/IconCopy.tsx","lib/containers/UserCardMedium.tsx","lib/containers/UserCard.tsx","lib/containers/SynapseTable.tsx","lib/containers/Facets.tsx","lib/containers/QueryCount.tsx","lib/containers/QueryWrapper.tsx","lib/containers/StackedBarChart.tsx","lib/containers/calculateFriendlyFileSize.tsx","lib/containers/row_renderers/Dataset.tsx","lib/containers/row_renderers/Funder.tsx","lib/containers/row_renderers/Publication.tsx","lib/containers/row_renderers/Study.tsx","lib/containers/row_renderers/Tool.tsx","lib/containers/row_renderers/AMPAD/Consortium.tsx","lib/containers/UserCardList.tsx","lib/containers/CardContainer.tsx","lib/containers/Search.tsx","lib/containers/QueryWrapperMenu.tsx","lib/containers/Uploader.tsx","lib/containers/FileContentDownloadUploadDemo.tsx","lib/containers/StatisticsPlot.tsx","demo/containers/Demo.tsx","demo/containers/playground/QueryWrapperMenuDemo.tsx","lib/containers/CardContainerLogic.tsx","lib/utils/jsonResponses/FileHandleAssociation.ts","lib/containers/widgets/Bookmarks.tsx","lib/containers/widgets/SynapseImage.tsx","lib/containers/widgets/SynapsePlot.tsx","lib/containers/drug_upload_tool/types.ts","lib/containers/MarkdownSynapse.tsx","lib/containers/drug_upload_tool/Header.tsx","lib/containers/drug_upload_tool/StepsSideNav.tsx","lib/containers/drug_upload_tool/NavButtons.tsx","lib/containers/drug_upload_tool/DataDebug.tsx","lib/containers/drug_upload_tool/SummaryTable.tsx","lib/containers/drug_upload_tool/WarningModal.tsx","lib/containers/drug_upload_tool/DrugUploadForm.tsx","lib/utils/jsonResponses/Forms.ts","lib/containers/drug_upload_tool/DrugUploadTool.tsx","lib/containers/drug_upload_tool/UserFileGrid.tsx","lib/containers/RssFeed.tsx","lib/containers/TwitterFeed.tsx","lib/containers/NewsFeedMenu.tsx","demo/containers/playground/CardContainerLogicDemo.tsx","demo/containers/playground/SearchDemo.tsx","demo/containers/playground/ModalDownloadDemo.tsx","demo/containers/playground/UserCardDemo.tsx","demo/containers/playground/MarkdownSynapseDemo.tsx","demo/containers/playground/NewsFeedDemo.tsx","demo/containers/playground/FormServicesIntegrationDemo.tsx","demo/containers/playground/Playground.tsx","demo/containers/App.tsx","index.tsx","lib/assets/icons/Data2.svg","images/logo.svg","lib/assets/icons/columns.svg","lib/assets/icons/expand.svg","lib/assets/icons/shrink.svg","lib/assets/icons/Publication.svg","lib/assets/icons/study-active.svg","lib/assets/icons/study.svg","lib/assets/icons/study-complete.svg","lib/assets/icons/DNA_Two.svg","lib/assets/icons/ToolClinical.svg","lib/assets/icons/ToolComputational.svg","lib/assets/icons/ToolExperimental.svg","lib/assets/icons/project.svg","lib/assets/logos/ctf.svg","lib/assets/logos/dhart.svg","lib/assets/logos/ntap.svg","lib/assets/icons/AMP_AD/consortia-icons/amp-icon-header.svg","lib/assets/icons/AMP_AD/consortia-icons/amp-icon.svg","lib/assets/icons/AMP_AD/consortia-icons/move-icon-header.svg","lib/assets/icons/AMP_AD/consortia-icons/move-icon.svg","lib/assets/icons/AMP_AD/consortia-icons/ModelAD-icon-header.svg","lib/assets/icons/AMP_AD/consortia-icons/ModelAD-icon.svg","lib/assets/icons/AMP_AD/consortia-icons/resilience-icon-header.svg","lib/assets/icons/AMP_AD/consortia-icons/resilience-icon.svg","lib/assets/icons/json-form-tool-no-submissions.svg","demo/containers/playground/icons/brain.svg","demo/containers/playground/icons/circle.svg","demo/containers/playground/icons/mouse.svg","demo/containers/playground/icons/resiliencead.svg"],"names":["children","style","paddingRight","fontWeight","paddingLeft","icon","paddingTop","paddingBottom","textAlign","width","active","background","borderRadius","height","xmlns","fill","fillRule","d","BUNDLE_MASK_QUERY_RESULTS","BUNDLE_MASK_QUERY_COUNT","BUNDLE_MASK_QUERY_SELECT_COLUMNS","BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE","BUNDLE_MASK_QUERY_COLUMN_MODELS","BUNDLE_MASK_QUERY_FACETS","ENTITY_BUNDLE_MASK_ENTITY","ENTITY_BUNDLE_MASK_ANNOTATIONS","ENTITY_BUNDLE_MASK_PERMISSIONS","ENTITY_BUNDLE_MASK_ENTITY_PATH","ENTITY_BUNDLE_MASK_HAS_CHILDREN","ENTITY_BUNDLE_MASK_ACL","ENTITY_BUNDLE_MASK_FILE_HANDLES","ENTITY_BUNDLE_MASK_TABLE_DATA","ENTITY_BUNDLE_MASK_ROOT_WIKI_ID","ENTITY_BUNDLE_MASK_BENEFACTOR_ACL","ENTITY_BUNDLE_MASK_DOI","ENTITY_BUNDLE_MASK_FILE_NAME","ENTITY_BUNDLE_MASK_THREAD_COUNT","ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION","STUDY","STUDY_ACTIVE","STUDY_COMPLETE","DATASET","AMP_CONSORTIUM","FUNDER","PUBLICATION","TOOL","GENERIC_CARD","COMPUTATIONAL","EXPERIMENTAL","CLINICAL","PROJECT","PAGE_SIZE","SMALL_USER_CARD","MEDIUM_USER_CARD","LARGE_USER_CARD","SEPERATOR","AUTHENTICATED_USERS","_TIME_DELAY","SRC_SIGN_IN_CLASS","IS_DEV_ENV","DEV_ENV_SESSION_LOCAL_STORAGE_KEY","DEFAULT_ENDPOINT","DEFAULT_SWC_ENDPOINT","AUTH_PROVIDER","SYNAPSE_STORAGE_LOCATION_ID","getRootURL","portString","window","location","port","protocol","hostname","delay","t","Promise","resolve","setTimeout","bind","fetchWithExponentialTimeout","url","options","delayMs","retries","fetch","then","resp","status","text","parsedJson","JSON","parse","err","console","log","catch","reject","reason","statusText","statusCode","json","error","ok","doPost","requestJsonObject","sessionToken","initCredentials","endpoint","body","stringify","headers","Accept","method","mode","credentials","doGet","doDelete","doPut","putRefreshSessionToken","undefined","getVersion","getDownloadFromTableRequest","request","updateParentState","entityId","requestUrl","token","getAsyncResultFromJobId","getFileHandleById","handleId","getFileHandleByIdURL","urlRequest","jobState","asyncJobStatus","getQueryTableResults","queryBundleRequest","getFullQueryTableResults","a","query","rest","data","queryRequest","limit","maxPageSize","initData","queryCount","queryResult","queryResults","rows","length","currentQueryCount","getData","maxRowsPerPage","queryRequestWithMaxPageSize","offset","postData","push","login","username","password","oAuthUrlRequest","provider","redirectUrl","oAuthSessionRequest","authenticationCode","createEntity","entity","createProject","name","concreteType","getUserProfile","getUserProfileById","ownerId","getUserBundle","id","mask","getGroupHeadersBatch","ids","join","getUserProfiles","list","getEntityChildren","lookupChildEntity","getFiles","getEntity","getEntityHeader","references","updateEntity","deleteEntity","getEntityBundleForVersion","version","partsMask","getEntityWiki","wikiId","getUserFavorites","getUserProjectList","projectDetails","getUserTeamList","getTeamList","fragment","getWikiAttachmentsFromEntity","getWikiAttachmentsFromEvaluation","setSessionTokenCookie","swcEndpoint","localStorage","setItem","removeItem","getSessionTokenFromCookie","getItem","getPrincipalAliasRequest","alias","type","detectSSOCode","redirectURL","code","URL","href","searchParams","get","synToken","originalUrl","replace","errSetSession","signOut","reload","uploadFile","filename","file","fileUploadResolve","fileUploadReject","partSize","Math","max","size","contentType","fileName","fileSizeBytes","partSizeBytes","storageLocationId","calculateMd5","md5","contentMD5Hex","startMultipartUpload","fileBlob","bmf","browserMd5File","progress","processFilePart","partNumber","multipartUploadStatus","clientSidePartsState","uploadId","presignedUploadUrlRequest","partNumbers","presignedUrlUrl","presignedUrlResponse","presignedUrl","partPresignedUrls","uploadPresignedUrl","startByte","endByte","fileSlice","slice","uploadFilePart","addPartUrl","addPartResponse","addPartState","checkUploadComplete","fileHandleName","every","v","newStatus","fileHandleId","resultFileHandleId","partsState","split","map","bit","i","getFileEntityContent","fileEntity","fileHandleAssociationList","associateObjectId","associateObjectType","dataFileHandleId","includeFileHandles","includePreSignedURLs","includePreviewPreSignedURLs","requestedFiles","preSignedURL","fileHandle","getFileHandleContent","content","getFileHandleContentFromID","getFileHandleByIdPromise","getFileHandlePresignedUrlPromis","all","values","contentSize","cache","response","createACL","acl","submitToEvaluation","submission","etag","getEvaluation","evalId","getEvaluationSubmissions","encodeURI","getOAuth2RequestDescription","oidcAuthRequest","getOAuth2Client","clientId","consentToOAuth2Request","createFormGroup","getFormACL","formGroupId","updateFormACL","newAcl","createFormData","newFormData","updateFormData","formDataId","updatedFormData","deleteFormData","submitFormData","listFormData","listFormDataAsFormAdmin","acceptFormData","rejectFormData","formRejection","getProjectStatistics","Login","props","state","email","errorMessage","hasLoginInFailed","isSignedIn","handleChange","handleLogin","getTokenView","getLoginFailureView","onSignIn","event","target","currentTarget","value","newState","this","setState","clickEvent","preventDefault","repoEndpoint","SynapseClient","className","googleRedirectUrl","authUrl","authorizationUrl","theme","googleTheme","onClick","GoogleIcon","key","ButtonContent","marginRight","alt","src","onSubmit","autoComplete","placeholder","onChange","React","EntityForm","formRef","submitForm","current","submit","refresh","promises","formSchemaEntityId","formUiSchemaEntityId","userprofile","getTargetContainer","targetContainerId","formSchemaFileEntity","formUiSchemaFileEntity","getSchemaFileContent","onError","targetFolderId","formSchemaContent","formUiSchemaContent","getExistingFileData","formData","currentFileEntity","entityLookupRequest","entityName","title","parentId","initFormData","existingFileData","finally","formSchema","formUiSchema","parentContainerId","containerId","isLoading","Error","finishedProcessing","successfullyUploaded","submissionFileAndForm","Blob","createEntityFile","fileContentsBlob","fileUploadComplete","newFileHandleId","newFileEntity","synIdCallback","prevProps","message","schema","uiSchema","showErrorList","ref","display","marginLeft","COLOR_PALETTE_EVEN","COLOR_PALETTE_ODD","getColorPallette","start","end","colorPalleteSelection","textColors","colorPalette","textColor","color","cloneDeep","x","cloneDeepProxy","getNextPageOfData","newData","oldData","hasMoreData","SynapseConstants","getIsValueSelected","lastFacetSelection","curFacetSelection","columnName","facetValue","isSelected","selector","SELECT_SINGLE_FACET","readFacetValues","htmlCheckboxes","facet","facetValues","checkbox","checked","newQueryRequest","selectedFacets","specificFacet","find","el","facetColumnValuesRequest","library","add","faLongArrowAltUp","faLongArrowAltDown","URL_REGEX","CardFooter","renderRowValue","textColorClass","isHeader","match","DOI_REGEX","data-search-handle","rel","renderRows","isDesktop","kv","index","hideClass","isShowMoreOn","toggleShowMore","updatePredicate","addEventListener","removeEventListener","innerWidth","secondaryLabelLimit","valuesFiltered","filter","hasMoreValuesThanLimit","Infinity","margin","padding","ChipContainer","chipsFormatted","chips","defaultIcons","PublicationSvg","Data2Svg","studyActiveSvg","studyCompleteSvg","studySvg","DNA_TwoSvg","ToolExperimentalSvg","ToolComputationalSvg","ToolClinicalSvg","projectSvg","Icon","iconOptions","iconSet","datasetIconClass","CHAR_COUNT_CUTOFF","ShowMore","getCutoff","summary","previewText","hiddenText","summarySplit","showMore","meetsCharRequirements","showMoreButton","fontSize","cursor","HeaderCard","subTitle","description","iconValue","backgroundColor","borderTop","marginTop","SYNAPSE_REGX","GenericCard","trim","showMoreDescription","createTitleLink","createLabelLink","link","titleLink","linkDisplay","urlParams","URLColumnNames","hasOwnProperty","baseURL","labelLink","urlColumn","genericCardSchema","titleLinkConfig","labelLinkConfig","facetAliases","linkValue","secondaryLabels","matchColumnName","keyValue","showFooter","marginBottom","titleSearchHandle","stubTitleSearchHandle","descriptionSubTitle","GROUP_BY_REGEX","isGroupByInSql","sql","test","generateTokenUsingOperator","literal","operator","usedMatchForLike","substring","insertConditionsFromSearchParams","tokens","lexer","tokenize","foundIndex","findIndex","whereClauseIndex","indexAfterWhereClause","splice","searchParamsLen","Object","keys","forEach","unshift","formatSQLFromParser","synId","newSql","parser","toString","splitString","writeHeaderOption","includeRowIdAndRowVersionOption","csvOption","formSchemaArray","properties","oneOf","const","Contents","items","enum","uniqueItems","formSchemaUIArray","faTimes","ModalDownload","handleSubmit","step","handleDownloadSetup","onDownload","fileType","contents","onClose","separator","downloadFromTableRequest","writeHeader","includes","includeRowIdAndRowVersion","csvTableDescriptor","resultsFileHandleId","role","tabIndex","position","top","right","zIndex","backgroundSize","faLink","faFolder","faFile","faListAlt","faTable","faThList","faArchive","EntityTypeIcon","splitType","iconType","getIconTypeForEntity","EntityLink","entityHeader","TotalQueryResults","total","calculateTotal","facets","curFacetsIndex","facetType","curFacets","anyTrue","totalAllFalseCase","totalStandardCase","count","unitDescription","frontText","loader","getUserProfileWithProfilePicAttached","principalIds","withProfilePic","profilePicureFileHandleId","fileHandleList","matchingPersonIndex","clientPreSignedURL","getUserProfileWithProfilePic","userProfile","firstElement","COLORS","getColor","userName","hashedUserName","val","reduce","prevHash","currVal","charCodeAt","abs","hash","faCircle","UserCardSmall","img","hideText","hideTooltip","linkLocation","label","displayName","firstName","lastName","backgroundImage","data-for","data-tip","delayShow","multiline","whiteSpace","UserCardContextMenu","menuActions","aria-labelledby","menuAction","callback","field","listStyle","onKeyPress","UserCardLarge","industry","faEllipsisV","faCopy","svg","viewBox","UserCardMedium","htmlDivRef","copyToClipboard","document","createElement","setAttribute","left","appendChild","select","execCommand","removeChild","showModal","toggleContextMenu","_event","isContextMenuOpen","pageClick","isLarge","hideEmail","disableLink","company","mediumCard","classNames","timeout","enter","exit","IconCopy","outline","fixedWidth","boxShadow","border","UserCard","aliasData","principalId","userProfileAtRender","preSignedURLAtRender","loadingScreen","propsForChild","MIN_SPACE_FACET_MENU","faColumns","faSort","faSortAmountUp","faSortAmountDown","faCheck","faFilter","faDownload","faUsers","faGlobeAmericas","NEXT","PREVIOUS","SELECT_ALL","DOWNLOAD_FILES_MENU_TEXT","ICON_STATE","SORT_STATE","DOWNLOAD_OPTIONS_CONTAINER_CLASS","EXPAND_CLASS","TOOLTIP_DELAY_SHOW","SynapseTable","toggleStateVariables","updatedState","showGroupRowData","selectedRow","queryCopy","getLastQueryRequest","columnModels","parsed","getSqlUnderlyingDataForRow","queryJSON","encodedQuery","btoa","open","renderDropdownDownloadOptions","isDropdownDownloadOptionsOpen","toggleStateArgs","isExpanded","place","effect","advancedSearch","renderDropdownColumnMenu","isDropdownColumnMenuOpen","addRemoveColClasses","ColumnsSvg","renderDropdownColumnMenuItems","renderTable","pastZero","previous","handlePaginationClick","next","minHeight","createTableHeader","createTableRows","renderTableTop","rgbIndex","ShrinkSvg","ExpandSvg","eventType","currentOffset","executeQueryRequest","handleColumnSortPress","dict","_","columnIconSortState","Array","getLengthOfPropsData","sortedColumnSelection","findSelectionIndex","column","direction","sort","header","isColumnSelected","visibleColumnCount","iconStyle","visibility","maybeShowPrimaryColor","toggleColumnSelection","defaultSelection","lengthOfPropsData","applyChanges","from","querySelectorAll","isAllFilterSelectedForFacet","toggleFilterDropdown","isCurFilterSelected","refOuterDiv","activeFilterClass","parentElement","getBoundingClientRect","activeFilterIndex","isMenuWallOpen","configureFacetDropdown","closeAllDropdowns","isModalDownloadOpen","mapEntityIdToHeader","mapUserIdToHeader","renderFacetSelection","getEntityHeadersInData","getColumnIndiciesWithType","entityIdColumnIndicies","userIdColumnIndicies","distinctEntityIds","getUniqueEntities","distinctUserIds","referenceList","targetId","results","idsWithUserProfiles","isIndividual","mapIdToHeader","indicies","distinctEntities","Set","row","colIndex","prototype","call","columnType","columnsOfTypeEntity","selectColumns","synapseId","showBarChart","Modal","animation","centered","show","onHide","dialogClassName","Header","closeButton","Body","originalSql","indexes","selectIndex","fromIndex","columnIndex","toLowerCase","matchingColumnModel","columnModel","rowValue","pop","rowsFormatted","entityColumnIndicies","userColumnIndicies","isColumnSelectedLen","countColumnIndexes","getCountFunctionColumnIndexes","rowIndex","rowContent","columnValue","isColumnActiveInitLoad","isColumnActivePastInitLoad","isCountColumn","isBold","renderTableCell","rowFormatted","rowId","usedVisibleColumnCount","initRender","subsequentRender","facetIndex","facetColumnResult","isFacetSelection","isSelectedIconClass","sortSpanBackgoundClass","synTable","facetColumnResults","applyPrimary","classList","isChecked","alignItems","listStyleType","facetColumnResultValueCount","displayValue","isValueSelected","faPlus","CheckboxGroup","showAllFacets","isAllFilterSelected","b","facetColumnResultValues","curColor","backgroundClass","childrenView","child","Facets","chartSelectionIndex","showButtons","curFacetsLength","curFacet","showFacetFilter","QueryCount","calculateRowCount","partMask","toLocaleString","QueryWrapper","executeInitialQueryRequest","getInitQueryRequest","initialState","loadNow","loadNowStarted","initQueryRequest","lastQueryRequest","isLoadingNewData","isAllFalse","isAllTrue","isByDefaultSelected","update","childrenWithProps","isQueryWrapperChild","loadingCusrorClass","showMenu","defaultProps","faAngleLeft","faAngleRight","PREVIOUS_ITEM_CLICK","StackedBarChart","handleClick","handleArrowClick","extractPropsData","handleHover","handleExit","getTextForChartSelection","onMeasureResize","rgba2rgb","dimensions","bounds","bottom","xData","facetValueDisplay","filterDisplay","alpha","floor","progressMessage","originalColor","onResize","contentRect","measureRef","obj","rectStyle","rgbColor","svgWidth","tooltipId","numCharsInValue","svgHeight","onMouseEnter","onMouseLeave","textAnchor","fontFamily","y","getFileCount","linkText","item","sufixes","Dataset","handleLinkClick","datasetName","tumorType","diseaseFocus","fundingAgency","fileCount","fileSize","bytes","pow","toFixed","calculateFriendlyFileSize","logoLinks","CTF","ctfSvg","dhartSvg","NTAP","ntapSvg","Funder","organizationName","organizationPath","website","abbreviation","logo","orgPath","origin","websiteDisplayName","charAt","showOrgLink","isOnOrgPath","Publication","citation","doi","projectName","Study","hasCreatedIndex","projectLeads","projectStatus","dataStatus","Tool","softwareName","softwareLink","Consortium","getIcon","org","ampIconHeaderSvg","ampIconSvg","moveIconHeaderSvg","moveIconSvg","ModelADIconHeaderSvg","ModelADIconSvg","resilienceIconHeaderSvg","resilienceIconSvg","Program","path","Path","UserCardList","userProfileMap","setA","setB","_difference","elem","delete","priorListOfIds","curListOfIds","difference","internalData","newEntries","firstNameIndex","lastNameIndex","institutionIndex","fauxUserProfilesList","manuallyExtractData","fauxUserProfileIndex","fauxUserProfile","CardContainer","renderCard","handleViewMore","element","cards","showViewMore","showViewMoreButton","userIdColumnIndex","listIds","rowData","propsForCard","faCaretDown","faCaretUp","faSearch","Search","toggleDropdown","isSearchableDropdownOpen","setDropdownIndex","dropdownIndex","highlightText","submittedSearchText","searchable","isQueryWrapperMenuChild","searchItem","span","outerHTML","innerText","searchItemView","querySelector","SEARCH_CLASS_CSS","textElement","innerHTML","regex","RegExp","search","searchText","lastQueryRequestDeepCopy","addEscapeCharacters","searchableItem","fieldStyle","liStyle","curFacetDisplayText","usedUnitDescription","flex","justifyContent","hintText","escapedSearchText","QueryWrapperMenu","handleHoverLogic","info","contains","tagName","switchFacet","menuIndexIn","accordionIndexIn","activeMenuIndices","isClickingCurrentSelection","accordionGroupIndex","toggleGroupAccordionIndex","accordionGroupIndexIn","accordionConfig","indexFromURLOrDefaultZero","Number","menuIndex","getUnitDescription","getPartMask","getSelectedFacets","getTableLoadingScreen","_prevState","stackedBarChartConfiguration","menuConfig","hasGroupByInSql","menuDropdown","renderMenuDropdown","queryWrapper","renderQueryChildren","queryConfig","groupIndex","isConsistent","cardConfiguration","tableConfiguration","searchConfiguration","menuIndexFromProps","config","showSearch","aliasedFacet","searchClass","tableLoadingScreen","isAccordionConfigDefined","renderQueryChild","isActive","primaryColor","indicatorClasses","borderTopColor","hoverEnter","hoverLeave","component","appear","renderFacetMenu","curLevel","defaultColor","searchIconStyle","opacity","isSearchConfig","selectedStyling","borderLeftColor","infoEnter","infoLeave","facetDisplayValue","Uploader","inputOpenFileRef","showOpenFileDlg","click","files","handleFilesChanged","finishedProcessingOneFile","incrementedFilesUploadedCount","filesUploadedCount","isStillUploading","totalFilesToUploadCount","isUploading","handleUploadError","selectorFiles","existingEntity","updateEntityFile","isCreate","multiple","FileContentDownloadUploadDemo","updateFileContent","targetEntity","fileContent","newFileContent","handleContentChange","targetEntityId","Plot","createPlotlyComponent","Plotly","StatisticsPlot","fetchPlotlyData","isLoaded","plotData","getTrace","traceName","stats","orientation","trace","statPoint","month","Date","rangeStart","filesCount","showPlot","xtitle","ytitle","isHorizontal","xaxistype","showlegend","layout","barmode","xaxis","yaxis","traces","fileDownloads","months","fileUploads","Demo","entityFormRef","handleCardSelection","cardSql","cardSelection","showMarkdown","showTabOne","tabOne","tabTwo","evaluationQueryString","makeSampleQueryCall","removeHandler","onSubmitEntityForm","onEntityFormSubmitted","onOAuth2RequestConsent","onGetEvaluationSubmissions","handleEvaluationQueryChange","userFormDataSynId","scope","claims","responseType","redirectUri","nonce","OAUTH2REQUEST","access_code","evaluationQueryResults","QUERY","includeEntityEtag","userFormSynLink","aria-hidden","objectId","QueryWrapperMenuDemo","experimentalSql","computationalSql","activeTab","tabThree","grant","CardContainerLogic","defaultState","sqlUsed","sqlOperator","queryRequestWithoutCount","totalResultsNoFacet","FileHandleAssociateType","Bookmarks","renderBookmarks","matchedGroup","copyFootnotes","String","footnotes","output","exec","isBeforeLastElement","dangerouslySetInnerHTML","__html","SynapseImage","getSynapseFiles","FileEntity","fileResults","WikiAttachment","params","align","alignLowerCase","StepStateEnum","NavActionEnum","StatusEnum","SynapsePlot","queryData","widgetparamsMapped","horizontal","j","rowValues","TOC_CLASS","1","2","3","4","5","6","md","markdownit","html","MarkdownSynapse","markupRef","markdownitSynapse","init_markdown_it","markdownitSub","markdownitSup","markdownitCentertext","markdownitSynapseHeading","markdownitSynapseTable","markdownitStrikethroughAlt","markdownitContainer","markdownitEmphasisAlt","markdownitInlineComments","markdownitBr","use","markdownitMath","markdown","fileHandles","handleLinkClicks","processWidgets","processWidgetOrDomElement","processMath","getWikiAttachments","getWikiPageMarkdown","renderWidget","renderSynapseButton","renderSynapseImage","renderSynapsePlot","renderSynapseTOC","getErrorView","createHTML","addBookmarks","addIdsToReferenceWidgets","addIdsToTocWidgets","genericElement","anchor","referenceNumber","goTo","scrollIntoView","behavior","block","inline","e","getAttribute","idOfContent","initText","render","sanitizeHtml","allowedAttributes","button","div","h1","h2","h3","h4","h5","h6","li","ol","table","th","thead","ul","allowedTags","katex","textContent","delimiters","throwOnError","resetFootnotes","footnotesHtml","wikiPage","errorMessageView","ErrorView","referenceCount","tocIdCount","curTocId","markup","widgets","xml","escapedOneToXmlSpecialMap","str","widgetMatch","originalMarkup","widgetParamsMatchWithXML","widgetParamsString","decodeXml","questionIndex","indexOf","widgetType","keyPair","decodeURIComponent","widgetsToBe","processWidgetMappings","reactKey","renderUserBadge","buttonClasses","highlight","elements","p1","p2","p3","p4","data-anchor","bodyText","StepsSideNav","nonChildSteps","stepList","isExcluded","isStatic","isSubmit","iconDef","flip","faBan","COMPLETED","faCheckCircle","ERROR","faExclamationCircle","getItemClass","isInProgress","liClassName","getListItem","isWizard","isRenderChild","renderStepName","inProgress","final","excluded","static","itemClass","onStepChange","isWizardMode","stepChildId","childStep","NavButtons","previousButton","previousStepIds","steps","currentStep","canGoBack","onNavAction","faChevronLeft","nextButton","faChevronRight","saveButton","disabled","isFormSubmitted","SAVE","NextStepLink","nextStep","nextStepId","DataDebug","myData","hidden","SummaryTable","flatFormData","flatData","flatten","object","flattenedObject","prefix","isArray","isString","isObject","isDate","boundary","screen","order","getFlatData","prevScreenId","line","screenId","callbackFn","faTrash","WarningModal","onCancel","Title","copy","Footer","variant","onOK","callbackArgs","confirmCopy","DrugUploadForm","excludeWarningText","excludeWarningHeader","unsavedDataWarning","navAction","NONE","onUnload","ev","hasUnsavedChanges","returnValue","setupBeforeUnloadListener","getSchema","pick","getNextStepId","rules","default","engine","Engine","run","result","events","moveStep","isError","previousStack","errorSchema","isMoveForwardInWizardMode","currentStepState","TODO","set","included","saveStepState","hasValidated","doShowErrors","goPrevious","previousStepId","isSubmitScreen","currentIndex","isUndefined","triggerAction","onSave","triggerStepChange","GO_TO_STEP","args","VALIDATE","modifiedSteps","setStepStatusForFailedValidation","errors","currentSchemaProperties","stepsWithError","trimStart","property","stepsInCurrentSchema","performAction","showExcludeStateWarningModal","stepId","isUpdateFlattenedData","modalContext","action","toggleExcludeStep","arguments","isExclude","prevState","stp","formDataUpdated","renderNotification","SAVE_SUCCESS","SUBMIT_SUCCESS","PROGRESS","renderTextForStaticScreen","renderOptionalFormSubheader","renderHelpToggle","showHelp","checkedIcon","uncheckedIcon","offColor","onColor","transformErrors","SUBMIT","parentPath","lastIndexOf","remove","renderErrorListTemplate","currentLis","propPath","propArr","labelFromSchema","regLabelFromUi","arrayLabelFromUi","definitions","renderTransformedErrorObject","stringToElementForProp","srcObject","some","k","navSchema","doShowHelp","shouldUpdate","callbackStatus","isSuccess","isSubmitted","history","back","isEmpty","defs","isEqual","hasError","when","formTitle","liveValidate","handleOnChange","form","ErrorList","formClass","DrugUploadTool","getFileEntityData","entityContent","versionNumber","formNavSchemaEntityId","configData","fileData","metadata","formSchemaVersion","uiSchemaVersion","navSchemaVersion","formNavSchema","notification","saveToFile","createOrUpdateFormDataFile","fileNamePath","isReadyToDisplayForm","ERROR_CRITICAL","renderLoader","dismissible","Heading","renderUnauthenticatedView","UserFileGrid","modalTitle","listingText","subhead","noRecords","submitted","modalCopy","getUserFileListing","groupId","requestInProgress","filterByState","WAITING_FOR_SUBMISSION","nextPageToken","requestSubmitted","SUBMITTED_WAITING_FOR_REVIEW","ACCEPTED","REJECTED","listInProgress","listSubmitted","fileList","page","deleteFile","setModalConfirmationState","renderLoading","renderSubmissionsTable","pathpart","textSource","tableTitleRow","dataFileRecord","moment","modifiedOn","calendar","aria-label","submissionStatus","isShowInfoModal","faPhone","renderSubmissionsTables","filesInProgress","filesSubmitted","NoSubmissionsIcon","itemNoun","rssParser","require","DOMParser","RssFeed","onToggleReadMore","itemId","feedItemContentDiv","getElementById","itemId2MoreItem","isShow","foundMoreItem","newText","newIcon","onClickShowMoreItems","isShowingMoreItems","rssFeed","isLoadingError","responseData","parseString","rss","parsedHtml","parseFromString","bodyElement","moreElement","foundMoreElement","isItemVisible","defaultItemsToShow","showMoreText","showMoreIcon","guid","documentElement","TwitterFeed","twttr","load","data-height","data-theme","NewsFeedMenu","switchFeed","renderMenu","feedName","feedDescription","feedUrl","mailChimpUrl","twitterFeedUrl","mailChimpListName","CardContainerLogicDemo","circleSvg","brainSvg","mouseSvg","resilienceadSvg","SearchDemo","commonCardProps","contributor","diagnosis","ModalDownloadDemo","onOpen","UserBadgeSmallDemo","profiles","_el","MarkdownSynapseDemo","markdownPropsArray","NewsFeedDemo","FormServicesIntegrationDemo","listMyFormData","formGroup","myFormDataList","listFormAdminFormData","formAdminFormDataList","onReadFormDataFileHandleContents","onCreateFormGroup","onCreateFormData","onUpdateFormData","onSubmitFormData","TokenContext","Consumer","rejectionMessage","App","to","exact","signedInState","notSignedInState","Provider","basename","process","logoSvg","renderLoginAndSignout","Playground","searchParamsProps","URLSearchParams","iter","entries","done","ReactDOM","module","exports"],"mappings":"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mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,gBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBAGIC,GAA+B,CACnC,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,gBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,iBACA,iBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,kBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,gBACA,kBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,kBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,kBACA,iBACA,iBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBACA,mBC9NK,SAASC,GAAiBC,EAAeC,GAC9C,IAAIC,EAAwB,GACtBC,EAAa,GACfvR,GA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","file":"static/js/main.0e8e1dc2.chunk.js","sourcesContent":["import * as React from 'react'\n\nexport default ({ children, icon }: { children: any, icon?: any }) => {\n  const style : React.CSSProperties = {\n    paddingRight: 10,\n    fontWeight: 500,\n    paddingLeft: icon ? 0 : 10,\n    paddingTop: 10,\n    paddingBottom: 10,\n    textAlign: 'center',\n    width: '100%'\n  }\n  return (\n    <span\n      style={style}\n    >\n      {children}\n    </span>\n  )\n}\n","import * as React from 'react'\n// @ts-nocheck\nexport default ({ active }: {active : boolean }) => (\n  <div\n    style={{\n      background: active ? '#fff' : '#eee',\n      paddingTop: 7,\n      paddingRight:10,\n      paddingBottom:4,\n      paddingLeft:10,\n      borderRadius: 2 }}\n  >\n    <svg width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\">\n      <g fill=\"#000\" fillRule=\"evenodd\">\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M9 3.48c1.69 0 2.83.73 3.48 1.34l2.54-2.48C13.46.89 11.43 0 9 0 5.48 0 2.44 2.02.96 4.96l2.91 2.26C4.6 5.05 6.62 3.48 9 3.48z\"\n          fill=\"#EA4335\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M17.64 9.2c0-.74-.06-1.28-.19-1.84H9v3.34h4.96c-.1.83-.64 2.08-1.84 2.92l2.84 2.2c1.7-1.57 2.68-3.88 2.68-6.62z\"\n          fill=\"#4285F4\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M3.88 10.78A5.54 5.54 0 0 1 3.58 9c0-.62.11-1.22.29-1.78L.96 4.96A9.008 9.008 0 0 0 0 9c0 1.45.35 2.82.96 4.04l2.92-2.26z\"\n          fill=\"#FBBC05\"\n        />\n        <path\n          // tslint:disable-next-line:max-line-length\n          d=\"M9 18c2.43 0 4.47-.8 5.96-2.18l-2.84-2.2c-.76.53-1.78.9-3.12.9-2.38 0-4.4-1.57-5.12-3.74L.97 13.04C2.45 15.98 5.48 18 9 18z\"\n          fill=\"#34A853\"\n        />\n        <path fill=\"none\" d=\"M0 0h18v18H0z\" />\n      </g>\n    </svg>\n  </div>\n)\n","import { UserCardSize } from '../containers/UserCard'\n\n/** QueryBundleRequest constants */\nexport const BUNDLE_MASK_QUERY_RESULTS: number = 1\nexport const BUNDLE_MASK_QUERY_COUNT: number = 2\nexport const BUNDLE_MASK_QUERY_SELECT_COLUMNS: number = 4\nexport const BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE: number = 8\nexport const BUNDLE_MASK_QUERY_COLUMN_MODELS: number = 16\nexport const BUNDLE_MASK_QUERY_FACETS: number = 32\n/** EntityBundle constants */\nexport const ENTITY_BUNDLE_MASK_ENTITY: number = 1\nexport const ENTITY_BUNDLE_MASK_ANNOTATIONS: number = 2\nexport const ENTITY_BUNDLE_MASK_PERMISSIONS: number = 4\nexport const ENTITY_BUNDLE_MASK_ENTITY_PATH: number = 8\nexport const ENTITY_BUNDLE_MASK_HAS_CHILDREN: number = 32\nexport const ENTITY_BUNDLE_MASK_ACL: number = 64\nexport const ENTITY_BUNDLE_MASK_FILE_HANDLES: number = 2048\nexport const ENTITY_BUNDLE_MASK_TABLE_DATA: number = 4096\nexport const ENTITY_BUNDLE_MASK_ROOT_WIKI_ID: number = 8192\nexport const ENTITY_BUNDLE_MASK_BENEFACTOR_ACL: number = 16384\nexport const ENTITY_BUNDLE_MASK_DOI: number = 32768\nexport const ENTITY_BUNDLE_MASK_FILE_NAME: number = 65536\nexport const ENTITY_BUNDLE_MASK_THREAD_COUNT: number = 131072\nexport const ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION: number = 262144\n/** Row Types  */\nexport const STUDY: string = 'study'\n// for study icons\nexport const STUDY_ACTIVE: string = 'study active'\nexport const STUDY_COMPLETE: string = 'study complete'\nexport const DATASET: string = 'dataset'\nexport const AMP_CONSORTIUM: string = 'AMP_Consortium'\nexport const FUNDER: string = 'funder'\nexport const PUBLICATION: string = 'publication'\nexport const TOOL: string = 'tool'\nexport const GENERIC_CARD: string = 'GENERIC_CARD'\nexport const COMPUTATIONAL: string = 'computational'\nexport const EXPERIMENTAL: string = 'experimental'\nexport const CLINICAL: string = 'clinical'\nexport const PROJECT: string = 'Project'\nexport const PAGE_SIZE: number = 25\n// For User Profile Cards\nexport const SMALL_USER_CARD: UserCardSize = 'SMALL USER CARD'\nexport const MEDIUM_USER_CARD: UserCardSize = 'MEDIUM USER CARD'\nexport const LARGE_USER_CARD: UserCardSize = 'LARGE USER CARD'\nexport const SEPERATOR = 'SEPERATOR'\nexport const AUTHENTICATED_USERS = 'AUTHENTICATED_USERS' \n// For internal testing only\nexport const _TIME_DELAY = 75\nexport const SRC_SIGN_IN_CLASS = 'SRC-SIGN-IN-CLASS'","import { BatchFileResult } from './jsonResponses/BatchFileResult'\nimport { Entity } from './jsonResponses/Entity'\nimport { FileHandleResults } from './jsonResponses/FileHandleResults'\nimport { UserGroupHeaderResponsePage } from './jsonResponses/UserGroupHeaderResponsePage'\nimport { SynapseVersion } from './jsonResponses/SynapseVersion'\nimport { QueryResultBundle } from './jsonResponses/Table/QueryResultBundle'\nimport { WikiPage } from './jsonResponses/WikiPage'\nimport { UserBundle } from './jsonResponses/UserBundle'\nimport { AsyncJobId } from './jsonResponses/Table/AsyncJobId'\nimport { MultipartUploadRequest } from './jsonResponses/MultipartUploadRequest'\nimport { BatchPresignedUploadUrlRequest } from './jsonResponses/BatchPresignedUploadUrlRequest'\nimport { BatchPresignedUploadUrlResponse } from './jsonResponses/BatchPresignedUploadUrlResponse'\nimport { MultipartUploadStatus } from './jsonResponses/MultipartUploadStatus'\nimport { FileUploadComplete } from './jsonResponses/FileUploadComplete'\nimport browserMd5File from 'browser-md5-file'\nimport { AddPartResponse } from './jsonResponses/AddPartResponse'\nimport { EntityLookupRequest } from './jsonResponses/EntityLookupRequest'\nimport { FileEntity } from './jsonResponses/FileEntity'\nimport { UserProfile } from './jsonResponses/UserProfile'\nimport { AccessControlList } from './jsonResponses/AccessControlList'\nimport { Submission } from './jsonResponses/Submission'\nimport { DownloadFromTableRequest } from './jsonResponses/Table/DownloadFromTableRequest'\nimport { DownloadFromTableResult } from './jsonResponses/Table/DownloadFromTableResult'\nimport { ReferenceList } from './jsonResponses/ReferenceList'\nimport { EntityHeader } from './jsonResponses/EntityHeader'\nimport { PaginatedResults } from './jsonResponses/PaginatedResults'\nimport { QueryBundleRequest } from './jsonResponses/Table/QueryBundleRequest'\nimport { OIDCAuthorizationRequest } from './jsonResponses/OIDCAuthorizationRequest'\nimport { OIDCAuthorizationRequestDescription } from './jsonResponses/OIDCAuthorizationRequestDescription'\nimport { AccessCodeResponse } from './jsonResponses/AccessCodeResponse'\nimport { OAuthClientPublic } from './jsonResponses/OAuthClientPublic'\nimport { BatchFileRequest } from './jsonResponses/BatchFileRequest'\nimport { QueryTableResults } from './jsonResponses/EvaluationQueryTable/QueryTableResults'\nimport { FormGroup, FormData, ListRequest, ListResponse, FormChangeRequest, FormRejection } from './jsonResponses/Forms'\nimport { FileHandle } from './jsonResponses/FileHandle'\nimport { ProjectFilesStatisticsRequest, ProjectFilesStatisticsResponse } from './jsonResponses/Statistics'\n\n// TODO: Create JSON response types for all return types\nexport const IS_DEV_ENV = (process.env.NODE_ENV === 'development') ? true : false\nexport const DEV_ENV_SESSION_LOCAL_STORAGE_KEY = 'session-token-dev-mode-only'\nexport const DEFAULT_ENDPOINT: string = 'https://repo-prod.prod.sagebase.org/'\nexport const DEFAULT_SWC_ENDPOINT = 'https://www.synapse.org/'\n// Max size file that we will allow the caller to read into memory (5MB)\nconst MAX_JS_FILE_DOWNLOAD_SIZE = 5242880\n\nexport const AUTH_PROVIDER = 'GOOGLE_OAUTH_2_0'\n// This corresponds to the Synapse-managed S3 storage location:\nexport const SYNAPSE_STORAGE_LOCATION_ID = 1\nexport const getRootURL = () => {\n  const portString = window.location.port ? `:${window.location.port}` : ''\n  return `${window.location.protocol}//${window.location.hostname}${portString}/`\n}\n\nexport function delay(t: any) {\n  return new Promise((resolve) => {\n    setTimeout(resolve.bind(null, {}), t)\n  })\n}\nfunction parseJSON(response: any) {\n  return response.text()\n  .then((text: string) => {\n    let parsedJson = ''\n    try {\n      parsedJson = JSON.parse(text)\n    } catch (err) {\n      console.log('Caught exception with parsing json ', err)\n      parsedJson = text\n    }\n    return parsedJson ? parsedJson : {}\n  }).catch(\n    // this should never happen!\n    (err: string) => {\n      console.log('Caught exception loading response text ', err)\n      return {}\n    }\n  )\n}\nconst fetchWithExponentialTimeout = <T>(url: string, options: any, delayMs: any, retries: number): Promise<T> => {\n  return fetch(url, options)\n    .then((resp) => {\n      if (resp.status > 199 && resp.status < 300) {\n        if (resp.status === 204) {\n          // the response is empty, don't try to parse an empty response\n          return resp\n        }\n        // ok!\n        return parseJSON(resp)\n      }\n      if (resp.status === 429 || resp.status === 0) {\n        // TOO_MANY_REQUESTS_STATUS_CODE, or network connection is down.  Retry after a couple of seconds.\n        if (retries === 1) {\n          return Promise.reject({\n            reason: resp.statusText,\n            statusCode: resp.status\n          })\n        }\n        return delay(delayMs).then(() => {\n          return fetchWithExponentialTimeout(url, options, delayMs * 2, retries - 1)\n        })\n      }\n      // error status that indicates no more retries\n      return resp\n        .json()\n        .then((json) => {\n          // on okay response return json, o.w. reject with json and\n          // send to catch block\n          const error = {\n            reason: json.reason,\n            status: resp.status\n          }\n          return resp.ok ? json : Promise.reject(error)\n        })\n        .catch((error) => {\n          // call failed above\n          if (error.reason && error.status) {\n            // successfull return from server but invalid call\n            // the call was recieved, but staus wasn't ok-- return the json response from above\n            // from the response directly\n            return Promise.reject({\n              reason: error.reason,\n              statusCode: error.status\n            })\n          }\n          return Promise.reject({\n            reason: resp.statusText,\n            statusCode: resp.status\n          })\n        })\n    })\n    .catch((error) => {\n      // this should never happen\n      return Promise.reject(error)\n    })\n}\n\nexport const doPost = (\n  url: string,\n  requestJsonObject: any,\n  sessionToken: string | undefined,\n  initCredentials: string | undefined,\n  endpoint: string\n  ): Promise<any> => {\n  const options: any = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n      'Content-Type': 'application/json',\n    },\n    method: 'POST',\n    mode: 'cors',\n    credentials: initCredentials\n  }\n  if (initCredentials) {\n    options.credentials = initCredentials\n  }\n  if (sessionToken) {\n    options.headers.sessionToken = sessionToken\n  }\n  return fetchWithExponentialTimeout(endpoint + url, options, 1000, 5)\n}\nexport const doGet = <T>(\n                      url: string,\n                      sessionToken: string | undefined,\n                      initCredentials: string | undefined,\n                      endpoint: string) => {\n  const options: any = {\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken'\n    },\n    method: 'GET',\n    mode: 'cors'\n  }\n  if (initCredentials) {\n    options.credentials = initCredentials\n  }\n  if (sessionToken) {\n    options.headers.sessionToken = sessionToken\n  }\n  return fetchWithExponentialTimeout<T>(endpoint + url, options, 1000, 5)\n}\n\nexport const doDelete = (\n  url: string,\n  sessionToken: string | undefined,\n  initCredentials: string | undefined,\n  endpoint: string) => {\n  const options: any = {\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken'\n    },\n    method: 'DELETE',\n    mode: 'cors',\n    credentials: initCredentials\n  }\n  if (initCredentials) {\n    options.credentials = initCredentials\n  }\n  if (sessionToken) {\n    options.headers.sessionToken = sessionToken\n  }\n  return fetchWithExponentialTimeout(endpoint + url, options, 1000, 5)\n}\n\nexport const doPut = (\n  url: string,\n  requestJsonObject: any,\n  sessionToken: string | undefined,\n  initCredentials: string | undefined,\n  endpoint: string\n): Promise<any> => {\n  const options: any = {\n    body: JSON.stringify(requestJsonObject),\n    headers: {\n      Accept: '*/*',\n      'Access-Control-Request-Headers': 'sessiontoken',\n      'Content-Type': 'application/json',\n    },\n    method: 'PUT',\n    mode: 'cors'\n  }\n  if (initCredentials) {\n    options.credentials = initCredentials\n  }\n  if (sessionToken) {\n    options.headers.sessionToken = sessionToken\n  }\n  return fetchWithExponentialTimeout(endpoint + url, options, 1000, 5)\n}\n\nexport const putRefreshSessionToken = (sessionToken: string, endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPut('/auth/v1/session', { sessionToken }, undefined, undefined, endpoint)\n}\n\nexport const getVersion = (endpoint: string = DEFAULT_ENDPOINT): Promise<SynapseVersion> => {\n  return doGet<SynapseVersion>('/repo/v1/version', undefined, undefined, endpoint)\n}\n\n/**\n * https://docs.synapse.org/rest/POST/entity/id/table/download/csv/async/start.html\n */\nexport const getDownloadFromTableRequest = (\n  request: DownloadFromTableRequest,\n  sessionToken: string | undefined = undefined,\n  endpoint: string = DEFAULT_ENDPOINT,\n  updateParentState?: any,\n) => {\n  return doPost(`/repo/v1/entity/${request.entityId}/table/download/csv/async/start`, request, sessionToken, undefined, endpoint)\n  .then((resp: AsyncJobId) => {\n    const requestUrl = `/repo/v1/entity/${request.entityId}/table/download/csv/async/get/${resp.token}`\n    return getAsyncResultFromJobId<DownloadFromTableResult>(requestUrl, sessionToken, endpoint, updateParentState)\n  })\n  .catch((error: any) => {\n    throw error\n  })\n}\n\n/**\n* https://docs.synapse.org/rest/GET/fileHandle/handleId.html\n* Get a FileHandle using its ID.\n* Note: Only the user that created the FileHandle can access it directly.\n* @return FileHandle\n**/\nexport const getFileHandleById = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n  endpoint: string = DEFAULT_ENDPOINT,\n): Promise<FileHandle> => {\n  return doGet<FileHandle>(`file/v1/fileHandle/${handleId}`, sessionToken, undefined, endpoint)\n}\n\n/**\n* https://docs.synapse.org/rest/GET/fileHandle/handleId/url.html\n* @return a short lived presignedURL to be redirected with\n**/\nexport const getFileHandleByIdURL = (\n  handleId: string,\n  sessionToken: string | undefined = undefined,\n  endpoint: string = DEFAULT_ENDPOINT,\n) => {\n  // get the presigned URL for this file handle\n  return doGet<string>(`file/v1/fileHandle/${handleId}/url?redirect=false`, sessionToken, undefined, endpoint)\n}\n\nexport const getAsyncResultFromJobId = <T>(\n  urlRequest: string,\n  sessionToken: string | undefined = undefined,\n  endpoint: string = DEFAULT_ENDPOINT,\n  updateParentState?: any\n): Promise<T> => {\n  return doGet(urlRequest, sessionToken, undefined, endpoint)\n  .then((resp: any) => {\n    // is this the job status?\n    if (resp.jobState && resp.jobState !== 'FAILED') {\n      updateParentState && updateParentState({\n        asyncJobStatus: resp\n      })\n      // still processing, wait for a second and try again\n      return delay(500).then(() => {\n        return getAsyncResultFromJobId<T>(urlRequest, sessionToken, endpoint, updateParentState)\n      })\n    }\n    // these must be the query results!\n    return resp\n  })\n  .catch((error) => {\n    throw error\n  })\n}\n\n/**\n * http://docs.synapse.org/rest/POST/entity/id/table/query/nextPage/async/start.html\n * @param {*} queryBundleRequest\n * @param {*} sessionToken\n * @param {*} endpoint\n */\nexport const getQueryTableResults = (\n  queryBundleRequest: QueryBundleRequest,\n  sessionToken: string | undefined = undefined,\n  updateParentState?: any,\n  endpoint: string = DEFAULT_ENDPOINT,\n): Promise<QueryResultBundle> => {\n  return doPost(`/repo/v1/entity/${queryBundleRequest.entityId}/table/query/async/start`, queryBundleRequest, sessionToken, undefined, endpoint)\n  .then((resp) => {\n    return getAsyncResultFromJobId<QueryResultBundle>(`/repo/v1/entity/${queryBundleRequest.entityId}/table/query/async/get/${resp.token}`, sessionToken, endpoint, updateParentState)\n  })\n  .catch((error: any) => {\n    throw error\n  })\n}\n/**\n *  Run and return results from queryBundleRequest, queryBundle request must be of the\n *  form:\n *     {\n *        concreteType: String,\n *        query: {\n *           sql: String,\n *           isConsistent: Boolean,\n *           partMask: Number\n *        }\n *     }\n * @param {*} queryBundleRequest\n * @param {*} [sessionToken=undefined]\n * @param {boolean} [onlyGetFacets=false] Specify if the query only needs facets and no\n * data-- (internally this limits the row count to 1 on the request)\n * @returns Full dataset from synapse table query\n */\nexport const getFullQueryTableResults = async (queryBundleRequest: any,\n                                               sessionToken: string | undefined = undefined)\n                                               : Promise<QueryResultBundle> => {\n  // TODO: Find out why theres a bug causing the query limit\n  const { query, ...rest } = queryBundleRequest\n  let data: any = {}\n  let maxPageSize: number = 150\n  const queryRequest: any = {\n    ...rest,\n    query: { ...query, limit: maxPageSize }\n  }\n  // Have to make two \"sets\" of calls for query, the first one tells us the maximum size per page of data\n  // we can get, the following uses that maximum and offsets to the appropriate location to get the data\n  // afterwards, the process repeats\n  await getQueryTableResults(queryRequest, sessionToken).then(\n    async (initData: QueryResultBundle) => {\n      let queryCount: any = initData.queryResult.queryResults.rows.length\n      let currentQueryCount: number = queryCount\n      data = initData\n      // Get the subsequent data, note- although the function calls itself, it runs\n      // iteratively due to the await\n      const getData = async () => {\n        if (queryCount === maxPageSize) {\n          maxPageSize = initData.maxRowsPerPage!\n          const queryRequestWithMaxPageSize = {\n            ...rest,\n            query: { ...query, limit: maxPageSize, offset: currentQueryCount }\n          }\n          await getQueryTableResults(queryRequestWithMaxPageSize, sessionToken)\n            .then((postData: any) => {\n              queryCount += postData.queryResult.queryResults.rows.length\n              if (queryCount > 0) {\n                currentQueryCount += queryCount\n                data.queryResult.queryResults.rows.push(\n                  ...postData.queryResult.queryResults.rows // ... spread operator to push all elements on\n                )\n              }\n              return getData()\n            })\n            .catch((err) => {\n              console.log('Error on getting table results ', err)\n            })\n        } else {\n          // set data to this plots sql in the query data\n          return data\n        }\n      }\n      return getData()\n    })\n  return data\n}\n\n/**\n *  Log-in using the given username and password.  Will return a session token that must be used in\n *  authenticated requests.\n *  http://docs.synapse.org/rest/POST/login.html\n */\nexport const login = (username: string, password: string, endpoint = DEFAULT_ENDPOINT) => {\n  return doPost('/auth/v1/login', { username, password }, undefined, undefined, endpoint)\n}\n/**\n * Get redirect url\n * https://docs.synapse.org/rest/POST/oauth2/authurl.html\n * @param {*} provider\n * @param {*} redirectUrl\n * @param {*} endpoint\n */\nexport let oAuthUrlRequest = (provider: string, redirectUrl: string, endpoint = DEFAULT_ENDPOINT) => {\n  return doPost('/auth/v1/oauth2/authurl', { provider, redirectUrl }, undefined, undefined, endpoint)\n}\n/**\n * Get session token from SSO\n * https://docs.synapse.org/rest/POST/oauth2/session.html\n * @param {*} provider\n * @param {*} authenticationCode\n * @param {*} redirectUrl\n * @param {*} endpoint\n */\nexport let oAuthSessionRequest = (provider: string,\n                                  authenticationCode: string | number,\n                                  redirectUrl: string,\n                                  endpoint: any = DEFAULT_ENDPOINT) => {\n  return doPost(\n    '/auth/v1/oauth2/session',\n    { provider, authenticationCode, redirectUrl }, undefined, undefined, endpoint)\n}\n/**\n * Create an entity (Project, Folder, File, Table, View)\n * http://docs.synapse.org/rest/POST/entity.html\n */\nexport const createEntity = (entity: any, sessionToken: string | undefined, endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPost('/repo/v1/entity', entity, sessionToken, undefined, endpoint)\n}\n/**\n * Create a project with the given name.\n * http://docs.synapse.org/rest/POST/entity.html\n */\nexport const createProject = (name: string,\n                              sessionToken: string | undefined,\n                              endpoint: string = DEFAULT_ENDPOINT)\n                              : Promise<Response> => {\n  return createEntity(\n    {\n      name,\n      concreteType: 'org.sagebionetworks.repo.model.Project'\n    },\n    sessionToken,\n    endpoint\n  )\n}\n\n/**\n * Return this user's UserProfile\n * http://docs.synapse.org/rest/GET/userProfile.html\n */\nexport const getUserProfile = (sessionToken: string | undefined, endpoint = DEFAULT_ENDPOINT) => {\n  return doGet<UserProfile>('/repo/v1/userProfile', sessionToken, undefined, endpoint)\n}\n\n/**\n * Return this user's UserProfile\n * http://docs.synapse.org/rest/GET/userProfile.html\n */\nexport const getUserProfileById = (\n  sessionToken: string | undefined, ownerId: string, endpoint = DEFAULT_ENDPOINT) => {\n  return doGet<UserProfile>(`/repo/v1/userProfile/${ownerId}`, sessionToken, undefined, endpoint)\n}\n\n/**\n * Return this user's profile bundle\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserBundle.html\n */\nexport const getUserBundle = (\n  id: string, mask: number, sessionToken: string | undefined, endpoint = DEFAULT_ENDPOINT\n): Promise<UserBundle> => {\n  return doGet<UserBundle>(`repo/v1/user/${id}/bundle?mask=${mask}`, sessionToken, undefined, endpoint)\n}\n\n/**\n * Return batch of user group headers\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserGroupHeaderResponsePage.html\n */\nexport const getGroupHeadersBatch = (\n  ids: string [], sessionToken: string | undefined, endpoint = DEFAULT_ENDPOINT\n): Promise<UserGroupHeaderResponsePage> => {\n  return doGet<UserGroupHeaderResponsePage>(`repo/v1/userGroupHeaders/batch?ids=${ids.join(',')}`, sessionToken, undefined, endpoint)\n}\n\nexport type UserProfileList = { list: UserProfile [] }\n/**\n * Return the User Profiles for the given list of user IDs\n * http://docs.synapse.org/rest/POST/userProfile.html\n */\nexport const getUserProfiles =\n  (\n    list: string[],\n    sessionToken: string | undefined = undefined,\n    endpoint: string = DEFAULT_ENDPOINT\n  ): Promise<UserProfileList> => {\n    return doPost('/repo/v1/userProfile', { list }, sessionToken, undefined, endpoint)\n  }\n\n/**\n * Return the children (Files/Folders) of the given entity (Project or Folder).\n * http://docs.synapse.org/rest/POST/entity/children.html\n */\nexport const getEntityChildren = (request: any,\n                                  sessionToken: string | undefined = undefined,\n                                  endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPost('/repo/v1/entity/children', request, sessionToken, undefined, endpoint)\n}\n/**\n * Retrieve an entityId for a given parent ID and entity name.\n * https://docs.synapse.org/rest/POST/entity/child.html\n */\nexport const lookupChildEntity = (\n  request: EntityLookupRequest,\n  sessionToken: string | undefined = undefined,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPost('/repo/v1/entity/child', request, sessionToken, undefined, endpoint)\n}\n\n/**\n * Get a batch of pre-signed URLs and/or FileHandles for the given list of FileHandleAssociations.\n * http://docs.synapse.org/rest/POST/fileHandle/batch.html\n */\nexport const getFiles = (request: BatchFileRequest,\n                         sessionToken: string | undefined = undefined,\n                         endpoint: string = DEFAULT_ENDPOINT): Promise<BatchFileResult> => {\n  return doPost('/file/v1/fileHandle/batch', request, sessionToken, undefined, endpoint)\n}\n/**\n * Bundled access to Entity and related data components.\n * An EntityBundle can be used to create, fetch, or update an Entity and associated\n * objects with a single web service request.\n * See SynapseClient.test.js for an example partsMask.\n * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/Entity.html\n */\ntype GetEntity = <T extends Entity>(sessionToken: string | undefined, entityId: string | number, endpoint?: string) => Promise<T>\n\nexport const getEntity: GetEntity = <T>(sessionToken: string | undefined = undefined,\n                          entityId: string | number,\n                          endpoint: string = DEFAULT_ENDPOINT) => {\n  const url = `/repo/v1/entity/${entityId}`\n  return doGet(url, sessionToken, undefined, endpoint) as Promise<T>\n}\n\n/**\n * Get the EntityHeader for a list of references with a POST. \n * If any item in the batch fails (e.g., with a 404) it will be EXCLUDED in the result set.\n * https://docs.synapse.org/rest/POST/entity/header.html\n */\nexport const getEntityHeader = (references: ReferenceList,\n  sessionToken: string | undefined = undefined,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPost('repo/v1/entity/header', { references }, sessionToken, undefined, endpoint) as Promise<PaginatedResults<EntityHeader>>\n}\n\nexport const updateEntity = (\n  entity: Entity,\n  sessionToken: string | undefined = undefined,\n  endpoint = DEFAULT_ENDPOINT): Promise<Entity> => {\n  const url = `/repo/v1/entity/${entity.id}`\n  return doPut(url, entity, sessionToken, undefined, endpoint)\n}\n\nexport const deleteEntity: GetEntity = <T>(sessionToken: string | undefined = undefined,\n  entityId: string | number,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  const url = `/repo/v1/entity/${entityId}`\n  return doDelete(url, sessionToken, undefined, endpoint) as Promise<T>\n}\n\n/**\n * Bundled access to Entity and related data components.\n * An EntityBundle can be used to create, fetch, or update an Entity and\n * associated objects with a single web service request.\n * See SynapseClient.test.js for an example partsMask.\n * http://docs.synapse.org/rest/GET/entity/id/version/versionNumber/bundle.html\n */\nexport const getEntityBundleForVersion = (\n  entityId: string | number,\n  version: string | number | undefined,\n  partsMask: string | number,\n  sessionToken: string | undefined = undefined,\n  endpoint = DEFAULT_ENDPOINT\n) => {\n  let url = `/repo/v1/entity/${entityId}`\n  if (version) {\n    url += `/version/ + ${version}`\n  }\n  url += `/bundle?mask= ${partsMask}`\n  return doGet(url, sessionToken, undefined, endpoint)\n}\n/**\n * Get Wiki page contents, call is of the form:\n * http://docs.synapse.org/rest/GET/entity/ownerId/wiki.html\n */\nexport const getEntityWiki = (sessionToken: string | undefined,\n                              ownerId: string | undefined,\n                              wikiId: string | undefined,\n                              endpoint: string = DEFAULT_ENDPOINT) => {\n  const url = `/repo/v1/entity/${ownerId}/wiki/${wikiId}`\n  return doGet(url, sessionToken, undefined, endpoint) as Promise<WikiPage>\n}\n\n/**\n * Returns synapse user favorites list given their session token\n * http://docs.synapse.org/rest/GET/favorite.html\n */\nexport const getUserFavorites = (sessionToken: string | undefined, endpoint = DEFAULT_ENDPOINT) => {\n  const url = 'repo/v1/favorite?offset=0&limit=200'\n  return doGet(url, sessionToken, undefined, endpoint)\n}\n/**\n *  http://docs.synapse.org/rest/GET/projects/type.html\n *  @param {String} projectDetails Can be \"MY_PROJECTS\", \"MY_CREATED_PROJECTS\" or \"MY_PARTICIPATED_PROJECTS\"\n */\nexport const getUserProjectList = (sessionToken: string | undefined,\n                                   projectDetails: string,\n                                   endpoint = DEFAULT_ENDPOINT) => {\n  const url = `repo/v1/projects/${projectDetails}?offset=0&limit=200`\n  return doGet(url, sessionToken, undefined, endpoint)\n}\n/**\n * Get the user's list of teams they are on\n *\n * @param {*} id ownerID of the synapse user see - http://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserProfile.html\n */\nexport const getUserTeamList = (sessionToken: string | undefined, id: string | number, endpoint = DEFAULT_ENDPOINT) => {\n  const url = `repo/v1/user/${id}/team?offset=0&limit=200`\n  return doGet(url, sessionToken, undefined, endpoint)\n}\n/**\n * Get the user's list of teams they are on\n *\n * @param {*} id ownerID of the synapse user see -https://docs.synapse.org/rest/GET/teamMembers/id.html\n * @param {*} fragment (optional) a prefix of the user's first or last name or email address (optional)\n * @param {*} limit    (optional) the maximum number of members to return (default 10, max limit 50)\n * @param {*} offset   (optional) the starting index of the returned results (default 0)\n *\n */\nexport const getTeamList = (\n  sessionToken: string | undefined,\n  id: string | number,\n  fragment: string = '',\n  limit: number = 10,\n  offset: number = 0,\n  endpoint: string = DEFAULT_ENDPOINT\n) => {\n  const url = `repo/v1/teamMembers/${id}?limit=${limit}&offset=${offset}${fragment ? `&fragment=${fragment}` : ''}`\n  return doGet(url, sessionToken, undefined, endpoint)\n}\n\nexport const getWikiAttachmentsFromEntity =\n    (\n      sessionToken: string | undefined,\n      id: string | number,\n      wikiId: string | number,\n      endpoint: string = DEFAULT_ENDPOINT): Promise<FileHandleResults> => {\n      const url = `repo/v1/entity/${id}/wiki/${wikiId}/attachmenthandles`\n      return doGet(url, sessionToken, undefined, endpoint)\n    }\nexport const getWikiAttachmentsFromEvaluation = (sessionToken: string | undefined,\n                                                 id: string | number,\n                                                 wikiId: string | number,\n                                                 endpoint: string = DEFAULT_ENDPOINT) => {\n  const url = `repo/v1/evaluation/${id}/wiki/${wikiId}/attachmenthandles`\n  return doGet(url, sessionToken, undefined, endpoint)\n}\n/**\n * Set the session token cookie.  Note that this will only succeed if your app is running on\n * a .synapse.org subdomain.\n *\n * @param {*} token Session token.  If undefined, then call should instruct the browser to delete the cookie.\n */\nexport const setSessionTokenCookie = (token: string | undefined, swcEndpoint: string = DEFAULT_SWC_ENDPOINT) => {\n  if (!IS_DEV_ENV) {\n    return doPost('Portal/sessioncookie', { sessionToken: token }, undefined, 'include', swcEndpoint)\n  }\n  // else (is in dev env)\n  if (token) {\n    localStorage.setItem(DEV_ENV_SESSION_LOCAL_STORAGE_KEY, token)\n  } else {\n    localStorage.removeItem(DEV_ENV_SESSION_LOCAL_STORAGE_KEY)\n  }\n  return Promise.resolve()\n}\n/**\n * Get the current session token from a cookie.  Note that this will only succeed if your app is running on\n * a .synapse.org subdomain.\n */\nexport const getSessionTokenFromCookie = (swcEndpoint: string = DEFAULT_SWC_ENDPOINT) => {\n  if (!IS_DEV_ENV) {\n    return doGet<string>('Portal/sessioncookie', undefined, 'include', swcEndpoint)\n  }\n  // else (is in dev env)\n  const sessionToken = localStorage.getItem(DEV_ENV_SESSION_LOCAL_STORAGE_KEY)\n  return Promise.resolve(sessionToken)\n}\n\nexport const getPrincipalAliasRequest = (sessionToken: string | undefined,\n                                         alias: string,\n                                         type: string,\n                                         endpoint: string = DEFAULT_ENDPOINT) => {\n  const url = 'repo/v1/principal/alias'\n  return doPost(url, { alias, type }, sessionToken, undefined, endpoint)\n}\n\n/*\nDuring SSO login, the authorization provider (Google) will\nsend the user back to the portal with an authorization code,\nwhich can be exchanged for a Synapse user session.\nThis function should be called whenever the root App is initialized\n(to look for this code parameter and complete the round-trip).\n*/\nexport const detectSSOCode = (endpoint: string = DEFAULT_ENDPOINT, swcEndpoint: string = DEFAULT_SWC_ENDPOINT) => {\n  const redirectURL = getRootURL()\n  // 'code' handling (from SSO) should be preformed on the root page, and then redirect to original route.\n  let code: URL | null | string = new URL(window.location.href)\n  // in test environment the searchParams isn't defined\n  const { searchParams } = code\n  if (!searchParams) {\n    return\n  }\n  code = searchParams.get('code')\n  if (code) {\n    oAuthSessionRequest(AUTH_PROVIDER, code, `${redirectURL}?provider=${AUTH_PROVIDER}`, endpoint)\n      .then((synToken: any) => {\n        setSessionTokenCookie(synToken.sessionToken, swcEndpoint).then(() => {\n          // go back to original route after successful SSO login\n          const originalUrl = localStorage.getItem('after-sso-login-url')\n          localStorage.removeItem('after-sso-login-url')\n          if (originalUrl) {\n            window.location.replace(originalUrl)\n          }\n        }).catch((errSetSession) => {\n          console.error('Error on set sesion token cookie ', errSetSession)\n        })\n      })\n      .catch((err: any) => {\n        if (err.statusCode === 404) {\n          // Synapse account not found, send to registration page\n          window.location.replace('https://www.synapse.org/#!RegisterAccount:0')\n        }\n        console.error('Error on sso sign in ', err)\n      })\n  }\n}\n\nexport const signOut = (swcEndpoint: string = DEFAULT_SWC_ENDPOINT) => {\n  setSessionTokenCookie(undefined, swcEndpoint).then(() => {\n    window.location.reload()\n  }).catch((err) => {\n    console.error('err when clearing the session cookie ', err)\n  })\n}\n\n/**\n * Upload file.  Note that this currently only supports Synapse storage (Sage s3 bucket)\n * @param sessionToken\n * @param file\n * @param endpoint\n */\nexport const uploadFile = (\n  sessionToken: string | undefined,\n  filename: string,\n  file: Blob,\n  endpoint: string = DEFAULT_ENDPOINT,\n) => {\n  return new Promise<FileUploadComplete>((fileUploadResolve, fileUploadReject) => {\n    const partSize: number = Math.max(5242880, (file.size / 10000))\n    const request: MultipartUploadRequest = {\n      contentType: file.type,\n      fileName: filename,\n      fileSizeBytes: file.size,\n      partSizeBytes: partSize,\n      storageLocationId: SYNAPSE_STORAGE_LOCATION_ID\n    }\n    calculateMd5(file).then((md5: string) => {\n      request.contentMD5Hex = md5\n      startMultipartUpload(sessionToken, filename, file, request, fileUploadResolve, fileUploadReject, endpoint)\n    })\n  })\n}\n\nconst calculateMd5 = (\n  fileBlob: File | Blob\n): Promise<string> => {\n  const bmf = new browserMd5File()\n  return new Promise((resolve, reject) => {\n    bmf.md5(\n      fileBlob,\n      (error: any, md5: string) => {\n        if (md5) {\n          resolve(md5)\n        } else if (error) {\n          reject(error)\n        }\n      },\n      (progress: number) => {\n        // console.log('progress: ', progress)\n      }\n    )\n  })\n}\n\nconst processFilePart = (\n  partNumber: number,\n  multipartUploadStatus: MultipartUploadStatus,\n  sessionToken: string | undefined,\n  fileName: string,\n  file: Blob,\n  request: MultipartUploadRequest,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n  endpoint: string = DEFAULT_ENDPOINT\n) => {\n  if (multipartUploadStatus.clientSidePartsState![partNumber - 1]) {\n    // no-op. this part has already been processed!\n    return\n  }\n\n  const uploadId = multipartUploadStatus.uploadId\n  const presignedUploadUrlRequest: BatchPresignedUploadUrlRequest = {\n    uploadId,\n    contentType: 'application/octet-stream', // each part is binary\n    partNumbers: [partNumber],\n  }\n  const presignedUrlUrl = `/file/v1/file/multipart/${uploadId}/presigned/url/batch`\n  doPost(presignedUrlUrl, presignedUploadUrlRequest, sessionToken, undefined, endpoint).then(\n    async (presignedUrlResponse: BatchPresignedUploadUrlResponse) => {\n      const presignedUrl = presignedUrlResponse.partPresignedUrls[0].uploadPresignedUrl\n      // calculate the byte range\n      const startByte = (partNumber - 1) * request.partSizeBytes\n      let endByte = partNumber * request.partSizeBytes - 1\n      if (endByte >= request.fileSizeBytes) {\n        endByte = request.fileSizeBytes - 1\n      }\n      const fileSlice = file.slice(startByte, endByte + 1, presignedUploadUrlRequest.contentType)\n      await uploadFilePart(presignedUrl, fileSlice, presignedUploadUrlRequest.contentType)\n      // uploaded the part.  calculate md5 of the part and add the part to the upload\n      calculateMd5(fileSlice).then((md5: string) => {\n        const addPartUrl = `/file/v1/file/multipart/${uploadId}/add/${partNumber}?partMD5Hex=${md5}`\n        doPut(addPartUrl, undefined, sessionToken, undefined, endpoint).then(\n          (addPartResponse: AddPartResponse) => {\n            if (addPartResponse.addPartState === 'ADD_SUCCESS') {\n              // done with this part!\n              multipartUploadStatus.clientSidePartsState![partNumber - 1] = true\n              checkUploadComplete(\n                multipartUploadStatus,\n                fileName,\n                sessionToken,\n                fileUploadResolve,\n                fileUploadReject,\n                endpoint)\n            } else {\n              // retry after a brief delay\n              delay(1000).then(() => {\n                processFilePart(\n                  partNumber,\n                  multipartUploadStatus,\n                  sessionToken,\n                  fileName,\n                  file,\n                  request,\n                  fileUploadResolve,\n                  fileUploadReject,\n                  endpoint)\n              })\n            }\n          })\n      })\n    })\n}\nexport const checkUploadComplete = (\n  status: MultipartUploadStatus,\n  fileHandleName: string,\n  sessionToken: string | undefined,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  // if all client-side parts are true (uploaded), then complete the upload and get the file handle!\n  if (status.clientSidePartsState!.every((v) => { return v })) {\n    const url = `/file/v1/file/multipart/${status.uploadId}/complete`\n    doPut(url, undefined, sessionToken, undefined, endpoint).then((newStatus: MultipartUploadStatus) => {\n      // success!\n      fileUploadResolve({ fileHandleId: newStatus.resultFileHandleId, fileName: fileHandleName })\n    }).catch((error) => {\n      fileUploadReject(error)\n    })\n  }\n}\nconst uploadFilePart = async (presignedUrl: string, file: any, contentType: string) => {\n  // TODO: could try using axios to get upload progress, then update the client-side part state (change to numbers from 0-1)\n  // This would give progress for the single file (across all parts).\n  // The parent would still need to figure out progress (for the total file set).\n  await fetch(presignedUrl, {\n    method: 'PUT',\n    headers: {\n      'Content-Type': contentType\n    },\n    body: file\n  })\n}\nexport const startMultipartUpload = (\n  sessionToken: string | undefined,\n  fileName: string,\n  file: Blob,\n  request: MultipartUploadRequest,\n  fileUploadResolve: (fileUpload: FileUploadComplete) => void,\n  fileUploadReject: (reason: any) => void,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  const url = 'file/v1/file/multipart'\n  doPost(url, request, sessionToken, undefined, endpoint).then(async (status: MultipartUploadStatus) => {\n    // started the upload\n    // keep track of the part state client-side\n    const clientSidePartsState: boolean[] = status.partsState.split('').map(bit => bit === '1')\n    status.clientSidePartsState = clientSidePartsState\n    for (let i = 0; i < clientSidePartsState.length; i = i + 1) {\n      if (!clientSidePartsState[i]) {\n        // upload this part.  note that partNumber is always the index+1\n        await processFilePart(\n          i + 1,\n          status,\n          sessionToken,\n          fileName,\n          file,\n          request,\n          fileUploadResolve,\n          fileUploadReject,\n          endpoint)\n      }\n    }\n    // in case there is no upload work to do!\n    checkUploadComplete(status, fileName, sessionToken, fileUploadResolve, fileUploadReject, endpoint)\n  }).catch((error) => {\n    fileUploadReject(error)\n  })\n}\n\n/**\n * Return the content of the file (latest version) associated to the given FileEntity.\n * Be aware that if the target file size > 5MB, this method will throw an error.\n * @param sessionToken\n * @param fileEntity\n * @param endpoint\n */\nexport const getFileEntityContent = (\n  sessionToken: string,\n  fileEntity: FileEntity,\n  endpoint: string = DEFAULT_ENDPOINT\n): Promise<any> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    const fileHandleAssociationList = [\n      {\n        associateObjectId: fileEntity.id,\n        associateObjectType: 'FileEntity',\n        fileHandleId: fileEntity.dataFileHandleId\n      }\n    ]\n    const request: any = {\n      includeFileHandles: true,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList\n    }\n    getFiles(request, sessionToken, endpoint).then(\n      (data: BatchFileResult) => {\n        const presignedUrl: string = data.requestedFiles[0].preSignedURL\n        const fileHandle: FileHandle = data.requestedFiles[0].fileHandle\n        return getFileHandleContent(fileHandle, presignedUrl).then((content: string) => {\n          resolve(content)\n        })\n      }\n    ).catch((err) => {\n      reject(err)\n    })\n  })\n}\n\nexport const getFileHandleContentFromID = (\n  fileHandleId: string,\n  sessionToken: string,\n  endpoint: string = DEFAULT_ENDPOINT\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n    // get the file handle and url\n    const getFileHandleByIdPromise = getFileHandleById(fileHandleId, sessionToken, endpoint)\n    const getFileHandlePresignedUrlPromis = getFileHandleByIdURL(fileHandleId, sessionToken, endpoint)\n    Promise.all([getFileHandleByIdPromise, getFileHandlePresignedUrlPromis]).then((values) => {\n      const fileHandle: FileHandle = values[0]\n      const presignedUrl: string = values[1]\n      return getFileHandleContent(fileHandle, presignedUrl).then((content: string) => {\n        resolve(content)\n      })\n    }).catch((err) => {\n      reject(err)\n    })\n  })\n}\n\nexport const getFileHandleContent = (\n  fileHandle: FileHandle,\n  presignedUrl: string\n): Promise<string> => {\n  // get the presigned URL, download the data, and send that back (via resolve())\n  return new Promise((resolve, reject) => {\n      // sanity check!  must be less than 5MB\n      if (fileHandle.contentSize < MAX_JS_FILE_DOWNLOAD_SIZE) {\n        fetch(presignedUrl, {\n          method: 'GET',\n          mode: 'cors',\n          cache: 'no-cache',\n          headers: {\n            'Content-Type': fileHandle.contentType,\n          }\n        }).then((response) => {\n          response.text().then((text) => {\n            resolve(text)\n          })\n        })\n      } else {\n        reject('File size exceeds max (5MB)')\n      }\n  })\n}\n\n/**\n * Create an ACL\n * https://docs.synapse.org/rest/POST/entity/id/acl.html\n */\nexport const createACL = (\n  entityId: string,\n  acl: AccessControlList,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPost(`/repo/v1/entity/${entityId}/acl`, acl, sessionToken, undefined, endpoint)\n}\n\n/**\n * Submit an entity to an evaluation queue\n * https://docs.synapse.org/rest/POST/evaluation/submission.html\n */\nexport const submitToEvaluation = (\n  submission: Submission,\n  etag: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  return doPost(`/repo/v1/evaluation/submission?etag=${etag}`, submission, sessionToken, undefined, endpoint)\n}\n\n/**\n * Get an evaluation queue\n * https://docs.synapse.org/rest/GET/evaluation/evalId.html\n */\nexport const getEvaluation = (\n  evalId: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n  return doGet(`/repo/v1/evaluation/${evalId}`, sessionToken, undefined, endpoint)\n}\n\n/**\n * Executes a user-defined query over the Submissions of a specific Evaluation.\n * https://docs.synapse.org/rest/GET/evaluation/submission/query.html\n */\nexport const getEvaluationSubmissions = (\n  query: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<QueryTableResults>=> {\n  return doGet(`/repo/v1/evaluation/submission/query?query=${encodeURI(query)}`, sessionToken, undefined, endpoint)\n}\n\n/**\n * Get user-friendly OAuth2 request information (to present to the user so they can choose if they want to give consent).\n */\nexport const getOAuth2RequestDescription = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<OIDCAuthorizationRequestDescription> => {\n  return doPost('/auth/v1/oauth2/description', oidcAuthRequest, sessionToken, undefined, endpoint)\n}\n\n/**\n * Get OAuth2 Client information (available to the public)\n */\nexport const getOAuth2Client = (\n  clientId: string,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<OAuthClientPublic> => {\n  return doGet(`/auth/v1/oauth2/client/${clientId}`, undefined, undefined, endpoint)\n}\n\n/**\n * User consents to the given OIDCAuthorizationRequest (after being presented with all information returned by getOAuth2RequestDescription())\n * @param oidcAuthRequest\n * @param sessionToken \n * @param endpoint \n */\nexport const consentToOAuth2Request = (\n  oidcAuthRequest: OIDCAuthorizationRequest,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<AccessCodeResponse>=> {\n  return doPost('/auth/v1/oauth2/consent', oidcAuthRequest, sessionToken, undefined, endpoint)\n}\n\n\n/***********************\n * FORM SERVICES\n * https://docs.synapse.org/rest/#org.sagebionetworks.repo.web.controller.FormController\n *************************/\n/**\n * Create a FormGroup\n * https://docs.synapse.org/rest/POST/form/group.html\n * @param name\n * @param sessionToken\n * @param endpoint\n */\nexport const createFormGroup = (\n  name: string,\n  sessionToken: string,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<FormGroup> => {\n  return doPost(`/repo/v1/form/group?name=${encodeURI(name)}`, undefined, sessionToken, undefined, endpoint)\n}\n\n/**\n * Get FormGroup ACL\n * https://docs.synapse.org/rest/GET/form/group/id/acl.html\n */\nexport const getFormACL = (\n  formGroupId: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<AccessControlList> => {\n  return doGet(`/repo/v1/form/group/${formGroupId}/acl`, sessionToken, undefined, endpoint)\n}\n\n/**\n * Update FormGroup ACL\n * https://docs.synapse.org/rest/PUT/form/group/id/acl.html\n */\nexport const updateFormACL = (\n  formGroupId: string,\n  newAcl: AccessControlList,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<AccessControlList> => {\n  return doPut(`/repo/v1/form/group/${formGroupId}/acl`, newAcl, sessionToken, undefined, endpoint)\n}\n\n/**\n * Create a new FormData object\n * https://docs.synapse.org/rest/POST/form/data.html\n * @param formGroupId\n * @param name\n * @param sessionToken\n * @param endpoint\n */\nexport const createFormData = (\n  formGroupId: string,\n  name: string,\n  dataFileHandleId: string,\n  sessionToken: string,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<FormData> => {\n    const newFormData: FormChangeRequest = {\n      name,\n      fileHandleId: dataFileHandleId\n    }\n  return doPost(`/repo/v1/form/data?groupId=${formGroupId}`, newFormData, sessionToken, undefined, endpoint)\n}\n\n/**\n * Update FormData object\n * https://docs.synapse.org/rest/PUT/form/data.html\n */\nexport const updateFormData = (\n  formDataId: string,\n  name: string,\n  dataFileHandleId: string,  \n  sessionToken: string,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<FormData> => {\n    const updatedFormData: FormChangeRequest = {\n      name,\n      fileHandleId: dataFileHandleId\n    }\n    return doPut(`/repo/v1/form/data/${formDataId}`, updatedFormData, sessionToken, undefined, endpoint)\n}\n\n/**\n * Delete FormData object\n * https://docs.synapse.org/rest/DELETE/form/data.html\n */\nexport const deleteFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) => {\n    return doDelete(`/repo/v1/form/data/${formDataId}`, sessionToken, undefined, endpoint)\n}\n\n/**\n * Submit the identified FormData for review.\n * https://docs.synapse.org/rest/POST/form/data/id/submit.html\n */\nexport const submitFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<FormData>=> {\n    return doPost(`/repo/v1/form/data/${formDataId}/submit`, undefined, sessionToken, undefined, endpoint)\n}\n\n/**\n * List FormData objects and their associated status that match the filters of the provided request that are \n * owned by the caller. Note: Only objects owned by the caller will be returned.\n * https://docs.synapse.org/rest/POST/form/data/list.html\n */\nexport const listFormData = (\n  request: ListRequest,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<ListResponse>=> {\n    return doPost(`/repo/v1/form/data/list`, request, sessionToken, undefined, endpoint)\n}\n\n/**\n * List FormData objects and their associated status that match the filters of the provided request for the entire \n * group. This is used by service accounts to process submissions. \n * https://docs.synapse.org/rest/POST/form/data/list/reviewer.html\n */\nexport const listFormDataAsFormAdmin = (\n  request: ListRequest,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<ListResponse>=> {\n    return doPost(`/repo/v1/form/data/list/reviewer`, request, sessionToken, undefined, endpoint)\n}\n\n/**\n * Called by the form processing service to accept a submitted data.\n * https://docs.synapse.org/rest/PUT/form/data/id/accept.html\n */\nexport const acceptFormData = (\n  formDataId: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<FormData>=> {\n    return doPut(`/repo/v1/form/data/${formDataId}/accept`, undefined, sessionToken, undefined, endpoint)\n}\n\n/**\n * Called by the form processing service to reject a submitted data.\n * https://docs.synapse.org/rest/PUT/form/data/id/reject.html\n */\nexport const rejectFormData = (\n  formDataId: string,\n  reason: string,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<FormData>=> {\n    const formRejection: FormRejection = {\n      reason\n    }\n    return doPut(`/repo/v1/form/data/${formDataId}/reject`, formRejection, sessionToken, undefined, endpoint)\n}\n\n/**\n * Get Statistics\n * https://docs.synapse.org/rest/POST/statistics.html\n * Generic endpoint to retrieve statistics about objects. The user should have VIEW_STATISTICS access on the object referenced by the objectId in the request.\n */\nexport const getProjectStatistics = (\n  request: ProjectFilesStatisticsRequest,\n  sessionToken: string | undefined,\n  endpoint: string = DEFAULT_ENDPOINT) : Promise<ProjectFilesStatisticsResponse>=> {\n    return doPost(`/repo/v1/statistics`, request, sessionToken, undefined, endpoint)\n}\n","import * as React from 'react'\nimport ButtonContent from '../assets/ButtonContent'\nimport GoogleIcon from '../assets/GoogleIcon'\nimport { SynapseClient } from '../utils'\n\ntype State = {\n  username: string\n  password: string\n  email: string\n  isSignedIn: boolean\n  hasLoginInFailed: boolean\n  errorMessage: string\n}\n\ntype Props = {\n  token: string | undefined\n  theme: string\n  icon: boolean\n  repoEndpoint?: string\n  swcEndpoint?: string\n  googleRedirectUrl?: string  \n}\n\n/**\n *  Demo of user session, show login screen and handling user login submission.\n *\n *  To support Google SSO in your portal, you must add your domain to the Authorized Redirect URIs\n *  for Synapse authentication.\n *  This can be done by contacting synapseInfo@sagebionetworks.org to form a collaboration.\n *  Synapse engineers must add your redirect URL in the Google API console found at https://console.cloud.google.com/ for this functionality to work.\n *\n * @class Login\n * @extends {React.Component}\n */\nclass Login extends React.Component<Props, State> {\n\n    /**\n     * Creates a user session, maintaining credentials\n     * @param {*} props\n     * @memberof Login\n     */\n  constructor(props: Props) {\n    super(props)\n    this.state = {\n      email: '',\n      errorMessage: '',\n      hasLoginInFailed: false,\n      isSignedIn: false,\n      password: '',\n      username: ''\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.handleLogin = this.handleLogin.bind(this)\n    this.getTokenView = this.getTokenView.bind(this)\n    this.getLoginFailureView = this.getLoginFailureView.bind(this)\n    this.onSignIn = this.onSignIn.bind(this)\n  }\n    /**\n     * Updates internal state with the event that was triggered\n     *\n     * @param {*} event Form update\n     */\n  public handleChange(event: React.FormEvent<HTMLInputElement>): void {\n    const target = event.currentTarget\n    const name = target.name\n    const value = target.value\n    const newState: (Pick<any, any>) = { [name]: value }\n    this.setState(newState)\n  }\n    /**\n     * Handle user login on click\n     *\n     * @param {*} clickEvent Userclick event\n     */\n  public handleLogin(clickEvent: React.FormEvent<HTMLElement>) {\n    clickEvent.preventDefault() // avoid page refresh\n    const repoEndpoint = this.props.repoEndpoint ? this.props.repoEndpoint : SynapseClient.DEFAULT_ENDPOINT\n    const swcEndpoint = this.props.swcEndpoint ? this.props.swcEndpoint : SynapseClient.DEFAULT_SWC_ENDPOINT\n    SynapseClient.login(this.state.username, this.state.password, repoEndpoint)\n            .then((data: any) => {\n              SynapseClient.setSessionTokenCookie(data.sessionToken, swcEndpoint).then(() => {\n                // on session change, reload the page so that all components get the new token from the cookie\n                window.location.reload()\n              }).catch((errSetSession) => {\n                console.log('Could not set session token cookie!', errSetSession)\n                this.setState({\n                  errorMessage: errSetSession.reason,\n                  hasLoginInFailed: true,\n                  isSignedIn: false\n                })\n              })\n            })\n            .catch((err: any) => {\n              console.log('Handle login failed with err = ', err)\n              this.setState({\n                errorMessage: err.reason,\n                hasLoginInFailed: true,\n                isSignedIn: false\n              })\n            })\n  }\n\n    /**\n     * Shows user session token if they've signed in\n     *\n     * @returns View displaying user session on login, otherwise null.\n     */\n  public getTokenView(): (JSX.Element | boolean) {\n    if (this.state.isSignedIn && this.props.token !== '' && !this.state.hasLoginInFailed) {\n      return <p> Your session token is {this.props.token} </p>\n    }\n    return false\n  }\n    /**\n     * Shows user login failure view on login failure\n     *\n     * @returns view to be displayed on user sign in error.\n     */\n  public getLoginFailureView(): (JSX.Element | boolean) {\n    if (this.state.hasLoginInFailed) {\n      return (\n                <div>\n                    <small className=\"form-text text-danger\"> {this.state.errorMessage} </small>\n                    <div className=\"invalid-feedback\" />\n                </div>\n      )\n    }\n    return false\n  }\n    /**\n     * Show whether user is signed in or not, display banner on login success\n     *\n     * @returns View corresponding to whether the user is signed in, whether they've dismissed\n     * sign in banner\n     */\n  public getSignInStateView(): (JSX.Element | boolean) {\n    if (!this.state.isSignedIn) {\n      return (\n                <p>\n                    {' '}\n                    You are currently{' '}\n                    <strong>\n                        {' '}\n                        <i> not </i>{' '}\n                    </strong>{' '}\n                    signed in to Synpase{' '}\n                </p>\n      )\n    }\n    return false\n  }\n  public onSignIn(event: React.MouseEvent<HTMLButtonElement>) {\n    // save current route (so that we can go back here after SSO)\n    localStorage.setItem('after-sso-login-url', window.location.href)\n    event.preventDefault()\n    const redirectUrl = this.props.googleRedirectUrl ? this.props.googleRedirectUrl : `${SynapseClient.getRootURL()}?provider=${SynapseClient.AUTH_PROVIDER}`\n    SynapseClient.oAuthUrlRequest(SynapseClient.AUTH_PROVIDER, redirectUrl)\n            .then((data: any) => {\n              const authUrl = data.authorizationUrl\n              window.location = authUrl // ping the url\n            })\n            .catch((err: any) => {\n              console.log('Error on oAuth url ', err)\n            })\n  }\n  public render() {\n    const { theme, icon } = this.props\n    const swcEndpoint = this.props.swcEndpoint ? this.props.swcEndpoint : SynapseClient.DEFAULT_SWC_ENDPOINT\n    const googleTheme = theme === 'dark' ? 'SRC-google-button-dark-color' : 'SRC-google-button-light-color'\n    return (\n      <div id=\"loginPage\" className=\"container loginContainer SRC-syn-border-spacing\">\n        <form>\n          <button onClick={this.onSignIn} className={`SRC-google-button ${googleTheme} SRC-marginBottomTen`}>\n          <GoogleIcon key={1} active={true} />\n          <ButtonContent icon={icon} key={2}>\n              Sign in with Google\n          </ButtonContent>\n          </button>\n        </form>\n        <div className=\"SRC-center-text SRC-deemphasized-text SRC-marginBottomTen\">or</div>\n\n        <div className=\"SRC-centerAndJustifyContent SRC-marginBottomTen\">\n          <img \n            height=\"20px\"\n            style={{marginRight: '10px'}}\n            alt={'sage bionetworks logo'}\n            src=\"https://s3.amazonaws.com/static.synapse.org/sage-bionetworks-logo.svg\" \n          />\n          Sign in with your Sage Bionetworks Synapse account\n        </div>\n        <form onSubmit={this.handleLogin} className=\"form-group\">\n          <input\n            autoComplete=\"username\"\n            placeholder=\"username or email\"\n            className=\"form-control SRC-marginBottomTop\"\n            id=\"exampleEmail\"\n            name=\"username\"\n            type=\"text\"\n            value={this.state.username}\n            onChange={this.handleChange}\n          />\n          <input\n            autoComplete=\"password\"\n            placeholder=\"password\"\n            className=\"form-control SRC-marginBottomTop\"\n            id=\"examplePassword\"\n            name=\"password\"\n            type=\"password\"\n            value={this.state.password}\n            onChange={this.handleChange}\n          />\n          {this.getLoginFailureView()}\n          <button\n            onSubmit={this.handleLogin}\n            type=\"submit\"\n            className=\"btn SRC-primary-background-color SRC-hoverWhiteText\n              SRC-whiteText m-1 SRC-google-button SRC-marginBottomTen\"\n          >\n            <ButtonContent icon={icon}>\n              Sign in\n            </ButtonContent>\n          </button>\n        </form>\n        <div>\n          <a\n            href={`${swcEndpoint}#!PasswordReset:0`}\n            className=\"SRC-floatLeft SRC-primary-text-color\"\n          >\n            Forgot password?\n          </a>\n          <span className=\"SRC-deemphasized-text SRC-floatRight\">&nbsp;It's free!</span>\n          <a\n            href={`${swcEndpoint}#!RegisterAccount:0`}\n            className=\"SRC-floatRight SRC-primary-text-color\"\n          >\n            Register\n          </a>\n        </div>\n      </div>\n    )\n  }\n}\nexport default Login\n","// EntityForm:\n// Will generate a Form (based on your schema files).\n// Gathers user input (including files)\n// Will give you the Synapse ID of the FileEntity that contains the user form data.\nimport * as React from 'react'\nimport Form from 'react-jsonschema-form'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport { SynapseClient } from '../utils'\nimport { FileEntity } from '../utils/jsonResponses/FileEntity'\nimport { EntityId } from '../utils/jsonResponses/EntityId'\nimport { EntityLookupRequest } from '../utils/jsonResponses/EntityLookupRequest'\n\nexport type EntityFormProps = {\n  // Provide the parent container (folder/project), that should contain a folder (named <user_id>) that this user can write to.\n  parentContainerId: string,\n  formSchemaEntityId: string, // Synapse file that contains the form schema.\n  formUiSchemaEntityId: string, // Synapse file that contains the form ui schema.\n  initFormData: boolean // If true, it indicates that you’d like to download and pre-fill the form with the user's previous response.\n  token?: string, // user's session token\n  synIdCallback: (synId: string) => void, // callback.  Once the form output has been saved to a FileEntity, will send synID back\n}\ntype EntityFormState = {\n  error?: any,\n  isLoading?: boolean,\n  successfullyUploaded: boolean,\n  containerId?: string,\n  userprofile?: UserProfile,\n  currentFileEntity?: FileEntity, // file holding user form data\n  formData?: any, // form data that prepopulates the form\n  formSchema?: any, // schema that drives the form\n  formUiSchema?: any, // ui schema that directs how to render the form elements\n}\n\nexport default class EntityForm\n  extends React.Component<EntityFormProps, EntityFormState> {\n  formRef: any\n\n  constructor(props: EntityFormProps) {\n    super(props)\n    this.formRef = React.createRef()\n    this.state = {\n      isLoading: true,\n      successfullyUploaded: false,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh()\n  }\n\n  componentDidUpdate(prevProps: any) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      this.refresh()\n    }\n  }\n\n  submitForm = () => {\n    this.formRef.current.submit()\n  }\n\n  refresh = () => {\n    if (this.props.token) {\n      const promises = [\n        SynapseClient.getUserProfile(this.props.token),\n        SynapseClient.getEntity(this.props.token, this.props.formSchemaEntityId),\n        SynapseClient.getEntity(this.props.token, this.props.formUiSchemaEntityId),\n      ] as Promise<any> []\n      Promise.all(promises).then((values) => {\n        const userprofile: UserProfile = values[0]\n        this.getTargetContainer(userprofile, this.props.token!).then((targetContainerId: string) => {\n          const formSchemaFileEntity: FileEntity = values[1]\n          const formUiSchemaFileEntity: FileEntity = values[2]\n          this.getSchemaFileContent(targetContainerId, formSchemaFileEntity, formUiSchemaFileEntity)\n        })\n      }).catch((error) => {\n        this.onError(error)\n      })\n    }\n  }\n\n  getSchemaFileContent = (\n    targetFolderId: string,\n    formSchemaFileEntity: FileEntity,\n    formUiSchemaFileEntity: FileEntity\n  ) => {\n    const promises = [\n      SynapseClient.getFileEntityContent(this.props.token!, formSchemaFileEntity),\n      SynapseClient.getFileEntityContent(this.props.token!, formUiSchemaFileEntity),\n    ]\n    Promise.all(promises).then((values) => {\n      const formSchemaContent = JSON.parse(values[0])\n      const formUiSchemaContent = JSON.parse(values[1])\n      this.getExistingFileData(targetFolderId, formSchemaContent, formUiSchemaContent)\n    }).catch((error) => {\n      this.onError(error)\n    })\n  }\n\n  getExistingFileData = (targetFolderId: string, formSchemaContent: any, formUiSchemaContent: any) => {\n    // if data already exists, save a reference to the existing entity and prefill the form\n    const fileName = `${formSchemaContent.title}.json`\n    const entityLookupRequest = { entityName: fileName, parentId: targetFolderId }\n    let formData: any\n    let currentFileEntity: FileEntity\n    SynapseClient.lookupChildEntity(entityLookupRequest, this.props.token).then((entityId:EntityId) => {\n      // ok, found the existing file\n      return SynapseClient.getEntity<FileEntity>(this.props.token, entityId.id).then((entity) => {\n        currentFileEntity = entity\n        if (this.props.initFormData) {\n          return SynapseClient.getFileEntityContent(this.props.token!, currentFileEntity).then((existingFileData) => {\n            formData = JSON.parse(existingFileData)\n          })\n        }\n        // else we're done\n        return Promise.resolve()\n      })\n    }).finally(() => {\n      this.setState(\n        {\n          formData,\n          currentFileEntity,\n          formSchema: formSchemaContent,\n          formUiSchema: formUiSchemaContent\n        })\n    })\n  }\n\n  getTargetContainer = async (userprofile: UserProfile, token: string) => {\n    const entityLookupRequest: EntityLookupRequest = {\n      entityName: userprofile.ownerId,\n      parentId: this.props.parentContainerId\n    }\n    try {\n      const entityId = await SynapseClient.lookupChildEntity(entityLookupRequest, token)\n      // ok, found an entity of the same name.\n      console.log(`EntityForm uploading to https://www.synapse.org/#!Synapse:${entityId.id}`)\n      this.setState({\n        userprofile,\n        containerId: entityId.id,\n        isLoading: false\n      })\n      return entityId.id\n    } catch (error) {\n      if (error.statusCode === 404) {\n        return this.onError(new Error('Your folder has not yet been set up, please retry in a few minutes.'))\n      }\n      // else\n      return this.onError(error)\n    }\n  }\n\n  finishedProcessing = () => {\n    this.setState(\n      {\n        isLoading: false,\n        successfullyUploaded: true,\n      })\n  }\n\n  onError = (error: any) => {\n    this.setState({\n      error,\n      isLoading: false,\n      successfullyUploaded: false\n    })\n  }\n\n  onSubmit = ({ formData }: any) => {\n    this.setState(\n      {\n        isLoading: true,\n        successfullyUploaded: false\n      })\n\n    const submissionFileAndForm: Blob = new Blob([JSON.stringify(formData)], {\n      type: 'text/json'\n    })\n    this.createEntityFile(submissionFileAndForm)\n  }\n\n  createEntityFile = (fileContentsBlob: Blob) => {\n    const fileName = `${this.state.formSchema.title}.json`\n    SynapseClient.uploadFile(this.props.token, fileName, fileContentsBlob).then(\n      (fileUploadComplete: any) => {\n        // do we need to create a new file entity, or update an existing file entity?\n        const newFileHandleId = fileUploadComplete.fileHandleId\n        if (this.state.currentFileEntity) {\n          this.state.currentFileEntity.dataFileHandleId = newFileHandleId\n          return SynapseClient.updateEntity(this.state.currentFileEntity, this.props.token)\n        }\n        // else, it's a new file entity\n        const newFileEntity: FileEntity = {\n          parentId: this.state.containerId!,\n          name: fileName,\n          concreteType: 'org.sagebionetworks.repo.model.FileEntity',\n          dataFileHandleId: newFileHandleId,\n        }\n        return SynapseClient.createEntity(newFileEntity, this.props.token)\n      }).then((fileEntity: FileEntity) => {\n        // by this point we've either found and updated the existing file entity, or created a new one.\n        this.finishedProcessing()\n        if (this.props.synIdCallback) {\n          this.props.synIdCallback(fileEntity.id!)\n        }\n      }).catch((error: any) => {\n        this.onError(error)\n      })\n  }\n\n  render() {\n    return (\n      <div>\n        {\n          this.state.error &&\n          <div className=\"panel panel-danger errors\">\n            <div className=\"panel-heading\">\n              <h3 className=\"panel-title\">Error</h3>\n            </div>\n            <ul className=\"list-group\">\n              <li className=\"list-group-item text-danger\">\n                {this.state.error.name} {this.state.error.reason} {this.state.error.message}\n              </li>\n            </ul>\n          </div>\n        }\n        {\n          this.props.token &&\n          !this.state.isLoading &&\n          !this.state.successfullyUploaded &&\n          this.state.formSchema &&\n          this.state.formUiSchema &&\n          !this.state.error &&\n          <Form\n            formData={this.state.formData}\n            schema={this.state.formSchema}\n            uiSchema={this.state.formUiSchema}\n            onSubmit={this.onSubmit}\n            showErrorList={true}\n            ref={this.formRef}\n          >\n            <div style={{ display: 'none' }}>\n              <button type=\"submit\" className=\"btn btn-info\">Submit</button>\n            </div>\n          </Form>\n        }\n        {\n          !this.state.error &&\n          this.props.token &&\n          this.state.isLoading &&\n          <React.Fragment>\n            <span>Saving&hellip;</span>\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          </React.Fragment>\n        }\n      </div>\n    )\n  }\n}\n","\nconst COLOR_PALETTE_EVEN: string [] = [\n  'rgb(91,176,181)',\n  'rgb(124,192,196)',\n  'rgb(157,208,211)',\n  'rgb(189,223,225)',\n  'rgb(222,239,240)',\n  'rgb(217,229,236)',\n  'rgb(179,202,217)',\n  'rgb(140,176,198)',\n  'rgb(102,149,179)',\n  'rgb(64,123,160)',\n  'rgb(201,66,129)',\n  'rgb(212,104,154)',\n  'rgb(223,142,179)',\n  'rgb(233,179,205)',\n  'rgb(244,217,230)',\n  'rgb(218,214,229)',\n  'rgb(181,173,203)',\n  'rgb(145,133,177)',\n  'rgb(108,92,151)',\n  'rgb(71,51,125)',\n  'rgb(222,154,31)',\n  'rgb(229,174,76)',\n  'rgb(235,194,121)',\n  'rgb(242,215,165)',\n  'rgb(248,235,210)',\n  'rgb(207,234,231)',\n  'rgb(159,212,207)',\n  'rgb(112,191,184)',\n  'rgb(64,169,160)',\n  'rgb(16,148,136)',\n  'rgb(60,74,99)',\n  'rgb(99,110,130)',\n  'rgb(138,146,161)',\n  'rgb(177,183,193)',\n  'rgb(216,219,224)',\n  'rgb(246,226,210)',\n  'rgb(238,197,165)',\n  'rgb(229,167,120)',\n  'rgb(221,138,75)',\n  'rgb(212,109,30)',\n  'rgb(88,161,88)',\n  'rgb(121,180,121)',\n  'rgb(155,199,155)',\n  'rgb(188,217,188)',\n  'rgb(222,236,222)',\n  'rgb(220,227,242)',\n  'rgb(185,198,230)',\n  'rgb(151,170,217)',\n  'rgb(116,141,205)',\n  'rgb(81,113,192)',\n  'rgb(178,36,42)',\n  'rgb(193,80,85)',\n  'rgb(209,124,127)',\n  'rgb(224,167,170)',\n  'rgb(240,211,212)',\n  'rgb(222,239,240)',\n  'rgb(189,223,225)',\n  'rgb(157,208,211)',\n  'rgb(124,192,196)',\n  'rgb(91,176,181)',\n  'rgb(64,123,160)',\n  'rgb(102,149,179)',\n  'rgb(140,176,198)',\n  'rgb(179,202,217)',\n  'rgb(217,229,236)',\n  'rgb(244,217,230)',\n  'rgb(233,179,205)',\n  'rgb(223,142,179)',\n  'rgb(212,104,154)',\n  'rgb(201,66,129)',\n  'rgb(71,51,125)',\n  'rgb(108,92,151)',\n  'rgb(145,133,177)',\n  'rgb(181,173,203)',\n  'rgb(218,214,229)',\n  'rgb(248,235,210)',\n  'rgb(242,215,165)',\n  'rgb(235,194,121)',\n  'rgb(229,174,76)',\n  'rgb(222,154,31)',\n  'rgb(16,148,136)',\n  'rgb(64,169,160)',\n  'rgb(112,191,184)',\n  'rgb(159,212,207)',\n  'rgb(207,234,231)',\n  'rgb(216,219,224)',\n  'rgb(177,183,193)',\n  'rgb(138,146,161)',\n  'rgb(99,110,130)',\n  'rgb(60,74,99)',\n  'rgb(212,109,30)',\n  'rgb(221,138,75)',\n  'rgb(229,167,120)',\n  'rgb(238,197,165)',\n  'rgb(246,226,210)',\n  'rgb(222,236,222)',\n  'rgb(188,217,188)',\n  'rgb(155,199,155)',\n  'rgb(121,180,121)',\n  'rgb(88,161,88)',\n  'rgb(81,113,192)',\n  'rgb(116,141,205)',\n  'rgb(151,170,217)',\n  'rgb(185,198,230)',\n  'rgb(220,227,242)',\n  'rgb(240,211,212)',\n  'rgb(224,167,170)',\n  'rgb(209,124,127)',\n  'rgb(193,80,85)',\n  'rgb(178,36,42)'\n]\n\nconst COLOR_PALETTE_ODD: string [] = [\n  'rgb(64,123,160)',\n  'rgb(102,149,179)',\n  'rgb(140,176,198)',\n  'rgb(179,202,217)',\n  'rgb(217,229,236)',\n  'rgb(244,217,230)',\n  'rgb(233,179,205)',\n  'rgb(223,142,179)',\n  'rgb(212,104,154)',\n  'rgb(201,66,129)',\n  'rgb(71,51,125)',\n  'rgb(108,92,151)',\n  'rgb(145,133,177)',\n  'rgb(181,173,203)',\n  'rgb(218,214,229)',\n  'rgb(248,235,210)',\n  'rgb(242,215,165)',\n  'rgb(235,194,121)',\n  'rgb(229,174,76)',\n  'rgb(222,154,31)',\n  'rgb(16,148,136)',\n  'rgb(64,169,160)',\n  'rgb(112,191,184)',\n  'rgb(159,212,207)',\n  'rgb(207,234,231)',\n  'rgb(216,219,224)',\n  'rgb(177,183,193)',\n  'rgb(138,146,161)',\n  'rgb(99,110,130)',\n  'rgb(60,74,99)',\n  'rgb(212,109,30)',\n  'rgb(221,138,75)',\n  'rgb(229,167,120)',\n  'rgb(238,197,165)',\n  'rgb(246,226,210)',\n  'rgb(222,236,222)',\n  'rgb(188,217,188)',\n  'rgb(155,199,155)',\n  'rgb(121,180,121)',\n  'rgb(88,161,88)',\n  'rgb(81,113,192)',\n  'rgb(116,141,205)',\n  'rgb(151,170,217)',\n  'rgb(185,198,230)',\n  'rgb(220,227,242)',\n  'rgb(240,211,212)',\n  'rgb(224,167,170)',\n  'rgb(209,124,127)',\n  'rgb(193,80,85)',\n  'rgb(178,36,42)',\n  'rgb(91,176,181)',\n  'rgb(124,192,196)',\n  'rgb(157,208,211)',\n  'rgb(189,223,225)',\n  'rgb(222,239,240)',\n  'rgb(217,229,236)',\n  'rgb(179,202,217)',\n  'rgb(140,176,198)',\n  'rgb(102,149,179)',\n  'rgb(64,123,160)',\n  'rgb(201,66,129)',\n  'rgb(212,104,154)',\n  'rgb(223,142,179)',\n  'rgb(233,179,205)',\n  'rgb(244,217,230)',\n  'rgb(218,214,229)',\n  'rgb(181,173,203)',\n  'rgb(145,133,177)',\n  'rgb(108,92,151)',\n  'rgb(71,51,125)',\n  'rgb(222,154,31)',\n  'rgb(229,174,76)',\n  'rgb(235,194,121)',\n  'rgb(242,215,165)',\n  'rgb(248,235,210)',\n  'rgb(207,234,231)',\n  'rgb(159,212,207)',\n  'rgb(112,191,184)',\n  'rgb(64,169,160)',\n  'rgb(16,148,136)',\n  'rgb(60,74,99)',\n  'rgb(99,110,130)',\n  'rgb(138,146,161)',\n  'rgb(177,183,193)',\n  'rgb(216,219,224)',\n  'rgb(246,226,210)',\n  'rgb(238,197,165)',\n  'rgb(229,167,120)',\n  'rgb(221,138,75)',\n  'rgb(212,109,30)',\n  'rgb(88,161,88)',\n  'rgb(121,180,121)',\n  'rgb(155,199,155)',\n  'rgb(188,217,188)',\n  'rgb(222,236,222)',\n  'rgb(220,227,242)',\n  'rgb(185,198,230)',\n  'rgb(151,170,217)',\n  'rgb(116,141,205)',\n  'rgb(81,113,192)',\n  'rgb(178,36,42)',\n  'rgb(193,80,85)',\n  'rgb(209,124,127)',\n  'rgb(224,167,170)',\n  'rgb(240,211,212)',\n  'rgb(222,239,240)',\n  'rgb(189,223,225)',\n  'rgb(157,208,211)',\n  'rgb(124,192,196)',\n  'rgb(91,176,181)'\n]\n\nexport { COLOR_PALETTE_EVEN, COLOR_PALETTE_ODD }\n","import { COLOR_PALETTE_EVEN, COLOR_PALETTE_ODD } from './colorPalette'\n\nexport function getColorPallette(start: number, end: number): {colorPalette: string [], textColors: string []} {\n  let colorPalleteSelection = []\n  const textColors = []\n  let offset = -1\n\n  if (start % 2 === 0) {\n    colorPalleteSelection = COLOR_PALETTE_EVEN\n    offset = start * 5\n  } else {\n    colorPalleteSelection = COLOR_PALETTE_ODD\n    offset = (start - 1) * 5\n  }\n\n  const colorPalette: string [] = []\n\n  for (let i = 0; i < end; i += 1) {\n    const textColor: string = i % 10 < 2 || i % 10 > 7 ? 'white' : 'black'\n    const color: string =  `${colorPalleteSelection[(offset + i) % colorPalleteSelection.length]}`\n    colorPalette.push(color)\n    textColors.push(textColor)\n  }\n  return { colorPalette, textColors }\n}\n\nexport default getColorPallette\n","// This file is used for any import modules that have to be\n// rewritten due rollup import nuances\n\nimport * as cloneDeepProxy from 'lodash.clonedeep'\n\n// wonky syntax explained here - https://github.com/rollup/rollup/issues/670#issuecomment-281139978\nexport function cloneDeep <T>(x : T): T {\n  const fn = ((cloneDeepProxy as any).default) || cloneDeepProxy\n  return fn(x)\n}\n","import { QueryBundleRequest } from '../jsonResponses/Table/QueryBundleRequest'\nimport { SynapseClient, SynapseConstants } from '../'\nimport { QueryResultBundle } from '../jsonResponses/Table/QueryResultBundle'\nimport { cloneDeep } from './rollupCompatibleModules'\n\ntype PartialStateObject = {\n  hasMoreData: boolean,\n  data: QueryResultBundle,\n}\n\n/**\n * Grab the next page of data, pulling in 25 more rows.\n *\n * @param {*} queryRequest Query request as specified by\n *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n */\nexport const getNextPageOfData = async (queryRequest: QueryBundleRequest, data: QueryResultBundle, token?: string) => {\n  return await SynapseClient.getQueryTableResults(queryRequest, token)\n    .then(\n    (newData: QueryResultBundle) => {\n      const oldData: QueryResultBundle = cloneDeep(data)!\n      // push on the new data retrieved from the API call\n      const hasMoreData = newData\n                          .queryResult\n                          .queryResults\n                          .rows\n                          .length === SynapseConstants.PAGE_SIZE\n      oldData.queryResult.queryResults.rows.push(...newData.queryResult.queryResults.rows)\n      const newState: PartialStateObject = {\n        hasMoreData,\n        data: oldData,\n      }\n      return newState\n    }\n    ).catch((err) => {\n      console.log('Failed to get data ', err)\n      return {} as PartialStateObject\n    })\n}\n","import { FacetSelection } from '../../containers/QueryWrapper'\nimport { QueryBundleRequest } from '../jsonResponses/Table/QueryBundleRequest'\nimport { FacetColumnValuesRequest } from '../jsonResponses/Table/FacetColumnRequest'\nimport { SELECT_SINGLE_FACET } from '../../containers/Facets'\nimport { FacetColumnResultValueCount } from '../jsonResponses/Table/FacetColumnResult'\n\n/**\n *  Calculates the state of a specific facet value given the current state\n *  of the application.\n *\n * @param\n *     isLoading: boolean | undefined,\n *     lastFacetSelection: FacetSelection | undefined,\n *     curFacetSelection: any,\n *     columnName: string\n * @returns boolean\n */\n\nexport const getIsValueSelected = ({\n  isLoading,\n  lastFacetSelection,\n  curFacetSelection,\n  columnName\n} : {\n  isLoading: boolean | undefined,\n  lastFacetSelection: FacetSelection | undefined,\n  curFacetSelection: FacetColumnResultValueCount,\n  columnName: string\n}) => {\n  if (isLoading && columnName === lastFacetSelection!.columnName) {\n    // indicates there is a selection made with this current facet value\n    if (lastFacetSelection!.facetValue === curFacetSelection.value) {\n      return !curFacetSelection.isSelected\n    }\n    if (lastFacetSelection!.selector === SELECT_SINGLE_FACET) {\n      return false\n    }\n  }\n  /*\n    else, the information has come back from the server and we can\n    rely on that\n  */\n  return curFacetSelection.isSelected\n\n}\n\nexport type SyntheticHTMLInputElement = {\n  value: string\n  checked: boolean\n}\n\n/**\n * Function reads over a set of checkboxes and then returns a corresponding\n * queryRequest given the state of the prior queryRequest\n *   htmlCheckboxes: any,\n *   selector : string,\n *   queryRequest: QueryBundleRequest,\n *   facet: string,\n *   value?: string\n * }\n * @returns\n */\nexport const readFacetValues = ({\n  htmlCheckboxes,\n  selector,\n  queryRequest,\n  facet,\n  value\n}: {\n  htmlCheckboxes: SyntheticHTMLInputElement [],\n  selector : string,\n  queryRequest: QueryBundleRequest,\n  facet: string,\n  value?: string\n}) => {\n  const facetValues: string[] = []\n\n  if (!selector) {\n    // no selector was clicked -- read over facet values as normal and see what was clicked\n    for (let i = 0; i < htmlCheckboxes.length; i += 1) {\n      const checkbox = htmlCheckboxes[i]\n      const isSelected = checkbox.checked\n      if (isSelected) {\n        facetValues.push(checkbox.value)\n      }\n    }\n  } else if (selector === SELECT_SINGLE_FACET) {\n    // SELECT_SINGLE_FACET acts as a radio selection, thats the only selection\n    facetValues.push(value!)\n  } // else selector === SELECT_ALL, we don't add any values, empty is treated as SELECT_ALL\n  const newQueryRequest: QueryBundleRequest = queryRequest\n  const { selectedFacets = [] } = newQueryRequest.query\n\n  const specificFacet = selectedFacets!.find(el => el.columnName === facet)!\n  if (!specificFacet) {\n    const facetColumnValuesRequest: FacetColumnValuesRequest =  {\n      facetValues,\n      concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n      columnName: facet\n    }\n    selectedFacets.push(facetColumnValuesRequest)\n    // align the reference to selectedFacets\n    newQueryRequest.query.selectedFacets = selectedFacets\n  } else {\n    specificFacet.facetValues = facetValues\n  }\n\n  return { newQueryRequest }\n}\n","import * as React from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faLongArrowAltUp, faLongArrowAltDown } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { DOI_REGEX } from '../../../containers/GenericCard'\nlibrary.add(faLongArrowAltUp)\nlibrary.add(faLongArrowAltDown)\n\ntype State = {\n  isShowMoreOn: boolean\n  isDesktop: boolean\n}\n\ntype CardFooterProps = {\n  values: any [],\n  isHeader: boolean\n  secondaryLabelLimit?: number\n}\n\n// regex to see if string is url - https://stackoverflow.com/a/3809435\nconst URL_REGEX = /[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*)?/gi;\n\nclass CardFooter extends React.Component<CardFooterProps, State> {\n\n  constructor(props: CardFooterProps) {\n    super(props)\n    this.state = {\n      isShowMoreOn: false,\n      isDesktop: false\n    }\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n    this.updatePredicate = this.updatePredicate.bind(this)\n  }\n\n  toggleShowMore() {\n    this.setState({\n      isShowMoreOn: !this.state.isShowMoreOn\n    })\n  }\n\n  componentDidMount() {\n    this.updatePredicate()\n    window.addEventListener('resize', this.updatePredicate)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updatePredicate)\n  }\n\n  updatePredicate() {\n    this.setState({ isDesktop: window.innerWidth > 600 })\n  }\n\n  renderRowValue = (columnName: string, value: string) => {\n    let textColorClass = this.props.isHeader ? 'SRC-lightLink' : ''\n    if (!value.match) {\n      // value can sometimes be a react element, so it doesn't have a .match function, interestingly I didn't \n      // see typeof return 'object' for that case which would be a better check.\n      return value\n    }\n    if (value.match(DOI_REGEX)) {\n      return  (\n        <a className={textColorClass} data-search-handle={columnName} target=\"_blank\" rel=\"noopener noreferrer\"  href={`https://dx.doi.org/${value}`}>\n          {value}\n        </a>\n      )\n    } else if (value.match(URL_REGEX)) {\n      return  (\n        <a className={textColorClass} data-search-handle={columnName} target=\"_blank\" rel=\"noopener noreferrer\"  href={value}>\n          {value}\n        </a>\n      ) \n    }\n    return value\n  }\n\n  renderRows = (values: string [][], limit: number, isDesktop: boolean) => {\n    return values.map((kv, index) => {\n      const hideClass =  (index >= limit ? 'SRC-hidden' : '')\n      const columnName = kv[0]\n      const value = this.renderRowValue(columnName, kv[1])\n      if (isDesktop) {\n        return (\n          <tr className={\"SRC-cardRowDesktop \" + hideClass} key={index}>\n            <td className={'SRC-verticalAlignTop SRC-row-label'}> {columnName} </td>\n            <td data-search-handle={columnName} className={\"SRC-row-data SRC-limitMaxWidth \"}> {value} </td>\n          </tr>\n        )\n      }\n      return (\n        <React.Fragment key={index}>\n          <tr className={\"SRC-cardRowMobile \" + hideClass}>\n            <td className={'SRC-verticalAlignTop SRC-row-label'}> {columnName} </td>\n          </tr>\n          <tr className={\"SRC-cardRowMobile \" + hideClass}>\n            <td data-search-handle={columnName} className=\"SRC-row-data SRC-limitMaxWidth\"> {value} </td>\n          </tr>\n        </React.Fragment>\n      )\n    })\n  }\n\n  render() {\n    const { values, secondaryLabelLimit = 3 } = this.props\n    const { isShowMoreOn, isDesktop } = this.state\n    let valuesFiltered = values.filter(el => el[1])\n    const hasMoreValuesThanLimit = valuesFiltered.length > secondaryLabelLimit\n    const limit = !hasMoreValuesThanLimit || isShowMoreOn ? Infinity: secondaryLabelLimit\n    return (\n      <div className=\"SRC-cardMetadata\">\n        <table>\n          <tbody>\n            {this.renderRows(valuesFiltered, limit, isDesktop)}\n            {\n              hasMoreValuesThanLimit &&\n                <tr className=\"SRC-cardRow\">\n                  <td>\n                  <button\n                    style={{ textAlign: 'left', margin: 0, padding: 0 }}\n                    className=\"SRC-primary-text-color SRC-basicButton\"\n                    onClick={this.toggleShowMore}\n                  >\n                    Show {isShowMoreOn ?  'Less' : 'More'}\n                    <FontAwesomeIcon\n                      style={{ marginLeft: '5px' }}\n                      icon={isShowMoreOn ? 'long-arrow-alt-up' : 'long-arrow-alt-down'}\n                    />\n                  </button>\n                  </td>\n                </tr>\n            }\n          </tbody>\n        </table>\n      </div>\n    )\n  }\n}\nexport default CardFooter\n","import * as React from 'react'\n\ntype ChipContainerProps = {\n  chips: any []\n}\n\nconst ChipContainer: React.SFC<ChipContainerProps> = ({ chips }) => {\n  const chipsFormatted = chips.map((el, index) => {\n    if (!el) {\n      return false\n    }\n    return <span key={index}> {el}</span>\n  })\n  return (\n        <React.Fragment>\n            {chipsFormatted}\n        </React.Fragment>\n  )\n}\nexport default ChipContainer\n","import * as React from 'react'\nimport {\n  DATASET,\n  FUNDER,\n  PUBLICATION,\n  STUDY_ACTIVE,\n  STUDY_COMPLETE,\n  TOOL,\n  STUDY,\n  EXPERIMENTAL,\n  COMPUTATIONAL,\n  CLINICAL,\n  PROJECT\n} from '../../../utils/SynapseConstants'\n\nimport PublicationSvg from '../../../assets/icons/Publication.svg'\nimport Data2Svg from '../../../assets/icons/Data2.svg'\nimport studyActiveSvg from '../../../assets/icons/study-active.svg'\nimport studySvg from '../../../assets/icons/study.svg'\nimport studyCompleteSvg from '../../../assets/icons/study-complete.svg'\nimport DNA_TwoSvg from '../../../assets/icons/DNA_Two.svg'\nimport ToolClinicalSvg from '../../../assets/icons/ToolClinical.svg'\nimport ToolComputationalSvg from '../../../assets/icons/ToolComputational.svg'\nimport ToolExperimentalSvg from '../../../assets/icons/ToolExperimental.svg'\nimport projectSvg from '../../../assets/icons/project.svg'\n\nimport { KeyValue } from '../../../../lib/utils/modules/sqlFunctions'\n\ntype IconProps = {\n  type: string\n  iconOptions?: KeyValue\n  value?: string\n}\n\nconst defaultIcons = {\n  [PUBLICATION]: PublicationSvg,\n  [DATASET]: Data2Svg,\n  [FUNDER]: Data2Svg,\n  [STUDY_ACTIVE]: studyActiveSvg,\n  [STUDY_COMPLETE]: studyCompleteSvg,\n  [STUDY]: studySvg,\n  [TOOL]: DNA_TwoSvg,\n  [EXPERIMENTAL]: ToolExperimentalSvg,\n  [COMPUTATIONAL]: ToolComputationalSvg,\n  [CLINICAL]: ToolClinicalSvg,\n  [PROJECT]: projectSvg\n}\nconst Icon: React.FunctionComponent<IconProps> = ({ type, value = '', iconOptions }) => {\n  const iconSet = { ...defaultIcons, ...iconOptions }\n  // see if the value has a corresponding icon, e.g. 'Active' in a studies table\n  // or if the type of card has a corresponding icon, e.g. 'Publication'\n  const icon = iconSet[value] || iconSet[type]\n  // TODO: get rid of dataset icon class, none of the icons should be special cased\n  const datasetIconClass = (value === DATASET) || (type === DATASET) ? 'SRC-datasetIcon' : ''\n  return (<img className={`iconImg  ${datasetIconClass}`} src={icon} />)\n}\nexport default Icon\n","import * as React from 'react'\nconst CHAR_COUNT_CUTOFF = 400\n\ntype ShowMoreState = {\n  showMore: boolean\n}\n\ntype ShowMoreProps = {\n  summary: string\n}\n\nexport default class ShowMore extends React.Component<ShowMoreProps, ShowMoreState> {\n\n  constructor(props: ShowMoreProps) {\n    super(props)\n    this.state = {\n      showMore: false\n    }\n    this.toggleShowMore = this.toggleShowMore.bind(this)\n  }\n\n  public toggleShowMore(event: React.MouseEvent<HTMLAnchorElement>) {\n    event.preventDefault()\n    this.setState({\n      showMore: true\n    })\n  }\n\n  getCutoff = (summary: string ) => {\n    let previewText = ''\n    if (!summary) { \n      return { previewText}\n    }\n    let hiddenText = ''\n    const summarySplit = summary!.split(' ')\n    // find num words to join such that its >= char_count_cutoff\n    let i = 0\n    while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n      previewText += `${summarySplit[i]} `\n      i += 1\n    }\n    if (i < summarySplit.length - 1 ) {\n      hiddenText = summarySplit.slice(i).join(' ')\n    }\n    return { previewText, hiddenText}\n  }\n\n  public render() {\n    const { summary } = this.props\n    const meetsCharRequirements = summary && summary.length >= CHAR_COUNT_CUTOFF\n    let { previewText, hiddenText } = this.getCutoff(summary)\n    const showMoreButton =  (\n        meetsCharRequirements &&\n        (\n        <a\n          style={{ fontSize: '14px', cursor: 'pointer', marginLeft: '1px' }}\n          className=\"SRC-primary-text-color\"\n          onClick={this.toggleShowMore}\n        >\n           ...Show More\n        </a>\n        )\n    )\n    return (\n      <React.Fragment>\n        <span>\n          {previewText}\n          <span className={this.state.showMore ? '': 'SRC-hidden'}>\n            {hiddenText}\n          </span>\n        </span>\n        {!this.state.showMore && showMoreButton}\n      </React.Fragment>\n    )\n  }\n}\n","import * as React from 'react'\nimport { CardFooter, Icon } from './row_renderers/utils'\n\nexport type IconOptions = {\n  [index: string]: string\n}\nexport type HeaderCardProps = {\n  iconOptions?: IconOptions\n  backgroundColor?: string\n  type: string\n  title: string\n  subTitle: string\n  description: string\n  iconValue: string\n  secondaryLabelLimit?: number\n  values?: string [][]\n}\n\nconst HeaderCard:React.FunctionComponent<HeaderCardProps> = ({\n  type,\n  title,\n  subTitle,\n  description,\n  iconOptions,\n  iconValue,\n  backgroundColor,\n  values,\n  secondaryLabelLimit\n}) => {\n  const style: React.CSSProperties = {\n    background: backgroundColor,\n  }\n  return (\n    <div\n      style={style}\n      className={'SRC-portalCardHeader'}\n    >\n      <div className=\"container-fluid\">\n        <div className=\"row\">\n          <div className=\"col-md-1 iconContainer\">\n            <Icon value={iconValue} iconOptions={iconOptions} type={type} />\n          </div>\n          <div className=\"SRC-cardContent col-md-10\">\n            <div className=\"SRC-type\">{type}</div>\n            <div >\n              <h3 className=\"SRC-boldText SRC-blackText\" style={{ margin: 'none' }}>\n                {title}\n              </h3>\n            </div>\n            {subTitle && <div className=\"SRC-author\"> {subTitle} </div>}\n            <span className=\"SRC-font-size-base\">\n              {description}\n            </span>\n            <div style={{ borderTop: '1px solid rgba(26, 28, 41, 0.2)', marginTop: '15px', paddingTop: '5px' }}>\n              {values && <CardFooter isHeader={true} secondaryLabelLimit={secondaryLabelLimit} values={values}/>}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default HeaderCard\n","import * as React from 'react'\nimport HeaderCard from './HeaderCard'\nimport { CardFooter, Icon } from './row_renderers/utils'\nimport { CardLink, LabelLinkConfig, LabelLink } from './CardContainerLogic'\n\nexport type KeyToAlias = {\n  key: string\n  alias?: string\n}\n\nexport type KeyToAliasMap = {\n  [index: number]: KeyToAlias\n  [index: string]: KeyToAlias\n}\n\nexport type GenericCardSchema = {\n  type: string\n  title: string\n  subTitle?: string\n  description?: string\n  icon?: string\n  secondaryLabels?: any []\n  link?: string\n}\n\nexport type IconOptions = {\n  [index: string]: string\n}\n\nexport type GenericCardProps = {\n  facetAliases?: {}\n  iconOptions?: IconOptions\n  backgroundColor?: string\n  isHeader?: boolean\n  genericCardSchema: GenericCardSchema,\n  schema: any,\n  data: any\n  secondaryLabelLimit?: number\n  titleLinkConfig?: CardLink\n  labelLinkConfig?: LabelLinkConfig\n}\n\nexport type GenericCardState = {\n  showMoreDescription: boolean\n}\n\nconst CHAR_COUNT_CUTOFF = 400\nexport const CARD_SHORT_DESCRIPTION_CSS = 'SRC-short-description'\nexport const CARD_LONG_DESCRIPTION_CSS = 'SRC-long-description'\n\n// doi regex here - https://www.crossref.org/blog/dois-and-matching-regular-expressions/\n// note - had to add an escape character for the second slash in the regex above\nexport const DOI_REGEX = /^10.\\d{4,9}\\/[-._;()/:a-z0-9]+$/\n// check for 'syn' followed and ended by a digit of unlimited length, must also begin the line\nexport const SYNAPSE_REGX = /^syn\\d+$/\n\nexport default class GenericCard extends React.Component<GenericCardProps, GenericCardState> {\n\n  constructor(props: GenericCardProps) {\n    super(props)\n    this.state = {\n      showMoreDescription: false\n    }\n    this.createTitleLink = this.createTitleLink.bind(this)\n    this.createLabelLink = this.createLabelLink.bind(this)\n  }\n\n  public createTitleLink (link: string, titleLink?: CardLink, data?: string [], schema?: any) {\n    let linkDisplay = link\n    let target = '_self'\n    if (link.match(SYNAPSE_REGX)) {\n      // its a synId\n      linkDisplay = `https://www.synapse.org/#!Synapse:${link}`\n    } else if (link.match(DOI_REGEX)) {\n      target = '_blank'\n      linkDisplay = `https://dx.doi.org/${link}`\n    } else if (!titleLink) {\n      target = '_blank'\n    } else if (titleLink) {\n      if (!data || !schema) {\n        throw Error('Must specify CardLink and data for linking to work')\n      }\n      const urlParams = titleLink.URLColumnNames.map(\n        (el) => {\n          if (!schema.hasOwnProperty(el)) {\n            console.error(`Could not find match for data: ${data} with columnName ${el}`)\n          }\n          return `${el}=${data[schema[el]]}`\n        }\n      ).join('&')\n      // tested this link on the browser, there's no need to encode the URL, the browser picks up on that automatically\n      linkDisplay = `#/${titleLink.baseURL}?${urlParams}`\n    }\n    return { linkDisplay, target }\n  }\n\n  getCutoff = (summary: string ) => {\n    let previewText = ''\n    const summarySplit = summary!.split(' ')\n    // find num words to join such that its >= char_count_cutoff\n    let i = 0\n    while (previewText.length < CHAR_COUNT_CUTOFF && i < summarySplit.length) {\n      previewText += `${summarySplit[i]} `\n      i += 1\n    }\n    previewText = previewText.trim()\n    return { previewText }\n  }\n\n  toggleShowMore = () => {\n    this.setState({\n      showMoreDescription: true\n    })\n  }\n\n  public createLabelLink (value: string, labelLink: LabelLink, isHeader: boolean) {\n    const split = value.split(',')\n    let className = ''\n    let style: React.CSSProperties = {}\n    if (isHeader) {\n      className = 'SRC-lightLink'\n    } else {\n      className = 'SRC-primary-text-color'\n    }\n    return split.map(\n      (el, index) => {\n        const { baseURL } = labelLink\n        const urlParams = labelLink.URLColumnNames.map(\n          urlColumn => {\n            return `${urlColumn}=${el}`\n          }\n        ).join('&')\n        const href = `#/${baseURL}?${urlParams}`\n        return (\n          <React.Fragment key={el}>\n            <a \n              href={href}\n              key={el}\n              className={className}\n              style={style}\n            >\n              {el}\n            </a>\n            {index < split.length - 1 && <span style={{marginRight: 4}}> , </span>}\n          </React.Fragment>\n        )\n      }\n    )\n  }\n\n  render() {\n    const {\n      schema,\n      data,\n      genericCardSchema,\n      secondaryLabelLimit,\n      backgroundColor,\n      iconOptions,\n      isHeader = false,\n      titleLinkConfig,\n      labelLinkConfig,\n      facetAliases = {}\n    } = this.props\n    const { showMoreDescription } = this.state\n    const { link = '' } = genericCardSchema\n    const type = genericCardSchema.type\n    const title = data[schema[genericCardSchema.title]]\n    const subTitle = genericCardSchema.subTitle && data[schema[genericCardSchema.subTitle]]\n    const description = data[schema[genericCardSchema.description || '']]\n    const iconValue = data[schema[genericCardSchema.icon || '']]\n    // wrap link in parens because undefined would throw an error\n    const linkValue: string = data[schema[link]] || ''\n    const { linkDisplay, target } = this.createTitleLink(linkValue, titleLinkConfig, data, schema)\n    const values: string [][] = []\n    const { secondaryLabels = [] } = genericCardSchema\n    for (let i = 0; i < secondaryLabels.length; i += 1) {\n      const columnName =  secondaryLabels[i]\n      let value = data[schema[columnName]]\n      if (value) {\n        const labelLink = labelLinkConfig && labelLinkConfig.find(el => el.matchColumnName === columnName)\n        if (labelLink) {\n          // create link for this column\n          value = this.createLabelLink(value, labelLink, isHeader)\n        }\n        const columnDisplayName = facetAliases[columnName] || columnName\n        const keyValue = [columnDisplayName, value]\n        values.push(keyValue)\n      }\n    }\n\n    const showFooter = values.length > 0\n\n    const style: React.CSSProperties = {\n      background: backgroundColor,\n      // undefined, take default value from class\n      marginTop: isHeader ? '0px' : undefined,\n      marginBottom: isHeader ? '0px' : undefined,\n      paddingBottom: showFooter ? undefined : '15px'\n    }\n\n    if (isHeader) {\n      return (\n        <HeaderCard\n          type={type}\n          title={title}\n          subTitle={subTitle}\n          backgroundColor={backgroundColor}\n          description={description}\n          iconValue={iconValue}\n          iconOptions={iconOptions}\n          values={values}\n          secondaryLabelLimit={secondaryLabelLimit}\n        />\n      )\n    }\n\n    const titleSearchHandle =facetAliases[genericCardSchema.title] || genericCardSchema.title\n    const stubTitleSearchHandle = facetAliases[genericCardSchema.subTitle || ''] || genericCardSchema.subTitle\n    const descriptionSubTitle = facetAliases[genericCardSchema.description || ''] || genericCardSchema.description\n    return (\n      <div\n        style={style}\n        className={'SRC-portalCard'}\n      >\n        <div className=\"SRC-cardThumbnail\">\n          <Icon iconOptions={iconOptions} value={iconValue} type={type} />\n        </div>\n        <div className=\"SRC-cardContent\">\n          <div className=\"SRC-type\">{type}</div>\n          <div >\n            <h3 className=\"SRC-boldText SRC-blackText\" style={{ margin: 'none' }}>\n              {linkDisplay ?\n                <a data-search-handle={titleSearchHandle} className=\"SRC-primary-text-color\" target={target} href={linkDisplay}>\n                  {title}\n                </a>\n                :\n                <span data-search-handle={titleSearchHandle}> {title} </span>\n              }\n            </h3>\n          </div>\n          {subTitle && <div data-search-handle={stubTitleSearchHandle} className=\"SRC-author\"> {subTitle} </div>}\n          {/* \n            Below is a hack that allows word highlighting to work, the Search componenet insert's\n            html elements outside of the React DOM which if detected would break the app,\n            but as written below this avoids that reconcilliation process.\n          */}\n          {\n            description &&\n            <div className={showMoreDescription ? 'SRC-hidden' : ''}>\n              <span data-search-handle={descriptionSubTitle} className={`SRC-font-size-base ${CARD_SHORT_DESCRIPTION_CSS} SRC-short-description`}>\n                {this.getCutoff(description).previewText}\n              </span>\n              {\n                description.length >= CHAR_COUNT_CUTOFF\n                &&\n                <a\n                  style={{ fontSize: '14px', cursor: 'pointer', marginLeft: '3px' }}\n                  className=\"SRC-primary-text-color\"\n                  onClick={this.toggleShowMore}\n                >\n                  ...Show More{' '}\n                </a>\n              }\n            </div>\n          }\n          {\n            description &&\n            <div className={showMoreDescription ? '' : 'SRC-hidden'}>\n              <span data-search-handle={descriptionSubTitle} className={`SRC-font-size-base ${CARD_LONG_DESCRIPTION_CSS}`}>\n                {description}\n              </span>\n            </div>\n          }\n        </div>\n        {showFooter && <CardFooter isHeader={false} secondaryLabelLimit={secondaryLabelLimit} values={values}/>}\n      </div>\n    )\n  }\n}\n","import { lexer, parser } from 'sql-parser'\nimport { SYNAPSE_REGX } from '../../containers/GenericCard'\n\nexport type KeyValue = {\n  [index: string]: string\n}\n\nexport type SQLOperator = 'LIKE' | '='\n\n// look for \"group by\", multi-line and case insensitive\nconst GROUP_BY_REGEX = /group by/mi\nexport const isGroupByInSql =(sql: string): boolean => {\n  return GROUP_BY_REGEX.test(sql)\n}\nconst WITHOUT_SYN_PREFIX = 3\n\nconst generateTokenUsingOperator = (literal: string, operator: SQLOperator, match: string) => {\n  let usedMatchForLike = match\n  if (match.match(SYNAPSE_REGX)) {\n    // If we use a LIKE statement with a synId the backend will look for a string with the first three\n    // characters being 'syn', however, it stores synIds without 'syn', so the query will fail\n    // The backend usually parses 'syn' out, but not with the LIKE clause since its expecting a regex, so we\n    // parse this out. This will cause a bug if something matches the synId regex but is in free text. \n    usedMatchForLike = match.substring(WITHOUT_SYN_PREFIX)\n  }\n  switch (operator) {\n    case 'LIKE':\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        ['STRING', `%${usedMatchForLike}%`, '1'], \n      ]\n    case '=':\n      return [\n        ['LITERAL', literal, '1'],\n        ['OPERATOR', operator, '1'],\n        ['STRING', match, '1'], \n      ]\n  } \n}\n\n// This will construct a sql query by adding the conditions in searchParams\n// to the WHERE clause, preserving all other clauses\nexport const insertConditionsFromSearchParams = (searchParams: KeyValue, sql: string, operator: SQLOperator = 'LIKE') => {\n  const tokens: string[][] = lexer.tokenize(sql)\n  // we want to either create a where clause or insert into the where clause\n  const foundIndex = tokens.findIndex(el => el[0] === 'WHERE')\n  const whereClauseIndex = foundIndex === -1 ? (tokens.findIndex(el => el[0] === 'FROM') + 2) : foundIndex\n  const indexAfterWhereClause = whereClauseIndex + 1\n  if (foundIndex === -1) {\n    // insert a where clause\n    tokens.splice(whereClauseIndex, 0, ['WHERE', 'WHERE', '1'])\n  } else {\n    // if this is inserting into a where clause then we have to make sure that the logic is chained\n    tokens.splice(indexAfterWhereClause, 0, ['CONDITIONAL', 'AND', '1'])\n  }\n  const searchParamsLen = Object.keys(searchParams).length\n  Object.keys(searchParams).forEach(\n    (key, index) => {\n      const token = generateTokenUsingOperator(key, operator, searchParams[key])\n      if (index < searchParamsLen - 1) {\n        // make sure to chain the ANDs until the last one\n        token.unshift(['CONDITIONAL', 'AND', '1'])\n      }\n      tokens.splice(indexAfterWhereClause, 0, ...token)\n    }\n  )\n  return formatSQLFromParser(tokens)\n}\n\nexport const formatSQLFromParser = (tokens: string [][]) => {\n  // remove backtick from output sql (for table name): `syn1234` becomes syn1234\n  const synId = tokens[tokens.findIndex(el => el[0] === 'FROM') + 1][1]\n  const newSql = parser.parse(tokens).toString()\n  const splitString = `\\`${synId}\\``\n  return newSql.split(splitString).join(synId)\n}\n","import { UiSchema } from 'react-jsonschema-form'\nimport { JSONSchema6 } from 'json-schema'\n\nexport const writeHeaderOption = \"First line is the columns names.\"\nexport const includeRowIdAndRowVersionOption = \"Include row metadata (Row Id and Row Version).\"\nexport const csvOption = \"Comma Separated Values (CSV)\"\nexport const tsvOption = \"Tab Separated Values (TSV)\"\n\n// Step 1\nconst stepOneFormSchema: JSONSchema6 = {\n  title: 'Download query results',\n  type: 'object',\n  properties: {\n    'File Type'  : {\n      type: \"string\",\n      oneOf: [\n        {\n          const: csvOption,\n          title: csvOption\n        },\n        {\n          const: tsvOption,\n          title: tsvOption\n        }\n      ],\n    },\n    Contents : {\n      type: \"array\",\n      title: 'Contents',\n      items: {\n        type: 'string',\n        enum: [writeHeaderOption, includeRowIdAndRowVersionOption],\n      },\n      uniqueItems: true\n    }\n  }\n}\n\nconst stepOneFormUISchema: UiSchema = {\n  'File Type': {\n    \"ui:widget\": \"radio\"\n  },\n  Contents: {\n    'ui:widget': 'checkboxes'\n  }\n}\n\n// Step 2\nconst stepTwoFormSchema: JSONSchema6 = {\n  title: 'Download query results',\n  description: 'File is ready for download. Select the download button to download the file.',\n  type: 'object',\n}\n\nconst stepTwoFormUISchema: UiSchema = {\n}\n\nexport const formSchemaArray = [stepOneFormSchema, stepTwoFormSchema]\nexport  const formSchemaUIArray = [stepOneFormUISchema, stepTwoFormUISchema]","import * as React from 'react'\nimport Form, { IChangeEvent } from 'react-jsonschema-form'\nimport { formSchemaArray, formSchemaUIArray, writeHeaderOption, includeRowIdAndRowVersionOption, csvOption } from './ModalDownload.FormSchema'\nimport { DownloadFromTableRequest } from '../utils/jsonResponses/Table/DownloadFromTableRequest'\nimport { SynapseClient } from '../utils'\nimport { DownloadFromTableResult } from '../utils/jsonResponses/Table/DownloadFromTableResult'\nimport { SortItem } from '../utils/jsonResponses/Table/Query'\nimport { FacetColumnRequest } from '../utils/jsonResponses/Table/FacetColumnRequest'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faTimes } from '@fortawesome/free-solid-svg-icons'\nimport { library } from '@fortawesome/fontawesome-svg-core'\n\nlibrary.add(faTimes)\n\nexport type ModalDownloadState = {\n  isLoading: boolean\n  step: number,\n  data?: DownloadFromTableResult\n  formData: {}\n}\n\nexport type ModalDownloadProps = {\n  entityId: string\n  sql: string\n  onClose: (...args: any []) => void\n  token?: string\n  includeEntityEtag?: boolean\n  selectedFacets?: FacetColumnRequest [] // The selected facet filters.\n  isConsistent?: boolean\n  offset?: number\n  limit?: number\n  sort?: SortItem []\n}\n\nexport default class ModalDownload extends React.Component<ModalDownloadProps, ModalDownloadState> {\n\n  constructor(props: ModalDownloadProps) {\n    super(props)\n    this.state = {\n      isLoading: false,\n      step: 0,\n      formData: {\n        'File Type': csvOption,\n        Contents: [writeHeaderOption, includeRowIdAndRowVersionOption]\n      }\n    }\n  }\n\n  handleSubmit = (event: IChangeEvent ) => {\n    if (this.state.step === 0) {\n      this.handleDownloadSetup(event)\n    } else {\n      this.onDownload()\n    }\n  }\n\n  handleDownloadSetup = (event: IChangeEvent) => {\n    this.setState({\n      isLoading: true\n    })\n    const { formData } = event\n    const fileType = formData['File Type']\n    const contents = formData.Contents as string []\n    const { token, onClose, ...rest } = this.props\n    const separator = fileType === csvOption ? ',': '\\t'\n    const writeHeader = contents.includes(writeHeaderOption)\n    const includeRowIdAndRowVersion = contents.includes(includeRowIdAndRowVersionOption)\n    const downloadFromTableRequest: DownloadFromTableRequest = {\n      ...rest,\n      concreteType: 'org.sagebionetworks.repo.model.table.DownloadFromTableRequest',\n      writeHeader,\n      includeRowIdAndRowVersion,\n      csvTableDescriptor: { separator },\n    }\n    SynapseClient.getDownloadFromTableRequest(downloadFromTableRequest, token).then(\n      data => {\n        this.setState({\n          isLoading: false,\n          step: 1,\n          data\n        })\n      }\n    ).catch(err => {\n      console.log('Error getDownloadFromTableRequest: ', err)\n    })\n  }\n\n  onDownload = () => {\n    const { data } = this.state\n    const { token } = this.props\n    // data will always be defined if calling this function\n    SynapseClient.getFileHandleByIdURL(data!.resultsFileHandleId, token).then(\n      url => {\n        window.location.href = url\n        this.props.onClose()\n      }\n    )\n  }\n\n  handleChange = (event: IChangeEvent) => {\n    const { formData } = event\n    this.setState({\n      formData\n    })\n  }\n\n  render() {\n    const closeBtn: React.CSSProperties = {\n      position: 'absolute',\n      top: 10,\n      right: 10,\n      zIndex: 10\n    }\n    const submitBtn: React.CSSProperties = {\n      padding: '6px 10px',\n      borderRadius: 6\n    }\n    const spinnerStyle: React.CSSProperties = {\n      height: 50,\n      width: 50,\n      backgroundSize: 50\n    }\n    return (\n      <React.Fragment>\n        <div className=\"custom-checkbox-container modal fade in SRC-block\" role=\"dialog\" tabIndex={-1}>\n          <div className=\"modal-dialog\" role=\"document\">\n            <div className=\"modal-content\">\n              <button style={closeBtn} onClick={this.props.onClose}>\n                <FontAwesomeIcon style={{fontSize: '21px'}} icon=\"times\" />\n              </button>\n              <div className=\"modal-body\">\n              <Form\n                schema={formSchemaArray[this.state.step]}\n                uiSchema={formSchemaUIArray[this.state.step]}\n                onChange={this.handleChange}\n                formData={this.state.formData}\n                onSubmit={this.handleSubmit}\n              >\n              {\n                this.state.isLoading\n                &&\n                <div className=\"SRC-centerAndJustifyContent\">\n                  <div className=\"SRC-center-text\">\n                    <p> Creating the File </p>\n                    <div style={spinnerStyle} className=\"spinner\" />\n                    <p> Loading... </p>\n                  </div>\n                </div>\n                }\n                <hr/>\n                <div style={{textAlign: 'right'}}>\n                  <button id=\"cancelBtn\" onClick={this.props.onClose} className=\"SRC-primary-text-color SRC-roundBorder SRC-underline-on-hover \" type=\"button\"> Cancel </button>\n                  <button id=\"submitBtn\" style={submitBtn} className=\"SRC-primary-background-color SRC-roundBorder SRC-whiteText\" type=\"submit\">{this.state.step === 0 ? 'Next': 'Download' }</button>\n                </div>\n              </Form>\n              </div>\n            </div>\n          </div>\n      </div>\n      <div className=\"modal-backdrop in\"/>\n      </React.Fragment>\n   )\n  }\n}","import * as React from 'react'\nimport { EntityHeader } from '../utils/jsonResponses/EntityHeader'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { \n  faLink,\n  faFolder,\n  faFile,\n  faListAlt,\n  faTable,\n  faThList,\n  faArchive \n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nlibrary.add(faLink)\nlibrary.add(faFolder)\nlibrary.add(faFile)\nlibrary.add(faListAlt)\nlibrary.add(faTable)\nlibrary.add(faThList)\nlibrary.add(faArchive)\n\ntype IconType = 'FileEntity' | 'Folder' | 'Link' | 'Project' | 'TableEntity' | 'EntityView'\n\nconst getIconTypeForEntity = (name: IconType) => {\n  switch(name) {\n    case 'Link':\n      return 'link'\n    case 'Folder':\n      return 'folder'\n    case 'FileEntity':\n      return 'file'\n    case 'TableEntity':\n      return 'table'\n    case 'Project':\n      return 'list-alt'\n    case 'EntityView':\n      return 'th-list'\n    default:\n      return ''\n  }\n}\n\ntype EntityTypeIconProps = {\n  type: string\n}\nconst EntityTypeIcon: React.SFC<EntityTypeIconProps> = ({ type }) => {\n  const splitType = type.split('.')\n  const name = splitType[splitType.length - 1] as IconType\n  const iconType = getIconTypeForEntity(name)\n  const iconStyle: React.CSSProperties = {\n    marginRight: 5\n  }\n  if (iconType === '') {\n    console.log('Entity Type not mapped = ', type)\n    return <React.Fragment />\n  }\n  return <FontAwesomeIcon style={iconStyle} icon={iconType}/>\n}\n\ntype EntityLinkProps = {\n  entityHeader: EntityHeader\n  className?: string\n}\n\nexport const EntityLink: React.SFC<EntityLinkProps> = ({ entityHeader, className }) => {\n  const { id, name, type } = entityHeader\n  return (\n    <a className={className} target=\"_blank\" rel=\"noopener noreferrer\" href={`https://www.synapse.org/#!Synapse:${id}`}>\n      <p className={className}>\n        <EntityTypeIcon type={type} />\n        {name}\n      </p>\n    </a>\n  )\n} \n","import * as React from 'react'\nimport { QueryResultBundle } from '../utils/jsonResponses/Table/QueryResultBundle'\n\nexport type TotalQueryResultsProps = {\n  data?: QueryResultBundle\n  facet?: string\n  isLoading: boolean\n  style?: React.CSSProperties\n  unitDescription: string\n  frontText: string\n}\n\ntype State = {\n  total: number  \n}\n\n// This is a stateful component so that during load the component can hold onto the previous \n// total instead of showing 0 results for the intermittent loading state.\nexport default class TotalQueryResults extends React.Component<TotalQueryResultsProps, State> {\n\n  constructor(props: TotalQueryResultsProps) {\n    super(props)\n    this.state = {\n      total: 0\n    }\n  }\n\n  componentDidMount() {\n    this.calculateTotal()\n  }\n\n  componentDidUpdate(prevProps: TotalQueryResultsProps) {\n    // check that its done loading\n    if (!this.props.isLoading && prevProps.isLoading) {\n      this.calculateTotal()\n    }\n  }\n\n  calculateTotal() {\n    const { data, facet } = this.props \n    let { total } = this.state\n    if (data) {\n      if (facet) {\n        const { facets = [] } = data\n        const curFacetsIndex = facets.findIndex(el => el.facetType === 'enumeration' && el.columnName === facet)\n        // calculate the values chosen\n        const curFacets = facets[curFacetsIndex]\n        // edge case -- if they are all false then they are considered all true..\n        // sum up the counts of data\n        let anyTrue = false\n        let totalAllFalseCase = 0\n        let totalStandardCase = 0\n    \n        if (curFacets) {\n          for (const key of curFacets.facetValues) {\n            anyTrue = anyTrue || key.isSelected\n            totalAllFalseCase += key.count\n            totalStandardCase += key.isSelected ? key.count : 0\n          }\n        }\n        total = anyTrue ? totalStandardCase : totalAllFalseCase\n        if (data.queryResult.queryResults.rows.length === 0) {\n          // we override the statements above if there are zero results because the current UI\n          // would be showing zero results\n          total = 0\n        }\n      } else {\n        if (data.queryCount === undefined) {\n          throw Error('Failed to specify either a facet or query count in part mask')\n        }\n        total = data.queryCount\n      }\n     }\n     this.setState({\n       total\n     })\n  }\n\n  render() {\n    const { isLoading, style, unitDescription, frontText } = this.props \n    const { total } =  this.state\n    const loader = <span style={{ marginLeft: '2px' }} className={'spinner'}/> \n    return (\n      <p style={style} className=\"SRC-boldText SRC-text-title SRC-centerContent\">\n        {frontText} {total} {unitDescription} {isLoading && loader}\n      </p>\n    )\n   }\n}\n","import { SynapseClient } from '../utils'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\n\n/*\n  Utility functions for UserCards\n*/\n\nfunction getUserProfileWithProfilePicAttached(principalIds: string [], token?: string) {\n  return SynapseClient.getUserProfiles(principalIds).then(\n    (data) => {\n      // people will either have a profile pic file handle id\n      // or they won't. Have to break this down into two groups.\n      const withProfilePic = data.list.filter(\n        (value: any) => {\n          return value.profilePicureFileHandleId !== undefined\n        }\n      )\n      if (withProfilePic.length === 0) {\n        return data\n      }\n      const fileHandleAssociationList = withProfilePic.map(\n        (value) => {\n          return {\n            associateObjectId: value.ownerId,\n            associateObjectType: 'UserProfileAttachment',\n            fileHandleId: value.profilePicureFileHandleId\n          }\n        })\n      const request: any = {\n        includeFileHandles: false,\n        includePreSignedURLs: true,\n        includePreviewPreSignedURLs: false,\n        requestedFiles: fileHandleAssociationList\n      }\n      return SynapseClient.getFiles(request, token)\n        .then(\n          (fileHandleList) => {\n            // we retrieve all the persons with profile pic file handles\n            // so we next loop through them, find the original person in the data.list\n            // and add a field with their pre-signed url\n            fileHandleList.requestedFiles.forEach(\n              (fileHandle) => {\n                const matchingPersonIndex = data.list.findIndex(\n                  (el) => {\n                    return fileHandle.fileHandleId === el.profilePicureFileHandleId\n                  }\n                )\n                data.list[matchingPersonIndex].clientPreSignedURL = fileHandle.preSignedURL\n              })\n            return Promise.resolve(data)\n          })\n        .catch((err) => {\n          return err\n        })\n    })\n}\n\ntype UserProfileAndImg = {\n  userProfile: UserProfile\n  preSignedURL: string\n}\nfunction getUserProfileWithProfilePic(ownerId: string, token?: string): Promise<UserProfileAndImg> {\n  return SynapseClient.getUserProfileById(token, ownerId).then(\n    (userProfile: UserProfile) => {\n      // people will either have a profile pic file handle id\n      // or they won't. Have to break this down into two groups.\n      if (!userProfile.profilePicureFileHandleId) {\n        return Promise.resolve({ userProfile }) as any\n      }\n\n      const fileHandleAssociationList = [{\n        associateObjectId: ownerId,\n        associateObjectType: 'UserProfileAttachment',\n        fileHandleId: userProfile.profilePicureFileHandleId\n      }]\n\n      const request: any = {\n        includeFileHandles: false,\n        includePreSignedURLs: true,\n        includePreviewPreSignedURLs: false,\n        requestedFiles: fileHandleAssociationList\n      }\n\n      return SynapseClient.getFiles(request, token)\n        .then(\n          (fileHandleList) => {\n            // we retrieve all the persons with profile pic file handles\n            // so we next loop through them, find the original person in the data.list\n            // and add a field with their pre-signed url\n            const firstElement = fileHandleList.requestedFiles[0]\n            return Promise.resolve({\n              userProfile,\n              preSignedURL: firstElement.preSignedURL\n            })\n          })\n        .catch((err) => {\n          console.log({ err })\n        })\n    })\n}\n\nconst COLORS: string[] = [\n  'chocolate',\n  'black',\n  'firebrick',\n  'maroon',\n  'olive',\n  'green',\n  'forestgreen',\n  'darkturquoise',\n  'teal',\n  'blue',\n  'navy',\n  'darkmagenta',\n  'purple',\n  'blue',\n  'orangered',\n  'blueviolet'\n]\n\nconst hash = (userName: string) => {\n  const val = userName\n  .split('')\n  .reduce((prevHash, currVal) => (((prevHash << 5) - prevHash) + currVal.charCodeAt(0)) | 0, 0)\n  return Math.abs(val)\n}\n\nconst getColor = (userName: string) => {\n  const hashedUserName = hash(userName)\n  return COLORS[hashedUserName % COLORS.length]\n}\n\nexport { getUserProfileWithProfilePicAttached, getColor, getUserProfileWithProfilePic }\nexport default { getUserProfileWithProfilePicAttached, getColor, getUserProfileWithProfilePic }\n","import * as React from 'react'\n// ignore because this is rollup requiring imports be named a certain way\n// tslint:disable-next-line\nimport ReactTooltip from \"react-tooltip\"\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faCircle,  } from '@fortawesome/free-solid-svg-icons'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport { getColor } from './getUserData'\n\nlibrary.add(faCircle)\n\nexport type UserCardSmallProps = {\n  userProfile: UserProfile\n  preSignedURL?: string\n  hideText?: boolean\n  hideTooltip?: boolean\n  link?: string\n}\n\nexport const UserCardSmall: React.FunctionComponent<UserCardSmallProps> = (\n  { userProfile, hideText = false, hideTooltip = false, preSignedURL, link }\n) => {\n  const linkLocation = link ? link : `https://www.synapse.org/#!Profile:${userProfile.ownerId}`\n  let img\n  let marginLeft\n  let label = ''\n  if (!hideTooltip) {\n    if (userProfile.displayName) {\n      label += userProfile.displayName\n    } else if (userProfile.firstName && userProfile.lastName) {\n      label += (`${userProfile.firstName} ${userProfile.lastName}`)\n    }\n    if (userProfile.userName) {\n      label += ` (${userProfile.userName})`\n    }\n    if (userProfile.position) {\n      label += ` <br/>${userProfile.position}`\n    }\n    if (userProfile.location) {\n      label += ` <br/>${userProfile.location}`\n    }\n  }\n\n  if (preSignedURL) {\n    marginLeft = '3px'\n    img = (\n      <div\n        className=\"SRC-userImgSmall\"\n        style={{ backgroundImage: `url(${preSignedURL})` }}\n        data-for={label}\n        data-tip={label}\n      />\n    )\n  } else {\n    const color = getColor(userProfile.userName)\n    marginLeft = '3px'\n    img = (\n      <div style={{ background: color }} className=\"SRC-userImgSmall SRC-centerContentInline\">\n        {(userProfile.firstName && userProfile.firstName[0]) || userProfile.userName[0]}\n      </div>\n    )\n  }\n  return (\n    <a\n      href={linkLocation}\n      className=\"SRC-userCard SRC-primary-text-color SRC-no-underline-on-hover\"\n    >\n      {img}\n        <ReactTooltip delayShow={1000} id={label} multiline={true}/>\n        {!hideText && <span className=\"SRC-primary-text-color SRC-underline-on-hover\" style={{ marginLeft, whiteSpace: 'nowrap' }}>{`@${userProfile.userName}`}</span>}\n    </a>\n  )\n}\n","import * as React from 'react'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport { SEPERATOR } from '../utils/SynapseConstants'\n\nexport type MenuAction = {\n  field: string\n  callback?: (userProfile: UserProfile) => void\n}\n\nexport type UserCardContextMenuProps = {\n  userProfile : UserProfile\n  menuActions: MenuAction []\n}\n\nconst UserCardContextMenu:React.SFC<UserCardContextMenuProps> = (props: UserCardContextMenuProps) => {\n  const { menuActions = [], userProfile } = props\n  return (\n    <div className=\"dropdown open\">\n      <ul className=\"dropdown-menu dropdown-menu-right\" aria-labelledby=\"dropdownMenu1\">\n        {\n          menuActions.map(\n            (menuAction, index) => {\n              const callback = () => menuAction.callback!(userProfile)\n              if (menuAction.field === SEPERATOR) {\n                return <hr className=\"SRC-break\" key={menuAction.field + index}/>\n              }\n              return (\n                <li\n                  key={menuAction.field}\n                  style={{ listStyle: 'none' }}\n                  className=\"SRC-menu-item SRC-table-dropdown-list SRC-primary-background-color-hover\"\n                  onClick={callback}\n                  onKeyPress={callback}\n                >\n                  <button className=\"SRC-menuAction\">\n                    {menuAction.field}\n                  </button>\n                </li>\n              )\n            }\n          )\n        }\n      </ul>\n    </div>\n  )\n}\n\nexport default UserCardContextMenu\n","import * as React from 'react'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faCircle, faEllipsisV, faCopy } from '@fortawesome/free-solid-svg-icons'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\n\nlibrary.add(faCircle)\nlibrary.add(faEllipsisV)\nlibrary.add(faCopy)\n\ntype UserCardLargeProps = {\n  userProfile: UserProfile\n}\n\n/**\n * UserCardLarge wraps around UserCardMedium\n *\n * @export UserCardLarge\n * @param {UserCardLargeProps} { userProfile }\n */\n// Disable function name because compiler has to know that its a class\n// tslint:disable-next-line:function-name\nexport function UserCardLarge({ userProfile }: UserCardLargeProps) {\n\n  const {\n    summary,\n    industry,\n    location,\n    url\n  } = userProfile\n\n  return (\n    <div className=\"SRC-cardMetaData\">\n      {\n        summary && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> Bio </p>\n            <p>\n              {summary}\n            </p>\n          </div>\n        )\n      }\n      {\n        url && (\n          <div>\n            <p className=\"SRC-card-metadata-title\"> More Info </p>\n            <p>\n              {url}\n            </p>\n          </div>\n        )\n      }\n      {\n        industry &&\n        <div>\n            <p className=\"SRC-card-metadata-title\"> Industry </p>\n            <p>\n              {industry}\n            </p>\n          </div>\n      }\n      {\n        location &&\n        <div>\n            <p className=\"SRC-card-metadata-title\"> Location </p>\n            <p>\n              {location}\n            </p>\n          </div>\n      }\n    </div>\n  )\n}\n","import * as React from 'react'\n\nconst svg = (\n  <svg width=\"12\" height=\"14\" viewBox=\"0 0 12 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <path\n      // tslint:disable-next-line:max-line-length\n      d=\"M10.7368 12.7273H3.78947V3.81818H10.7368V12.7273ZM10.7368 2.54545H3.78947C3.45446 2.54545 3.13317 2.67954 2.89629 2.91823C2.6594 3.15691 2.52632 3.48063 2.52632 3.81818V12.7273C2.52632 13.0648 2.6594 13.3885 2.89629 13.6272C3.13317 13.8659 3.45446 14 3.78947 14H10.7368C11.0719 14 11.3931 13.8659 11.63 13.6272C11.8669 13.3885 12 13.0648 12 12.7273V3.81818C12 3.48063 11.8669 3.15691 11.63 2.91823C11.3931 2.67954 11.0719 2.54545 10.7368 2.54545V2.54545ZM8.8421 0H1.26316C0.928148 0 0.606858 0.134091 0.36997 0.372773C0.133082 0.611456 0 0.935179 0 1.27273V10.1818H1.26316V1.27273H8.8421V0Z\"\n      fill=\"#DCDCDC\"\n    />\n  </svg>\n)\nexport default svg\n","import * as React from 'react'\nimport { CSSTransition, TransitionGroup } from 'react-transition-group'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { faCircle, faEllipsisV, faCopy } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { getColor } from './getUserData'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport UserCardContextMenu, { MenuAction } from './UserCardContextMenu'\nimport { UserCardLarge } from './UserCardLarge'\nimport IconCopy  from '../assets/icons/IconCopy'\n\nlibrary.add(faCircle)\nlibrary.add(faEllipsisV)\nlibrary.add(faCopy)\n\ntype UserCardState = {\n  showModal: boolean\n  isContextMenuOpen: boolean\n}\n\nexport type UserCardMediumProps = {\n  userProfile: UserProfile\n  menuActions?: MenuAction []\n  preSignedURL?: string\n  hideEmail?: boolean\n  isLarge?: boolean\n  link?: string\n  disableLink?: boolean\n}\n\nexport default class UserCardMedium extends React.Component<UserCardMediumProps, UserCardState> {\n\n  public htmlDivRef = React.createRef<HTMLDivElement>()\n\n  constructor(props: UserCardMediumProps) {\n    super(props)\n    this.state = {\n      showModal: false,\n      isContextMenuOpen: false\n    }\n  }\n\n  /**\n   * Function handles copying to clipboard the user's email address\n   *\n   * @param {string} value the email address of the user\n   * @returns\n   */\n  public copyToClipboard = (value: string) => (event: React.SyntheticEvent) => {\n    event.preventDefault()\n    // https://hackernoon.com/copying-text-to-clipboard-with-javascript-df4d4988697f\n    // this copies the email to the clipoard\n    const el = document.createElement('textarea')\n    el.value = value\n    el.setAttribute('readonly', '')\n    el.style.position = 'absolute'\n    el.style.left = '-9999px'\n    this.htmlDivRef.current!.appendChild(el)\n    el.select()\n    document.execCommand('copy')\n    this.htmlDivRef.current!.removeChild(el)\n    // show modal and hide after 4 seconds, the timing is per Material Design\n    this.setState({ showModal: true })\n    // hide after 4 seconds\n    setTimeout(\n      () => {\n        this.setState({ showModal: false })\n      },\n      4000\n    )\n  }\n\n  public toggleContextMenu = (_event: any) => {\n    this.setState({ isContextMenuOpen: !this.state.isContextMenuOpen })\n  }\n\n  public componentDidMount() {\n    // SWC-4778: https://stackoverflow.com/questions/23821768/how-to-listen-for-click-events-that-are-outside-of-a-component\n    window.addEventListener('mouseup', this.pageClick, false)\n  }\n\n  public componentWillUnmount() {\n    window.removeEventListener('mouseup', this.pageClick, false)\n  }\n\n  public pageClick = (_event: any) => {\n    if (!this.state.isContextMenuOpen) {\n      return\n    }\n    // hide content menu (deferred, to allow menu action to process)\n    setTimeout(\n      () => {\n        if (this.state.isContextMenuOpen) {\n          this.toggleContextMenu(_event)\n        }\n      },\n      10\n    )\n  }\n\n  render () {\n    const {\n      userProfile,\n      menuActions,\n      isLarge = false,\n      preSignedURL,\n      hideEmail = false,\n      disableLink = false,\n      link\n    } = this.props\n    const { isContextMenuOpen, showModal } = this.state\n    const {\n      displayName,\n      userName,\n      firstName,\n      lastName,\n      position,\n      company\n    } = userProfile\n    let img\n    let name = ''\n    const linkLocation = link ? link : `https://www.synapse.org/#!Profile:${userProfile.ownerId}`\n    // linkLocation is overriden by custom click handler\n    const email = `${userName}@synapse.org`\n    if (displayName) {\n      name = displayName\n    } else if (firstName && lastName) {\n      name = `${firstName} ${lastName}`\n    } else if (userName) {\n      name = userName\n    }\n    if (preSignedURL) {\n      img = (\n        <div\n          style={{ backgroundImage: `url(${preSignedURL})` }}\n          className=\"SRC-userImg\"\n        />\n      )\n    } else {\n      img = (\n        <div style={{ background: getColor(userName) }} className=\"SRC-userImg SRC-centerContentInline\">\n          {userProfile.firstName && (userProfile.firstName[0] || userProfile.userName[0])}\n        </div>\n      )\n    }\n    const mediumCard = (\n      <React.Fragment>\n        {\n          !hideEmail\n          &&\n          <TransitionGroup>\n          {\n            showModal\n            &&\n            <CSSTransition\n              key={email}\n              classNames=\"SRC-card\"\n              timeout={{ enter: 500, exit: 300 }}\n            >\n            <div key={email} className=\"SRC-modal\"> Email address copied to clipboard </div>\n            </CSSTransition>\n          }\n          </TransitionGroup>\n        }\n        {\n          disableLink\n          &&\n          img\n        }\n        {\n          !disableLink\n          &&\n          <a\n            href={linkLocation}\n            className={`SRC-no-underline-on-hover ${isLarge ? 'SRC-isLargeCard' : ''}`}\n          >\n            {img}\n          </a>\n        }\n        <div className=\"SRC-cardContent\">\n          <p className=\"SRC-eqHeightRow SRC-userCardName\">\n            {/*\n              if its a medium component the header should be clickable (unless disableLink is set),\n              if its large then it should NOT be clickable\n            */}\n            {/* make SRC-whiteText overridable with a good name! */}\n            {(isLarge || disableLink) ?\n              <span className={isLarge ? 'SRC-whiteText' :  'SRC-blackText'}> {name} </span>\n              :\n                // consolidate click events\n                <a\n                  href={linkLocation}\n                  tabIndex={0}\n                  className={'SRC-hand-cursor SRC-primary-text-color'}\n                >\n                  {name}\n                </a>}\n          </p>\n          {\n            (position || company) &&\n            <p className={`${isLarge ? 'SRC-whiteText' : ''}`}>\n              {position} {position ? ' / ' : ''} {company}\n            </p>\n          }\n          {\n            !hideEmail\n            &&\n            <p\n              className={`${isLarge ? 'SRC-whiteText' : 'SRC-primary-text-color SRC-primary-color-hover'}\n              SRC-hand-cursor SRC-eqHeightRow SRC-inlineFlex SRC-emailText SRC-cardSvg`}\n              onClick={this.copyToClipboard(email)}\n              onKeyPress={this.copyToClipboard(email)}\n              tabIndex={0}\n              ref={this.htmlDivRef}\n            >\n              <span style={{ paddingRight: '5px' }}>\n              {`${userName}@synapse.org`}\n              </span>\n              {IconCopy}\n            </p>\n          }\n        </div>\n        {/* conditionally render menu actions, if its not defined then we don't show the button */}\n        {\n          menuActions &&\n          <React.Fragment>\n            <span\n              className={`SRC-extraPadding SRC-hand-cursor SRC-primary-background-color-hover SRC-inlineBlock\n              SRC-cardMenuButton ${isContextMenuOpen ? 'SRC-primary-background-color' : ''}`}\n              style={{ outline: 'none' }}\n              tabIndex={0}\n              onClick={this.toggleContextMenu}\n              onKeyPress={this.toggleContextMenu}\n            >\n              <FontAwesomeIcon\n                className={isContextMenuOpen || isLarge ? 'SRC-whiteText' : 'SRC-primary-text-color'}\n                icon=\"ellipsis-v\"\n                fixedWidth={true}\n              />\n            </span>\n            {\n              isContextMenuOpen\n              &&\n              <UserCardContextMenu menuActions={menuActions} userProfile={userProfile}/>\n            }\n            </React.Fragment>\n        }\n        {\n          !menuActions &&\n          <span\n            style={{ padding: '0px 0px 0px 35px' }}\n          />\n        }\n      </React.Fragment>\n    )\n\n    if (!isLarge) {\n      return (\n        <div\n          style={{ border: '1px solid #DDDDDF' }}\n          className={`SRC-userCard SRC-userCardMediumUp ${isContextMenuOpen ? 'SRC-hand-cursor' : ''}`}\n          onClick={isContextMenuOpen ? this.toggleContextMenu : undefined}\n        >\n          {mediumCard}\n        </div>\n      )\n    }\n    // else return medium card inside large component\n    // when the component is large we have to set the click handler to wrap both the top and bottom portion\n    return (\n      <div\n        style={{ boxShadow: '0px 4px 4px rgba(0, 0, 0, 0.25)' }}\n        className={isContextMenuOpen ? 'SRC-hand-cursor' : ''}\n        onClick={isContextMenuOpen ? this.toggleContextMenu : undefined}\n      >\n        <div className={`SRC-primary-background-color SRC-userCard SRC-userCardMediumUp ${isContextMenuOpen ? 'SRC-hand-cursor' : ''}`}>\n          {mediumCard}\n        </div>\n        {isLarge ? <UserCardLarge userProfile={userProfile}/> : false}\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { getUserProfileWithProfilePic } from './getUserData'\nimport { getPrincipalAliasRequest } from '../utils/SynapseClient'\nimport { MenuAction } from './UserCardContextMenu'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport { SynapseConstants } from '../utils/'\nimport { UserCardSmall } from './UserCardSmall'\nimport UserCardMedium from './UserCardMedium'\n\ntype UserCardState = {\n  userProfile: UserProfile | undefined\n  preSignedURL: string\n  isLoading: boolean\n}\n\nexport type UserCardSize = 'SMALL USER CARD' |'MEDIUM USER CARD' |'LARGE USER CARD'\n\nexport type UserCardProps = {\n  // Note - either specify userProfile OR (alias or ownerId)\n  userProfile?: UserProfile\n  loadingScreen?: JSX.Element\n  hideEmail?: boolean\n  preSignedURL?: string\n  alias?: string\n  ownerId?: string\n  size: UserCardSize\n  hideText?: boolean\n  hideTooltip?: boolean\n  menuActions? : MenuAction[]\n  link?: string\n  disableLink?: boolean\n}\n\nexport default class UserCard extends React.Component<UserCardProps, UserCardState> {\n  constructor(props: any) {\n    super(props)\n    this.state = { userProfile: undefined, isLoading: true, preSignedURL: '' }\n    this.getUserProfile = this.getUserProfile.bind(this)\n  }\n\n  public componentDidMount() {\n    const { userProfile, ownerId, alias } = this.props\n    if (userProfile) {\n      return\n    }\n    if (alias) {\n      getPrincipalAliasRequest('', alias, 'USER_NAME')\n      .then(\n        (aliasData: any) => {\n          this.getUserProfile(aliasData.principalId!)\n        }\n      )\n    } else {\n      // check for ownerId!\n      this.getUserProfile(ownerId!)\n    }\n  }\n\n  public getUserProfile(ownerId: string) {\n    getUserProfileWithProfilePic(ownerId!, '')\n    .then(\n      (data) => {\n        const { userProfile, preSignedURL } = data\n        this.setState({ userProfile, preSignedURL, isLoading: false })\n      }\n    ).catch(\n      (err) => {\n        console.log('failed to get user bundle ', err)\n      }\n    )\n  }\n\n  public render() {\n    const { userProfile, loadingScreen = <span/>, preSignedURL, size, ...rest } = this.props\n    let userProfileAtRender\n    let preSignedURLAtRender\n    if (!userProfile) {\n      // userProfile wans't passed in from props\n      if (this.state.isLoading) {\n        // still making the API call\n        return loadingScreen\n      }\n      userProfileAtRender = this.state.userProfile\n      preSignedURLAtRender = this.state.preSignedURL\n    } else {\n      // otherwise we have the profile from props\n      userProfileAtRender = userProfile\n      preSignedURLAtRender = preSignedURL\n    }\n    const propsForChild = {\n      userProfile: userProfileAtRender!,\n      preSignedURL: preSignedURLAtRender,\n      ...rest\n    }\n    switch (size) {\n      case SynapseConstants.SMALL_USER_CARD:\n        return <UserCardSmall {...propsForChild}/>\n      case SynapseConstants.MEDIUM_USER_CARD:\n        return <UserCardMedium {...propsForChild}/>\n      case SynapseConstants.LARGE_USER_CARD:\n        return <UserCardMedium isLarge={true} {...propsForChild} />\n      default:\n        return <span/>\n    }\n  }\n}\n","import { IconProp, library } from '@fortawesome/fontawesome-svg-core'\nimport { \n  faCheck,\n  faColumns,\n  faFilter,\n  faSort,\n  faSortAmountDown,\n  faSortAmountUp,\n  faTimes,\n  faDownload,\n  faUsers,\n  faGlobeAmericas,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport ReactTooltip from \"react-tooltip\"\nimport { FacetColumnResult,\n  FacetColumnResultValueCount,\n  FacetColumnResultValues\n} from '../utils/jsonResponses/Table/FacetColumnResult'\nimport ColumnsSvg from '../assets/icons/columns.svg'\nimport ExpandSvg from '../assets/icons/expand.svg'\nimport ShrinkSvg from '../assets/icons/shrink.svg'\nimport { QueryBundleRequest } from '../utils/jsonResponses/Table/QueryBundleRequest'\nimport { Row } from '../utils/jsonResponses/Table/QueryResult'\nimport { SelectColumn, EntityColumnType } from '../utils/jsonResponses/Table/SelectColumn'\nimport { getColorPallette } from './ColorGradient'\nimport { QueryWrapperChildProps, FacetSelection } from './QueryWrapper'\nimport { cloneDeep } from '../utils/modules/'\nimport { SortItem } from '../utils/jsonResponses/Table/Query'\nimport { getIsValueSelected, readFacetValues } from '../utils/modules/facetUtils'\nimport { lexer } from 'sql-parser'\nimport { ColumnModel } from '../utils/jsonResponses/Table/ColumnModel'\nimport { formatSQLFromParser, isGroupByInSql } from '../utils/modules/sqlFunctions'\nimport ModalDownload from './ModalDownload'\nimport { SynapseClient } from '../utils'\nimport { ReferenceList } from '../utils/jsonResponses/ReferenceList'\nimport { EntityHeader } from '../utils/jsonResponses/EntityHeader'\nimport { EntityLink } from './EntityLink'\nimport TotalQueryResults from './TotalQueryResults'\nimport { QueryResultBundle } from '../utils/jsonResponses/Table/QueryResultBundle'\nimport UserCard from './UserCard'\nimport { AUTHENTICATED_USERS } from '../utils/SynapseConstants'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport { getUserProfileWithProfilePicAttached } from './getUserData'\nimport { UserGroupHeader } from '../utils/jsonResponses/UserGroupHeader'\nimport { Modal } from 'react-bootstrap'\n\nconst MIN_SPACE_FACET_MENU = 700\n\n// Add all icons to the library so you can use it in your page\nlibrary.add(faColumns)\nlibrary.add(faSort)\nlibrary.add(faSortAmountUp)\nlibrary.add(faSortAmountDown)\nlibrary.add(faCheck)\nlibrary.add(faTimes)\nlibrary.add(faFilter)\nlibrary.add(faDownload)\nlibrary.add(faUsers)\nlibrary.add(faGlobeAmericas)\n// Hold constants for next and previous button actions\nconst NEXT = 'NEXT'\nconst PREVIOUS = 'PREVIOUS'\nexport const SELECT_ALL = 'SELECT_ALL'\nexport const DESELECT_ALL = 'DESELECT_ALL'\nexport const DOWNLOAD_FILES_MENU_TEXT = 'Download Files'\n// double check these icons!\nexport const ICON_STATE: string [] = ['sort-amount-down', 'sort-amount-down', 'sort-amount-up']\ntype Direction = ''|'ASC'|'DESC'\nexport const SORT_STATE: Direction [] = ['', 'DESC', 'ASC']\nexport const DOWNLOAD_OPTIONS_CONTAINER_CLASS = 'SRC-download-options-container' \nexport const EXPAND_CLASS = 'SRC-expand-class'\ntype Info = {\n  index: number\n  name: string\n}\ninterface Dictionary<T> {\n  [key: string]: T;\n}\nexport type SynapseTableState = {\n  sortedColumnSelection: SortItem []\n  isDropdownColumnMenuOpen: boolean\n  isColumnSelected: boolean[]\n  columnIconSortState: number[],\n  activeFilterIndex: number\n  activeFilterClass: string,\n  isMenuWallOpen: boolean,\n  isModalDownloadOpen: boolean\n  isExpanded: boolean\n  mapEntityIdToHeader: Dictionary<EntityHeader>\n  mapUserIdToHeader: Dictionary<Partial<UserGroupHeader & UserProfile>>\n  isDropdownDownloadOptionsOpen: boolean\n}\nexport type SynapseTableProps = {\n  visibleColumnCount?: number\n  synapseId: string\n  title: string\n  loadingScreen?: JSX.Element\n}\n\nconst TOOLTIP_DELAY_SHOW = 500\n\n// This is a convenient way to categorize all the dropdown state variables, although problematic\n// if any state variable mapping to a boolean does NOT represent a dropdown\ntype BooleanKeys<T> = { [k in keyof T]: T[k] extends boolean ? k : never }[keyof T];\n\nexport default class SynapseTable extends React.Component<QueryWrapperChildProps &\n                                                          SynapseTableProps, SynapseTableState> {\n\n  constructor(props: QueryWrapperChildProps & SynapseTableProps) {\n    super(props)\n    this.handleColumnSortPress = this.handleColumnSortPress.bind(this)\n    this.handlePaginationClick = this.handlePaginationClick.bind(this)\n    this.findSelectionIndex = this.findSelectionIndex.bind(this)\n    this.toggleColumnSelection = this.toggleColumnSelection.bind(this)\n    this.advancedSearch = this.advancedSearch.bind(this)\n    this.getLengthOfPropsData = this.getLengthOfPropsData.bind(this)\n    this.configureFacetDropdown = this.configureFacetDropdown.bind(this)\n    this.closeAllDropdowns = this.closeAllDropdowns.bind(this)\n    this.applyChanges = this.applyChanges.bind(this)\n    this.toggleFilterDropdown = this.toggleFilterDropdown.bind(this)\n    // store the offset and sorted selection that is currently held\n    this.state = {\n      /* columnIconSortState tells what icon to display for a table\n         header. There are three states for a particular header-\n          0 - show descending icon but *deselected*\n          1 - show descending icon selected\n          2 - show ascending icon selected\n      */\n      columnIconSortState: [],\n      activeFilterClass: '',\n      isColumnSelected: [],\n      activeFilterIndex: -1,\n      isDropdownColumnMenuOpen: false,\n      isMenuWallOpen: false,\n      isModalDownloadOpen: false,\n      isDropdownDownloadOptionsOpen: false,\n      isExpanded: false,\n      // sortedColumnSelection contains the columns which are\n      // selected currently and their sort status as eithet\n      // off, desc, or asc.\n      sortedColumnSelection: [],\n      mapEntityIdToHeader: {},\n      mapUserIdToHeader: {}\n    }\n    this.renderFacetSelection = this.renderFacetSelection.bind(this)\n    this.getEntityHeadersInData = this.getEntityHeadersInData.bind(this)\n    this.getColumnIndiciesWithType = this.getColumnIndiciesWithType.bind(this)\n  }\n\n  componentDidMount() {\n    this.getEntityHeadersInData()\n  }\n\n  componentDidUpdate() {\n    this.getEntityHeadersInData()\n  }\n\n  public async getEntityHeadersInData() {\n    const { data, token } = this.props\n    if (!data) {\n      return\n    }\n    const mapEntityIdToHeader = cloneDeep(this.state.mapEntityIdToHeader)\n    const mapUserIdToHeader = cloneDeep(this.state.mapUserIdToHeader)\n    const entityIdColumnIndicies = this.getColumnIndiciesWithType('ENTITYID')\n    const userIdColumnIndicies = this.getColumnIndiciesWithType('USERID')\n    const distinctEntityIds = this.getUniqueEntities(data, mapEntityIdToHeader, entityIdColumnIndicies)\n    const distinctUserIds = this.getUniqueEntities(data, mapUserIdToHeader, userIdColumnIndicies)\n    // Make call to resolve entity ids\n    if (distinctEntityIds.size > 0) {\n      const referenceList: ReferenceList = Array.from(distinctEntityIds).map(id => { return { targetId: id }})\n      try {\n        const data = await SynapseClient.getEntityHeader(referenceList, token)\n        const { results } = data\n        results.forEach(\n          el => {\n            mapEntityIdToHeader[el.id] = el\n          }\n        )\n      } catch (err) {\n        console.error('Error on retrieving entity header list , ', err)\n      }\n    }\n    if (distinctUserIds.size === 0) {\n      if (distinctEntityIds.size > 0) {\n       this.setState({mapEntityIdToHeader}) \n      }\n      return\n    }\n    // Make call to get group headers and user profiles\n    const ids = Array.from(distinctUserIds)\n    const idsWithUserProfiles: string [] = []\n    // TODO: Grab Team Badge\n    try {\n      const data = await SynapseClient.getGroupHeadersBatch(ids, token)\n      data.children.forEach(\n        (el) => {\n          if (el.isIndividual) {\n            idsWithUserProfiles.push(el.ownerId)\n          } else {\n            mapUserIdToHeader[el.ownerId] = el\n          }\n        }\n      )\n    } catch (err) {\n      console.error('Error on getGroupHeaders batch: ', err)\n    }\n    if (idsWithUserProfiles.length > 0) {\n      try {\n        const data = await getUserProfileWithProfilePicAttached(idsWithUserProfiles, token)\n        data.list.forEach(\n          (el: UserProfile) => {\n            mapUserIdToHeader[el.ownerId] = el\n          }\n        )\n      } catch (err) {\n        console.error('Error on getUserProfile : ', err)\n      }\n    }\n    if (distinctEntityIds.size > 0 || distinctUserIds.size > 0) {\n      this.setState({\n        mapEntityIdToHeader,\n        mapUserIdToHeader\n      })\n    }\n  }\n\n  public getUniqueEntities(data: QueryResultBundle, mapIdToHeader: {}, indicies: number []) {\n    const distinctEntities = new Set<string>()\n    data!.queryResult.queryResults.rows.forEach((row) => {\n      row.values.forEach((el: any, colIndex: number) => {\n        // make sure this is a column of type entity and that we haven't retrieved this entity's information prior\n        if (indicies.includes(colIndex) && !Object.prototype.hasOwnProperty.call(mapIdToHeader,el) && el) {\n          distinctEntities.add(el)\n        }\n      })\n    })\n    return distinctEntities\n  }\n\n  public getColumnIndiciesWithType(columnType: EntityColumnType) {\n    const { data } = this.props\n    const columnsOfTypeEntity: number [] = []\n    data && data.selectColumns && data.selectColumns.forEach((el, index) => {\n      if (el.columnType === columnType) {\n        columnsOfTypeEntity.push(index)\n      } \n    })\n    return columnsOfTypeEntity\n  }\n\n  public toggleStateVariables = (...values: BooleanKeys<SynapseTableState> []) => (_event: React.SyntheticEvent) => {\n    const updatedState = {} \n    values.forEach(\n      el => updatedState[el] = !this.state[el]\n    )\n    this.setState(updatedState)\n  }\n\n  /**\n   * Display the view\n   */\n  public render() {\n    if (this.props.data === undefined) {\n      return this.props.loadingScreen || <div/>\n    }\n    // unpack all the data\n    const { data, isLoading = true, unitDescription, token, synapseId, facet, showBarChart } = this.props\n    const { queryResult } = data\n    const { queryResults } = queryResult\n    const { rows } = queryResults\n    const { headers } = queryResults\n    const { facets = [] } = data\n    const { isMenuWallOpen, isModalDownloadOpen, isExpanded } = this.state\n    const queryRequest = this.props.getLastQueryRequest!()\n    const {\n      sql,\n      selectedFacets\n    } = queryRequest.query\n    const style: React.CSSProperties = {}\n    if (showBarChart) {\n      style.marginTop = 15\n      style.marginBottom = 15\n    } else {\n      style.marginTop = -10\n    }\n    const content = (\n        <>\n         <div className=\"SRC-centerContent\" style={{ height:'20px', textAlign: 'left', ...style}}>\n          {\n            unitDescription && !isGroupByInSql(queryRequest.query.sql)\n            &&\n            <TotalQueryResults \n              facet={facet}\n              data={data}\n              isLoading={isLoading}\n              style={{fontSize: 15}}\n              unitDescription={unitDescription}\n              frontText={'Showing'}\n            />\n          }\n        </div>\n        {this.renderTableTop(headers)}\n        {this.renderTable(headers, facets, rows)}\n        {/* its intentional that the menu-wall is placed here because of the way that z-index works*/}\n        {isMenuWallOpen && <button onClick={this.closeAllDropdowns} className='SRC-menu-wall' />}\n      </>\n    )\n    return (\n      <React.Fragment>\n        {\n          // modal can render anywhere, this is not a particular location\n          isModalDownloadOpen\n          &&\n          <ModalDownload\n            onClose={this.toggleStateVariables('isModalDownloadOpen', 'isDropdownDownloadOptionsOpen', 'isMenuWallOpen')}\n            sql={sql}\n            selectedFacets={selectedFacets}\n            token={token}\n            entityId={synapseId}\n          />\n        }\n        {\n          isExpanded\n          &&\n          <Modal         \n            animation={false}\n            centered={true}\n            show={true}\n            // @ts-ignore\n            onHide={this.toggleStateVariables('isExpanded')}\n            dialogClassName={'modal-90w'}\n          >\n            <Modal.Header \n              // @ts-ignore\n              onHide={this.toggleStateVariables('isExpanded')} \n              closeButton={true}\n            >\n            </Modal.Header>\n            <Modal.Body>\n              {content}\n            </Modal.Body>\n          </Modal>\n        }\n        {\n          !isExpanded\n          &&\n          content\n        }\n    </React.Fragment>\n    )\n  }\n\n  private showGroupRowData = (selectedRow: Row) => (_event: React.MouseEvent<HTMLAnchorElement>) => {\n    // magic happens - parse query, deep copy query bundle request, modify, encode, send to Synapse.org.  Easy!\n    const queryCopy = cloneDeep(this.props.getLastQueryRequest!().query)\n    // unpack all the data\n    const { data } = this.props\n    const { queryResult, columnModels } = data!\n    if (!columnModels) {\n      throw Error('Error on query request, must include columnModels in partmask to show aggregate sql')\n    }\n    const { queryResults } = queryResult\n    const { headers } = queryResults\n    const parsed = this.getSqlUnderlyingDataForRow(\n      selectedRow,\n      queryCopy.sql,\n      headers,\n      columnModels)\n    queryCopy.sql = parsed.newSql\n    const queryJSON = JSON.stringify(queryCopy)\n    // encode this copy of the query (json)\n    const encodedQuery = btoa(queryJSON)\n    // open this in a new window on synapse.org\n    window.open(`https://www.synapse.org/#!Synapse:${parsed.synId}/tables/query/${encodedQuery}`, '_self')\n  }\n\n  private renderDropdownDownloadOptions = () => {\n    const { isDropdownDownloadOptionsOpen, isExpanded } = this.state\n    const tooltipAdvancedSearchId = 'openAdvancedSearch'\n    const tooltipDownloadId = 'download'\n    const toggleStateArgs: BooleanKeys<SynapseTableState> [] = ['isModalDownloadOpen']\n    // we don't want two modals to show at once, so we close out the expanded view if its already showing\n    if (isExpanded) {\n      toggleStateArgs.push('isExpanded')\n    }\n    return (\n      <span className={`dropdown ${DOWNLOAD_OPTIONS_CONTAINER_CLASS} ${isDropdownDownloadOptionsOpen ? 'open' : ''}`}>\n        <button \n          style={{ marginLeft: '10px' }}\n          data-for={tooltipDownloadId} \n          data-tip=\"Download Options\"\n          className=\"SRC-primary-background-color-hover SRC-extraPadding SRC-hand-cursor\" \n          onClick={this.toggleStateVariables('isDropdownDownloadOptionsOpen', 'isMenuWallOpen')}\n        >\n          <FontAwesomeIcon size=\"1x\" color=\"white\" icon=\"download\" />\n        </button>\n        <ReactTooltip \n          delayShow={TOOLTIP_DELAY_SHOW}\n          place=\"top\"\n          type=\"dark\"\n          effect=\"solid\"\n          id={tooltipAdvancedSearchId} \n        />\n        <ul className=\"SRC-table-dropdown-zindex dropdown-menu dropdown-menu-right\" aria-labelledby=\"dropdownMenu1\">\n          <li\n            style={{ listStyle: 'none' }}\n            className=\"SRC-table-dropdown-list SRC-primary-background-color-hover\"\n            onClick={this.toggleStateVariables(...toggleStateArgs)}\n          >\n            <a href=\"javascript:void\">\n              Export Metadata\n            </a>\n          </li>\n          <li\n            style={{ listStyle: 'none' }}\n            className=\"SRC-table-dropdown-list SRC-primary-background-color-hover\"\n            onClick={this.advancedSearch}\n          >\n            <a href=\"javascript:void\">\n              { DOWNLOAD_FILES_MENU_TEXT }\n            </a>\n          </li>\n        </ul>\n      </span>\n    )\n  }\n\n  private renderDropdownColumnMenu = (headers: SelectColumn[]) => {\n    const { isDropdownColumnMenuOpen } = this.state\n    const tooltipColumnSelectionId = 'addAndRemoveColumns'\n    let addRemoveColClasses  = 'SRC-inlineFlex SRC-primary-background-color-hover  dropdown-toggle SRC-hand-cursor'\n    addRemoveColClasses += (isDropdownColumnMenuOpen ? 'SRC-primary-background-color' : '')\n    return (\n      <span style={{marginLeft: 10, height: 30, width: 34, padding: 1}} className={`dropdown ${isDropdownColumnMenuOpen ? 'open' : ''}`}>  \n        <span \n          tabIndex={0} \n          data-for={tooltipColumnSelectionId} \n          data-tip=\"Add / Remove Columns\" \n          className={addRemoveColClasses} \n          onKeyPress={this.toggleStateVariables('isDropdownColumnMenuOpen', 'isMenuWallOpen')} \n          onClick={this.toggleStateVariables('isDropdownColumnMenuOpen', 'isMenuWallOpen')} \n          id=\"dropdownMenu1\"\n        >\n          <img alt=\"columns selection\" src={ColumnsSvg}/>\n        </span>\n        <ReactTooltip \n          delayShow={TOOLTIP_DELAY_SHOW} \n          place=\"top\" \n          type=\"dark\" \n          effect=\"solid\" \n          id={tooltipColumnSelectionId} \n        />\n        <ul className=\"SRC-table-dropdown-zindex dropdown-menu dropdown-menu-right SRC-column-menu\" aria-labelledby=\"dropdownMenu1\">\n          {this.renderDropdownColumnMenuItems(headers)}\n        </ul>\n      </span>\n    )\n  }\n\n  private renderTable = (headers: SelectColumn[], facets: FacetColumnResult[], rows: Row[]) => {\n    // handle displaying the previous button -- if offset is zero then it\n    // shouldn't be displayed\n    const pastZero: boolean = this.props.getLastQueryRequest!().query.offset! > 0\n    const previous = (\n      <button\n        onClick={this.handlePaginationClick(PREVIOUS)}\n        className=\"SRC-light-button SRC-standard-button-shape pull-right\"\n        type=\"button\"\n      >\n        Previous\n      </button>\n    )\n\n    const hasMoreData = this.props.hasMoreData\n    const next = (\n      (\n        <button\n          onClick={this.handlePaginationClick(NEXT)}\n          className=\"SRC-light-button SRC-standard-button-shape pull-right\"\n          type=\"button\"\n        >\n          Next\n        </button>\n      )\n    )\n\n    /* min height ensure if no rows are selected that a dropdown menu is still accessible */\n    return (\n      <div style={{ minHeight: '300px' }} className=\"SRC-overflowAuto\">\n        <table className=\"table table-striped table-condensed\">\n          <thead className=\"SRC_borderTop\">\n            <tr>\n              {this.createTableHeader(headers, facets)}\n            </tr>\n          </thead>\n          <tbody>{this.createTableRows(rows, headers)}</tbody>\n        </table>\n        {hasMoreData && next}\n        {pastZero && previous}\n      </div>\n    )\n  }\n\n  private renderTableTop = (headers: SelectColumn[] ) => {\n    const {\n      title,\n    } = this.props\n    const { isExpanded } = this.state\n    const tooltipExpandId = 'expand'\n    const tooltipAdvancedSearchId = 'openAdvancedSearch'\n    const tooltipDownloadId = 'download'\n    const { colorPalette } = getColorPallette(this.props.rgbIndex!, 1)\n    const backgroundColor = colorPalette[0]\n    return (\n      <div \n        className=\"SRC-centerContent\" \n        style={{ background: backgroundColor, padding: 8 }}\n      >\n        <h3 className=\"SRC-tableHeader\"> {title}</h3>\n        <span \n          className=\"SRC-inlineFlex\"\n          style={{ marginLeft: 'auto' }}\n          >\n            {!isGroupByInSql(this.props.getLastQueryRequest!().query.sql)\n                &&\n                <>\n                  <span \n                    tabIndex={0}\n                    data-for={tooltipAdvancedSearchId}\n                    data-tip=\"Open Advanced Search in Synapse\" \n                    className=\"SRC-primary-background-color-hover SRC-extraPadding SRC-hand-cursor\"\n                    onKeyPress={this.advancedSearch}\n                    onClick={this.advancedSearch}\n                  >\n                    <FontAwesomeIcon \n                      size=\"1x\"\n                      color=\"white\"\n                      icon={'filter'}\n                    />\n                  </span>\n                <ReactTooltip \n                  delayShow={TOOLTIP_DELAY_SHOW} \n                  place=\"top\"\n                  type=\"dark\"\n                  effect=\"solid\"\n                  id={tooltipDownloadId} \n                />\n                {this.renderDropdownDownloadOptions()}\n                {this.renderDropdownColumnMenu(headers)}\n              </>\n            }\n            <span\n              tabIndex={0}\n              data-for={tooltipExpandId} \n              data-tip=\"Expand table in full screen\"\n              className={`SRC-primary-background-color-hover SRC-inlineFlex SRC-extraPadding SRC-hand-cursor ${EXPAND_CLASS}`}\n              onKeyPress={this.toggleStateVariables('isExpanded')} \n              onClick={this.toggleStateVariables('isExpanded')}\n            >\n              {isExpanded ? <img src={ShrinkSvg} alt=\"shrink table\" /> : <img src={ExpandSvg} alt=\"expand table\" />}\n            </span>\n            <ReactTooltip\n              delayShow={TOOLTIP_DELAY_SHOW}\n              place=\"top\"\n              type=\"dark\"\n              effect=\"solid\"\n              id={tooltipExpandId} \n            />\n          </span>\n      </div>\n    )\n  }\n\n  /**\n   * Return the select column indexes for columns that use the aggregate count function.\n   * If sql does not have a GROUP BY, this returns an empty array.\n   * @param originalSql\n   */\n  public getCountFunctionColumnIndexes(originalSql: string): number[] {\n    const indexes: number[] = []\n    if (isGroupByInSql(originalSql)) {\n      const tokens: string[][] = lexer.tokenize(originalSql)\n      const selectIndex = tokens.findIndex(el => el[0] === 'SELECT')\n      const fromIndex = tokens.findIndex(el => el[0] === 'FROM')\n      let columnIndex = 0\n      for (let index = selectIndex + 1; index < fromIndex - selectIndex - 1; index += 1) {\n        const token = tokens[index]\n        if (token[0] === 'FUNCTION' && token[1].toLowerCase() === 'count') {\n          // found a count column!\n          indexes.push(columnIndex)\n        } else if (token[0] === 'SEPARATOR') {\n          // next column\n          columnIndex += 1\n        }\n      }\n    }\n    return indexes\n  }\n\n  public getSqlUnderlyingDataForRow(\n    selectedRow: Row,\n    originalSql: string,\n    headers: SelectColumn[],\n    columnModels: ColumnModel[]\n  ): { synId: string, newSql: string } {\n    let tokens: string[][] = lexer.tokenize(originalSql)\n    // remove all tokens after (and including) group\n    tokens = tokens.slice(0, tokens.findIndex(el => el[0] === 'GROUP'))\n    // replace all columns with *\n    const selectIndex = tokens.findIndex(el => el[0] === 'SELECT')\n    const fromIndex = tokens.findIndex(el => el[0] === 'FROM')\n    tokens.splice(selectIndex + 1, fromIndex - selectIndex - 1, ['STAR', '*', '1'])\n    // add new items to where clause, but only if the column name corresponds to a real column in the table/view!\n    // use row.values\n    if (this.props.data === undefined) {\n      return { synId: '', newSql: '' }\n    }\n    const whereIndex = tokens.findIndex(el => el[0] === 'WHERE')\n    if (whereIndex === -1) {\n      // does not contain a where clause\n      tokens.push(\n        ['WHERE', 'WHERE', '1'],\n      )\n    } else {\n      // alreay contains a where clause, add the first AND\n      tokens.push(\n        ['CONDITIONAL', 'AND', '1'],\n      )\n    }\n    // look for headers in column models, if they match then add a where clause\n    headers.forEach((header: any, index: number) => {\n      const matchingColumnModel = columnModels!.find(columnModel => columnModel.name === header.name)\n      if (matchingColumnModel) {\n        const rowValue = selectedRow.values[index]\n        // PORTALS-712: support null values\n        if (rowValue) {\n          tokens.push(\n            ['LITERAL', matchingColumnModel.name, '1'],\n            ['OPERATOR', '=', '1'],\n            ['STRING', rowValue, '1'],\n            ['CONDITIONAL', 'AND', '1'],\n          )\n        } else {\n          tokens.push(\n            ['LITERAL', matchingColumnModel.name, '1'],\n            ['OPERATOR', 'IS', '1'],\n            ['BOOLEAN', 'null', '1'],\n            ['CONDITIONAL', 'AND', '1'],\n          )\n        }\n      }\n    })\n    // remove the last AND\n    tokens.pop()\n    // remove backtick from output sql (for table name): `syn1234` becomes syn1234\n    const synId = tokens[tokens.findIndex(el => el[0] === 'FROM') + 1][1]\n    tokens.push(['EOF', '', '1'])\n    return { synId, newSql: formatSQLFromParser(tokens) }\n  }\n\n  /**\n   * Handle a click on next or previous\n   *\n   * @memberof SynapseTable\n   */\n  private handlePaginationClick = (eventType: string) => (_event: React.MouseEvent<HTMLButtonElement>) => {\n    const queryRequest = this.props.getLastQueryRequest!()\n    let currentOffset = queryRequest.query.offset!\n        // if its a \"previous\" click subtract from the offset\n        // otherwise its next and we paginate forward\n    if (eventType === PREVIOUS) {\n      currentOffset -= 25\n    }\n    if (eventType === NEXT) {\n      currentOffset += 25\n    }\n    queryRequest.query.offset = currentOffset\n    this.props.executeQueryRequest!(queryRequest)\n  }\n  /**\n   * Handle a column having been selected\n   *\n   * @memberof SynapseTable\n   */\n  public handleColumnSortPress = (dict: Info) => (_: React.SyntheticEvent) => {\n    // by using Synthetic event we can use the handler on both key press and mouse click\n    let columnIconSortState = cloneDeep(this.state.columnIconSortState)\n    if (columnIconSortState.length === 0) {\n      columnIconSortState = Array(this.getLengthOfPropsData()).fill(0)\n    }\n    // get currently sorted items and remove/insert/update this selection\n    const sortedColumnSelection = cloneDeep(this.state.sortedColumnSelection)\n    const index = this.findSelectionIndex(sortedColumnSelection, dict.name)\n    // if its present then remove it\n    if (index !== -1) {\n      sortedColumnSelection.splice(index, 1)\n    }\n    columnIconSortState[dict.index] = (columnIconSortState[dict.index] + 1) % ICON_STATE.length\n    if (columnIconSortState[dict.index] > 0) {\n      sortedColumnSelection.unshift({\n        column: dict.name,\n        direction: SORT_STATE[columnIconSortState[dict.index]]\n      })\n    }\n    const queryRequest = this.props.getLastQueryRequest!()\n    queryRequest.query.sort = sortedColumnSelection\n    this.props.executeQueryRequest!(queryRequest)\n    this.setState({\n      columnIconSortState,\n      sortedColumnSelection\n    })\n  }\n\n  /**\n   * Renders the dropdown menu to the top right of table that allows users\n   * to toggle a columnn from the view of the table\n   *\n   * @private\n   * @param {SelectColumn[]} headers\n   * @returns {React.ReactNode}\n   * @memberof SynapseTable\n   */\n  private renderDropdownColumnMenuItems = (headers: SelectColumn[]) => {\n    return headers.map((header: any, index: number) => {\n      let isColumnSelected: boolean | undefined = this.state.isColumnSelected[index]\n      // if visibleColumnCount is not defined then show all columns\n      const { visibleColumnCount = Infinity } = this.props\n      if (isColumnSelected === undefined) {\n        isColumnSelected = (index < visibleColumnCount)\n      }\n      const iconStyle: any = { width: '11px', marginRight: '10px' }\n      if (!isColumnSelected) {\n        iconStyle.visibility = 'hidden'\n      }\n      const maybeShowPrimaryColor = isColumnSelected ? 'SRC-primary-text-color' : ''\n\n      return (\n        <li\n          style={{ listStyle: 'none' }}\n          className=\"SRC-table-dropdown-list SRC-primary-background-color-hover \"\n          key={header.name}\n          onClick={this.toggleColumnSelection(index)}\n        >\n          <a href=\"javascript:void\">\n            <FontAwesomeIcon\n              style={iconStyle}\n              className={maybeShowPrimaryColor}\n              icon=\"check\"\n            />\n            {header.name}\n          </a>\n        </li>\n      )\n    })\n  }\n  private createTableRows(rows: Row [], headers: SelectColumn[]) {\n    const rowsFormatted: JSX.Element[] = []\n    const { isColumnSelected, mapEntityIdToHeader, mapUserIdToHeader } = this.state\n    const entityColumnIndicies = this.getColumnIndiciesWithType('ENTITYID')\n    const userColumnIndicies = this.getColumnIndiciesWithType('USERID')\n    const isColumnSelectedLen = isColumnSelected.length\n    // find column indices that are COUNT type\n    const countColumnIndexes = this.getCountFunctionColumnIndexes(this.props.getLastQueryRequest!().query.sql)\n    const {\n      visibleColumnCount = Infinity\n    } = this.props\n    rows.forEach((row: any, rowIndex) => {\n      const rowContent = row.values.map(\n        (columnValue: string, colIndex: number) => {\n          const columnName = headers[colIndex].name\n          const index = this.findSelectionIndex(this.state.sortedColumnSelection, columnName)\n          const usedVisibleColumnCount = isGroupByInSql(this.props.getLastQueryRequest!().query.sql) ?  Infinity: visibleColumnCount\n          // on iniital load isColumnSelected is null and we by default show all columns that come\n          // before visibileColumnCount\n          const isColumnActiveInitLoad: boolean = colIndex < usedVisibleColumnCount && isColumnSelectedLen === 0\n          // past the initial load -- when a user has started clicking items, then isColumnSelected is\n          // not null and we verify that this column is part of the selection.\n          const isColumnActivePastInitLoad = isColumnSelectedLen !== 0 && this.state.isColumnSelected[colIndex]\n          const isCountColumn = countColumnIndexes.includes(colIndex)\n          const isBold = index === -1 ? '' : 'SRC-boldText'\n          if (isColumnActiveInitLoad || isColumnActivePastInitLoad) {\n            return (\n              <td className=\"SRC_noBorderTop\" key={`(${rowIndex}${columnValue}${colIndex})`}>\n                  {\n                    isCountColumn &&\n                    <a href=\"javascript:void\" onClick={this.showGroupRowData(row)}>\n                      <p className={isBold}>{columnValue}</p>\n                    </a>\n                  }\n                  {\n                    !isCountColumn &&\n                    this.renderTableCell({ entityColumnIndicies, userColumnIndicies, colIndex, columnValue, isBold, mapEntityIdToHeader, mapUserIdToHeader })\n                  }\n              </td>\n            )\n          }\n          return (<td className=\"SRC-hidden\" key={`(${rowIndex},${colIndex})`}/>)\n        })\n      const rowFormatted = (\n        <tr key={row.rowId}>{rowContent}</tr>\n      )\n      rowsFormatted.push(rowFormatted)\n    })\n    return rowsFormatted\n  }\n\n  // Render table cell, supports Entity's and User Icons\n  public renderTableCell(\n    { \n      entityColumnIndicies,\n      userColumnIndicies,\n      colIndex,\n      columnValue,\n      isBold,\n      mapEntityIdToHeader,\n      mapUserIdToHeader\n    }:{ \n      entityColumnIndicies: number[]; \n      userColumnIndicies: number[];\n      colIndex: number;\n      columnValue: string;\n      isBold: string; \n      mapEntityIdToHeader: Dictionary<EntityHeader>,\n      mapUserIdToHeader: Dictionary<any>\n    }): React.ReactNode {\n    if (entityColumnIndicies.includes(colIndex) &&  Object.prototype.hasOwnProperty.call(mapEntityIdToHeader, columnValue)) {\n      return <EntityLink entityHeader={mapEntityIdToHeader[columnValue]} className={isBold} />\n    } else if (userColumnIndicies.includes(colIndex) && Object.prototype.hasOwnProperty.call(mapUserIdToHeader, columnValue)) {\n      const { ownerId, userName } = mapUserIdToHeader[columnValue]\n      if (mapUserIdToHeader[columnValue].isIndividual === false) {\n        // isUserGroupHeader\n        const icon = userName === AUTHENTICATED_USERS ? 'globe-americas': 'users'\n        if (userName === AUTHENTICATED_USERS) {\n          return <span ><FontAwesomeIcon icon={icon}/> All registered Synapse users </span>\n        }\n        return (<a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://www.synapse.org/#!Team:${ownerId}`}> <FontAwesomeIcon icon={icon}/> {userName} </a>)\n      } else {\n        // isUserCard\n        return  (\n          <UserCard \n            userProfile={mapUserIdToHeader[columnValue]} \n            preSignedURL={mapUserIdToHeader[columnValue].clientPreSignedURL}\n            size={'SMALL USER CARD'}\n          />\n        )\n      }\n    } else {\n      return (<p className={isBold}> {columnValue} </p>)\n    }\n  }\n\n  private createTableHeader(headers: SelectColumn[], facets: FacetColumnResult[]) {\n    const { isColumnSelected, sortedColumnSelection, columnIconSortState } = this.state\n    const { visibleColumnCount = Infinity, facetAliases = {} } = this.props\n    const usedVisibleColumnCount = isGroupByInSql(this.props.getLastQueryRequest!().query.sql) ? Infinity: visibleColumnCount\n    return headers.map((column: SelectColumn, index: number) => {\n      // two cases when rendering the column headers on init load\n      // of the page we have to show only this.props.visibleColumnCount many\n      // columns, afterwards we rely on the isColumnSelected to get choices\n      const initRender: boolean = index < usedVisibleColumnCount && isColumnSelected.length === 0\n      const subsequentRender = isColumnSelected[index] && isColumnSelected.length !== 0\n      if (initRender || subsequentRender) {\n        // for background color\n        const isSelected: boolean = this.findSelectionIndex(sortedColumnSelection, column.name) !== -1\n        // for icon state\n        const columnIndex: number = columnIconSortState[index] === undefined ? 0 : columnIconSortState[index]\n        // we have to figure out if the current column is a facet selection\n        const facetIndex: number = facets.findIndex((facetColumnResult: FacetColumnResult) => {\n          const facetDisplayValue = facetAliases[facetColumnResult.columnName] || facetColumnResult.columnName\n          return facetDisplayValue === column.name\n        })\n        // the header must be included in the facets and it has to be enumerable for current rendering capabilities\n        const isFacetSelection: boolean = facetIndex !== -1 && facets[facetIndex].facetType === 'enumeration'\n        const isSelectedSpanClass = (isSelected ? 'SRC-primary-background-color SRC-anchor-light' : '')\n        const isSelectedIconClass = isSelected ? 'SRC-selected-table-icon' : 'SRC-primary-text-color'\n        const sortSpanBackgoundClass = `SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover  ${isSelectedSpanClass}`\n        return (\n          <th key={column.name}>\n            <div className=\"SRC-centerContent\">\n              <span style={{ whiteSpace: 'nowrap' }}>\n              {column.name}\n              </span>\n              {isFacetSelection && this.configureFacetDropdown(index, facets, facetIndex)}\n              <span\n                tabIndex={0}\n                className={sortSpanBackgoundClass}\n                onKeyPress={this.handleColumnSortPress({ index, name: column.name })}\n                onClick={this.handleColumnSortPress({ index, name: column.name })}\n              >\n                <FontAwesomeIcon\n                  className={`SRC-primary-background-color-hover  ${isSelectedIconClass}`}\n                  icon={ICON_STATE[columnIndex] as IconProp}\n                />\n              </span>\n            </div>\n          </th>\n        )\n      } else {\n        return <th className=\"SRC-hidden\" key={column.name} />\n      }\n    })\n  }\n\n  /**\n   * Utility to search through array of objects and find object with key \"column\"\n   * equal to input parameter \"name\"\n   *\n   * @param {*} sortedColumnSelection\n   * @param {*} name\n   * @returns -1 if not present, otherwise the index of the object\n   * @memberof SynapseTable\n   */\n  private findSelectionIndex(sortedColumnSelection: SortItem [], name: string) {\n    if (sortedColumnSelection.length !== 0) {\n      // find if the current selection exists already and remove it\n      return sortedColumnSelection.findIndex((el: SortItem) => el.column === name)\n    }\n    return -1\n  }\n\n  // Direct user to corresponding query on synapse\n  private advancedSearch(event: React.SyntheticEvent) {\n    event && event.preventDefault()\n    const lastQueryRequest = this.props.getLastQueryRequest!()\n    const { query } = lastQueryRequest\n        // base 64 encode the json of the query and go to url with the encoded object\n    const encodedQuery = btoa(JSON.stringify(query))\n    const synTable = this.props.synapseId\n    window.open(`https://www.synapse.org/#!Synapse:${synTable}/tables/query/${encodedQuery}`, '_blank')\n  }\n\n  private getLengthOfPropsData() {\n    const { data } = this.props\n    return data!.queryResult.queryResults.headers.length\n  }\n  /**\n   * Handles the toggle of a column select, this will cause the table to\n   * either show the column or hide depending on the prior state of the column\n   *\n   * @memberof SynapseTable\n   */\n  public toggleColumnSelection = (index: number) => (event: React.MouseEvent<HTMLLIElement>) => {\n    event.preventDefault()\n    let isColumnSelected: boolean []\n    // lazily initialize isColumnSelected, at first it's empty\n    // and then on first column click we set it\n    if (this.state.isColumnSelected.length === 0) {\n      const { visibleColumnCount = Infinity } = this.props\n      // unpack all the data\n      const lengthOfPropsData = this.getLengthOfPropsData()\n      let defaultSelection\n      // fill up to visibleColumnCount with true and the rest as false\n      if (visibleColumnCount === Infinity) {\n        // if set to zero then its all true\n        defaultSelection = Array(lengthOfPropsData).fill(true)\n      } else {\n        // fill in whole array as false\n        defaultSelection = Array(lengthOfPropsData).fill(false)\n        // then fill in up until lengthOfPropsData with true\n        defaultSelection.fill(true, 0, visibleColumnCount)\n      }\n      isColumnSelected = defaultSelection\n    } else {\n      isColumnSelected = cloneDeep(this.state.isColumnSelected)\n    }\n    isColumnSelected[index] = !isColumnSelected[index]\n    this.setState({ isColumnSelected })\n  }\n\n  /**\n   * Show the dropdown menu for a column that has been faceted\n   *\n   * @param {number} index this is column index of the query table data\n   * @param {string} columnName this is the name of the column\n   * @param {FacetColumnResult[]} facetColumnResults\n   * @param {number} facetIndex\n   * @returns\n   * @memberof SynapseTable\n   */\n  public configureFacetDropdown(index: number, facetColumnResults: FacetColumnResult[], facetIndex: number) {\n\n    // this grabs the specific facet selection\n    const facetColumnResult = facetColumnResults[facetIndex] as FacetColumnResultValues\n    const columnName = facetColumnResult.columnName\n\n    // this is related to whether we've selected this column or not\n    const isCurFilterSelected = this.state.activeFilterIndex === index\n\n    const ref: React.RefObject<HTMLSpanElement> = React.createRef()\n    const refOuterDiv: React.RefObject<HTMLDivElement> = React.createRef()\n\n    const applyPrimary = isCurFilterSelected ? 'SRC-primary-background-color' : 'SRC-primary-text-color'\n    const classList = isCurFilterSelected ? this.state.activeFilterClass : ''\n    const style = { alignItems: 'center', marginLeft: '10px', marginRight: '3px', color: 'black', display: 'flex' }\n    const isChecked = this.props.isAllFilterSelectedForFacet![columnName]\n    return (\n      <div\n        ref={refOuterDiv}\n        style={style}\n        className={`SRC-table-dropdown-zindex SRC-table-facet-dropdown btn-group SRC-tableHead ${isCurFilterSelected ? 'open SRC-anchor-light' : ''}`}\n      >\n        <span\n          tabIndex={0}\n          className={`SRC-padding SRC-hand-cursor SRC-primary-background-color-hover ${applyPrimary}`}\n          onKeyPress={this.toggleFilterDropdown(index, isCurFilterSelected, refOuterDiv)}\n          onClick={this.toggleFilterDropdown(index, isCurFilterSelected, refOuterDiv)}\n          style={{ outline: 'none' }}\n        >\n          <FontAwesomeIcon\n            style={{ margin: 'auto' }}\n            size={'1x'}\n            className={applyPrimary}\n            color={isCurFilterSelected ? 'white' : ''}\n            icon=\"filter\"\n          />\n        </span>\n\n        <div style={{paddingLeft: 20}} className={`dropdown-menu dropdown-menu-override SRC-minDropdownWidth ${classList}`}>\n          <ul style={{ listStyleType: 'none' }} className=\"scrollable checkbox\">\n            <label\n              className=\"dropdownList SRC-border-bottom-only SRC-overflowWrap SRC-base-font SRC-fullWidth\"\n              style={{paddingBottom: 10}}\n            >\n            <input\n              onClick={this.applyChanges({ ref, columnName, selector: SELECT_ALL })}\n              checked={isChecked}\n              className=\"SRC-facet-checkboxes\"\n              type=\"checkbox\"\n              />\n              <span> All </span>\n            </label>\n            <span ref={ref}>\n              {this.renderFacetSelection(facetColumnResult, ref, columnName)}\n            </span>\n          </ul>\n        </div>\n      </div>\n    )\n  }\n\n  // This closes out all the dropdowns, since the button calling this method is only rendered if the dropdown\n  // is visible then we can safely close out all dropdowns without checking them\n  public closeAllDropdowns(_: React.SyntheticEvent) {\n    // this ensures all dropdown variables are set to false and any additional dropdowns added are added to this list\n    const dropdownKeys: BooleanKeys<SynapseTableState> [] = [\n      'isDropdownColumnMenuOpen',\n      'isDropdownDownloadOptionsOpen',\n      'isModalDownloadOpen',\n      'isMenuWallOpen'\n    ]\n    const updatedState = {\n      activeFilterClass: '',\n      activeFilterIndex: -1,\n    }\n    dropdownKeys.forEach(\n      el => {\n        updatedState[el] = false\n      }\n    )\n    this.setState(updatedState)\n  }\n\n  public renderFacetSelection(\n    facetColumnResult: FacetColumnResultValues,\n    ref: React.RefObject<HTMLSpanElement>,\n    columnName: string,\n  ): React.ReactNode {\n\n    const { lastFacetSelection, isLoading, isAllFilterSelectedForFacet } = this.props\n    return facetColumnResult.facetValues.map(\n      (facetColumnResultValueCount: FacetColumnResultValueCount) => {\n        const { value: facetValue, count } = facetColumnResultValueCount\n        let displayValue = facetValue\n        if (displayValue === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET') {\n          displayValue = 'unannotated'\n        }\n        const key = columnName + facetValue + count \n        const isValueSelected = isAllFilterSelectedForFacet![columnName] ? false :  getIsValueSelected({\n          columnName,\n          isLoading,\n          lastFacetSelection,\n          curFacetSelection: facetColumnResultValueCount,\n        })\n        return (\n          <li className=\"checkbox SRC-table-checkbox\" key={key}>\n            <label className=\"dropdownList SRC-overflowWrap SRC-base-font SRC-fullWidth\">\n              <input\n                onChange={this.applyChanges({ ref, columnName, facetValue })}\n                checked={isValueSelected}\n                className=\"SRC-facet-checkboxes\"\n                type=\"checkbox\"\n                value={facetValue}\n                />\n              <span>\n                {displayValue}\n                <span style={{ color: '#DDDDDF', marginLeft: '3px' }}> ({count}) </span>\n              </span>\n            </label>\n          </li>\n        )\n      })\n  }\n\n  /**\n   * When the user decides to submit their changes for the dropdown menu with the facet, they have an\n   * apply button, this method handles that submission.\n   *\n   * @memberof SynapseTable\n   */\n  public applyChanges = ({\n      ref,\n      columnName,\n      facetValue = '',\n      selector = '',\n    }: {\n      ref: React.RefObject<HTMLSpanElement>,\n      columnName: string,\n      facetValue?: string,\n      selector?: string,\n    }) => (_: React.SyntheticEvent<HTMLElement>) => {\n      const htmlCheckboxes = Array.from(ref.current!.querySelectorAll('.SRC-facet-checkboxes')) as HTMLInputElement []\n      const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n      const { isAllFilterSelectedForFacet } = this.props\n      const { newQueryRequest } = readFacetValues({\n        htmlCheckboxes,\n        queryRequest,\n        selector,\n        facet: columnName\n      })\n\n      const lastFacetSelection = {\n        columnName,\n        facetValue,\n        selector\n      } as FacetSelection\n      isAllFilterSelectedForFacet![columnName] = selector === SELECT_ALL\n      this.props.updateParentState!({\n        lastFacetSelection,\n        isAllFilterSelectedForFacet\n      })\n\n      this.props.executeQueryRequest!(newQueryRequest)\n    }\n\n  public toggleFilterDropdown =\n   (index: number, isCurFilterSelected: boolean, refOuterDiv: React.RefObject<HTMLDivElement>) => (_event: any) => {\n     // The dropdown is located inside of a scrollable, to know whether the current filter menu item is near the\n     // front of the scrollable we can examine its parent bounding rect -- this gives a relative value\n     // (that changes on scroll) of the filter to a fixed left most point.\n     const tHeadLeftPosition = refOuterDiv.current!.parentElement!.getBoundingClientRect().left\n     const activeFilterClass = tHeadLeftPosition < MIN_SPACE_FACET_MENU ?\n       'SRC-forceLeftDropdown dropdown-menu-left' : 'dropdown-menu-right'\n     // set the class names for this dropdown item\n     this.setState({\n       activeFilterClass,\n       activeFilterIndex: index,\n       isDropdownColumnMenuOpen: false,\n       isMenuWallOpen: !isCurFilterSelected\n     })\n   }\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faPlus, faTimes } from '@fortawesome/free-solid-svg-icons'\nimport * as React from 'react'\nimport {\n  FacetColumnResultValues,\n} from '../utils/jsonResponses/Table/FacetColumnResult'\nimport { QueryBundleRequest } from '../utils/jsonResponses/Table/QueryBundleRequest'\nimport { getColorPallette } from './ColorGradient'\nimport { QueryWrapperChildProps, FacetSelection } from './QueryWrapper'\n\nimport { SELECT_ALL } from './SynapseTable'\nimport { getIsValueSelected, readFacetValues } from '../utils/modules/facetUtils'\nimport TotalQueryResults from './TotalQueryResults'\n\nexport const SELECT_SINGLE_FACET = 'SELECT_SINGLE_FACET'\n// Add all icons to the library so you can use it in your page\nlibrary.add(faTimes)\nlibrary.add(faPlus)\n\ntype CheckboxGroupProps = {\n  isAllFilterSelected: boolean\n  rgbIndex: number\n  facetColumnResult: FacetColumnResultValues\n  applyChanges: (\n    ref: React.RefObject<HTMLSpanElement>,\n    facetValue: string,\n    selector: string,\n  ) =>\n  (\n    _event: React.MouseEvent<HTMLSpanElement>\n  ) => void\n  showAllFacets: boolean\n  lastFacetSelection: FacetSelection\n  isLoading: boolean\n}\n\nexport const FACET_SELECTED_CLASS = 'FACET_SELECTED_CLASS'\nexport const FACET_NOT_SELECTED_CLASS = 'FACET_NOT_SELECTED_CLASS'\n\n/**\n * Checkbox group represents one column's set of checkbox filters\n *\n * @class CheckboxGroup\n * @extends {React.Component}\n */\nconst CheckboxGroup: React.FunctionComponent<CheckboxGroupProps> = (props: CheckboxGroupProps) => {\n\n  const {\n    facetColumnResult,\n    showAllFacets,\n    lastFacetSelection,\n    isLoading,\n    rgbIndex,\n    isAllFilterSelected,\n  } = props\n  const children: any = []\n  const ref: React.RefObject<HTMLSpanElement> = React.createRef()\n  // Note: this actually sorts the data when it appears in the\n  // table as it stands currently, this may change depending on\n  // if that arrangment is no longer desired\n  facetColumnResult.facetValues.sort((a: any, b: any) => {\n    return b.count - a.count\n  })\n  const { colorPalette, textColors } = getColorPallette(rgbIndex, facetColumnResult.facetValues.length)\n  facetColumnResult.facetValues.forEach((facetColumnResultValues, index: number) => {\n\n    const key = facetColumnResult.columnName + facetColumnResultValues.value + facetColumnResultValues.count\n    const textColor = textColors[index]\n    const curColor = colorPalette[index]\n    let style: any = {}\n\n    const isSelected = isAllFilterSelected ? true : getIsValueSelected({\n      isLoading,\n      lastFacetSelection,\n      columnName: facetColumnResult.columnName,\n      curFacetSelection: facetColumnResultValues\n    })\n\n    if (isSelected) {\n      style = {\n        background: curColor\n      }\n    } else {\n      style = {\n        background: '#C4C4C4'\n      }\n    }\n    // we add this class for testability\n    const backgroundClass = isSelected ? FACET_SELECTED_CLASS : FACET_NOT_SELECTED_CLASS\n    style.color = textColor\n    const { value, count } = facetColumnResultValues\n    const displayValue = value === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET' ? 'unannotated' : value\n\n    children.push(\n      <label\n        style={style}\n        className=\"SRC-facets SRC-primary-background-color-hover \"\n        key={key}\n      >\n        <span className=\"SRC-facets-text\">\n          {displayValue} ({count}){' '}\n        </span>\n        <input\n          // @ts-ignore\n          onChange={props.applyChanges(ref, value , SELECT_SINGLE_FACET)}\n          checked={isSelected}\n          type=\"checkbox\"\n          value={value}\n          className={`SRC-hidden SRC-facet-checkboxes ${backgroundClass}`}\n        />\n      </label>\n    )\n  })\n  // By default only show 5 facets unless the user has clicked a facet, in which case\n  // showAllFacets will be true.\n  const childrenView = children.map((child: any, index: number) => !showAllFacets && index > 4 ? false : child)\n  return (\n    // need a span so that we can have a ref attachable\n    <span ref={ref}>\n      {childrenView}\n    </span>\n  )\n}\n\ntype FacetsState = {\n  showAllFacets: boolean\n}\n\nclass Facets extends React.Component<QueryWrapperChildProps, FacetsState> {\n\n  constructor(props: QueryWrapperChildProps) {\n    super(props)\n    this.applyChanges = this.applyChanges.bind(this)\n    this.state = {\n      showAllFacets: false\n    }\n    this.showAllFacets = this.showAllFacets.bind(this)\n    this.showButtons = this.showButtons.bind(this)\n  }\n  /**\n   * Display the view of the facets\n   *\n   * @returns\n   * @memberof Facets\n   */\n  public showFacetFilter() {\n    if (!this.props.data!.facets) {\n      throw Error('Error on query request, must include facets in partmask to show facets')\n    }\n    // Find the facetcolumn result according to the input filter\n    const facetColumnResult = this.props.data!.facets!.find(el => el.columnName === this.props.facet && el.facetType === 'enumeration')\n    if (!facetColumnResult) {\n      throw Error('Error no matching facet found given specified facet')\n    }\n\n    return (\n      <CheckboxGroup\n        isAllFilterSelected={this.props.isAllFilterSelectedForFacet![this.props.facet!]}\n        showAllFacets={this.state.showAllFacets}\n        rgbIndex={this.props.rgbIndex!}\n        key={facetColumnResult.columnName}\n        facetColumnResult={facetColumnResult}\n        applyChanges={this.applyChanges}\n        isLoading={this.props.isLoading!}\n        lastFacetSelection={this.props.lastFacetSelection!}\n      />\n    )\n  }\n\n  /**\n   * Handle checkbox click event\n   */\n  public applyChanges = (\n    ref: React.RefObject<HTMLSpanElement>,\n    facetValue: string,\n    selector :string,\n    index?: number\n  ) =>\n  (event: React.MouseEvent<HTMLSpanElement>) => {\n    event.preventDefault()\n    if (!this.state.showAllFacets) {\n      this.setState({\n        showAllFacets: true\n      })\n    }\n\n    const { facet = '', isAllFilterSelectedForFacet = {} } = this.props\n\n    const lastFacetSelection = {\n      facetValue,\n      selector,\n      columnName: facet,\n    } as FacetSelection\n    isAllFilterSelectedForFacet[facet] = selector === SELECT_ALL\n\n    this.props.updateParentState!({\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n      chartSelectionIndex: index\n    })\n\n    // read input and fetch data\n    const htmlCheckboxes = Array.from(ref.current!.querySelectorAll('.SRC-facet-checkboxes')) as HTMLInputElement[]\n    // queryRequest is a deep clone\n    const queryRequest: QueryBundleRequest = this.props.getLastQueryRequest!()\n    const { newQueryRequest } = readFacetValues({\n      htmlCheckboxes,\n      queryRequest,\n      selector,\n      facet,\n      value: facetValue,\n    })\n\n    queryRequest.query.offset = 0\n    this.props.executeQueryRequest!(newQueryRequest)\n  }\n\n  public showAllFacets(event: React.MouseEvent<HTMLButtonElement>) {\n    event.preventDefault()\n    this.setState({\n      showAllFacets: true\n    })\n  }\n\n  public showButtons(showAllFacets: boolean, curFacetsLength: number, ref: React.RefObject<HTMLDivElement>) {\n    if (showAllFacets) {\n      // this is hidden if there are > 5 facets, wait for user to make\n      // an action for this to appear\n      return (\n        <button\n          className=\"SRC-primary-text-color SRC-facet-select-all SRC-no-text-decor\"\n          onClick={this.applyChanges(ref, '', SELECT_ALL)}\n        >\n          Select All\n        </button>\n      )\n    }\n\n    return (\n      <button\n        id=\"showAllFacetsButton\"\n        className=\"SRC-primary-text-color SRC-no-text-decor\"\n        onClick={this.showAllFacets}\n      >\n        {' '}\n        Show All ({curFacetsLength}){' '}\n      </button>\n    )\n  }\n\n  public render() {\n    if (!this.props.data) {\n      return (<div/>)\n    }\n    let { showAllFacets } = this.state\n    const { data, facet, unitDescription, isLoading, showBarChart } = this.props\n    const { facets } = data\n    if (!facets) {\n      throw Error('Error on query request, must include facets in partmask to show facets')\n    }\n    const curFacetsIndex = facets.findIndex(curFacet => curFacet.columnName === facet && curFacet.facetType === 'enumeration')\n    // cast is necessary because filter returns an array of arrays\n    const facetColumnResultValues = facets[curFacetsIndex] as FacetColumnResultValues\n\n    if (!facetColumnResultValues) {\n      return (<div/>)\n    }\n\n    if (facetColumnResultValues.facetValues.length < 5) {\n      // override\n      showAllFacets = true\n    }\n    const ref: React.RefObject<HTMLDivElement> = React.createRef()\n    return (\n      <div className=\"SRC-syn-border-spacing\">\n        {\n          !showBarChart\n          &&\n          <TotalQueryResults\n            data={data}\n            facet={facet!}\n            unitDescription={unitDescription!}\n            frontText={'Displaying'}\n            isLoading={isLoading!}\n          />\n        }\n        <form>\n          <div ref={ref} className=\"SRC-marginFive form-group\">\n            {this.showFacetFilter()}\n            {this.showButtons(showAllFacets, facetColumnResultValues.facetValues.length, ref)}\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\n\nexport { Facets, CheckboxGroup }\n","import { SynapseConstants, SynapseClient } from '../utils/'\nimport * as React from 'react'\nimport { QueryBundleRequest } from '../utils/jsonResponses/Table/QueryBundleRequest'\n\nexport type QueryCountProps = {\n  sql: string\n  name: string\n  token?: string\n}\n\ntype QueryCountState = {\n  [index: string]: number\n}\n\n\n/**\n * QueryCount shows a query count\n *\n * @export\n * @class QueryCount\n * @extends {React.Component<QueryCountProps, QueryCountState>}\n */\nexport default class QueryCount extends React.Component<QueryCountProps, QueryCountState> {\n\n  constructor(props: QueryCountProps) {\n    super(props)\n    this.state = {}\n    this.calculateRowCount = this.calculateRowCount.bind(this)\n  }\n\n  componentDidMount() {\n    this.calculateRowCount()\n  }\n  \n  componentDidUpdate() {\n    this.calculateRowCount()\n  }\n  \n  calculateRowCount() {\n    const { sql, token } = this.props\n    if (this.state[sql]) {\n      return\n    }\n    const request: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      query: {\n        sql,\n      },\n      partMask: SynapseConstants.BUNDLE_MASK_QUERY_COUNT\n    }\n    SynapseClient.getQueryTableResults(request, token).then(\n      (data) => {\n        this.setState({ [sql]: data.queryCount! })\n      }\n    )\n  }\n\n  render () {\n    const { sql, name } = this.props\n    const count = this.state[sql]\n    /* https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString#Using_toLocaleString */\n    return <React.Fragment> {name} ({count && count.toLocaleString()}) </React.Fragment>\n  }\n}\n","import * as React from 'react'\nimport { QueryBundleRequest } from '../utils/jsonResponses/Table/QueryBundleRequest'\nimport { QueryResultBundle } from '../utils/jsonResponses/Table/QueryResultBundle'\nimport { SynapseClient, SynapseConstants } from '../utils/'\nimport { cloneDeep } from '../utils/modules'\nimport { getNextPageOfData } from '../utils/modules/queryUtils'\nimport { AsynchronousJobStatus } from '../utils/jsonResponses/Table/AsynchronousJobStatus'\nimport { FacetColumnResultValues } from '../utils/jsonResponses/Table/FacetColumnResult'\n\nexport type QueryWrapperProps = {\n  initQueryRequest: QueryBundleRequest\n  rgbIndex?: number\n  token?: string\n  showMenu?: boolean\n  facet?: string\n  loadingScreen?: JSX.Element\n  unitDescription?: string\n  facetAliases?: {}\n  loadNow?: boolean\n  showBarChart?: boolean\n}\n\nexport type QueryWrapperState = {\n  /*\n    isAllFilterSelectedForFacet tracks whether for a particular\n     facet if the 'All' button has been selected, this tracks the\n     click event and syncs Facets.tsx and SynapseTable.tsx\n  */\n  isAllFilterSelectedForFacet: {}\n  data: QueryResultBundle | undefined\n  isLoadingNewData: boolean  // occurs when props change\n  isLoading: boolean         // occurs when state changes\n  lastQueryRequest: QueryBundleRequest\n  hasMoreData: boolean\n  lastFacetSelection: FacetSelection\n  chartSelectionIndex: number\n  asyncJobStatus?: AsynchronousJobStatus\n  facetAliases?: {}\n  loadNowStarted: boolean\n  initQueryRequest: QueryBundleRequest\n}\n\nexport type FacetSelection = {\n  columnName: string\n  facetValue: string\n  selector: string\n}\n\n// Since the component is an HOC we export the props passed down\nexport type QueryWrapperChildProps = {\n  isAllFilterSelectedForFacet?: {}\n  isLoading?: boolean\n  token?: string\n  isLoadingNewData?: boolean\n  executeQueryRequest?: (param: QueryBundleRequest) => Promise<undefined>\n  executeInitialQueryRequest?: () => void\n  getNextPageOfData?: (queryRequest: QueryBundleRequest) => void\n  getLastQueryRequest?: () => QueryBundleRequest\n  getInitQueryRequest?: () => QueryBundleRequest\n  data?: QueryResultBundle\n  facet?: string\n  updateParentState?: (param: any) => void\n  rgbIndex?: number\n  unitDescription?: string\n  facetAliases?: {}\n  lastFacetSelection?: FacetSelection\n  chartSelectionIndex?: number\n  asyncJobStatus?: AsynchronousJobStatus\n  showBarChart?: boolean\n  hasMoreData?: boolean\n}\n\n/**\n * Class wraps around any Synapse views that are dependent on a query bundle\n * Those classes then take in as props:\n *\n * @class QueryWrapper\n * @extends {React.Component}\n */\nexport default class QueryWrapper extends React.Component<QueryWrapperProps, QueryWrapperState> {\n\n  public static defaultProps = {\n    token: ''\n  }\n\n  public static initialState = {\n    data: undefined,\n    isLoading: true,\n    isLoadingNewData: true,\n    lastQueryRequest: {} as QueryBundleRequest,\n    hasMoreData: true,\n    lastFacetSelection: {\n      columnName: '',\n      facetValue: '',\n      selector: ''\n    },\n    chartSelectionIndex: 0,\n    isAllFilterSelectedForFacet: {},\n    loadNowStarted: false,\n  } as QueryWrapperState\n  \n  constructor(props: QueryWrapperProps) {\n    super(props)\n    this.executeInitialQueryRequest = this.executeInitialQueryRequest.bind(this)\n    this.executeQueryRequest = this.executeQueryRequest.bind(this)\n    this.getLastQueryRequest = this.getLastQueryRequest.bind(this)\n    this.getNextPageOfData = this.getNextPageOfData.bind(this)\n    this.updateParentState = this.updateParentState.bind(this)\n    this.getInitQueryRequest = this.getInitQueryRequest.bind(this)\n    this.state = QueryWrapper.initialState\n  }\n\n  /**\n   * Compute default query request\n   *\n   * @memberof QueryWrapper\n   */\n  public componentDidMount() {\n    const { loadNow = true } = this.props\n    if (loadNow) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * @memberof QueryWrapper\n   */\n  public componentDidUpdate(prevProps: any) {\n    /**\n     *  If component updates and the token has changed (they signed in) then the data should be pulled in. Or if the\n     *  sql query has changed of the component then perform an update.\n     */\n\n    const { loadNow = true } = this.props\n    if (loadNow && !this.state.loadNowStarted) {\n      this.executeInitialQueryRequest()\n    } else if (this.props.token !== '' && prevProps.token === '') {\n      this.executeInitialQueryRequest()\n    } else if (prevProps.initQueryRequest.query.sql !== this.props.initQueryRequest!.query.sql) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * last query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getLastQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.state.lastQueryRequest)\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * first query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getInitQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.props.initQueryRequest)\n  }\n\n  /**\n   * Execute the given query\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeQueryRequest(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true\n    })\n    return SynapseClient.getQueryTableResults(\n      queryRequest,\n      this.props.token,\n      this.updateParentState\n    )\n    .then(\n      (data: QueryResultBundle) => {\n        const hasMoreData = data.queryResult.queryResults.rows.length === SynapseConstants.PAGE_SIZE\n        const newState: any = {\n          hasMoreData,\n          data,\n          isLoading: false,\n          lastQueryRequest: cloneDeep(queryRequest),\n          asyncJobStatus: undefined\n        }\n        this.setState(newState)\n        return Promise.resolve(() => {})\n      }\n    ).catch((err: string) => {\n      console.log('Failed to get data ', err)\n      return Promise.resolve(() => {})\n    })\n  }\n\n  /**\n   * Grab the next page of data, pulling in 25 more rows.\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public async getNextPageOfData(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true\n    })\n\n    await getNextPageOfData(queryRequest, this.state.data!, this.props.token)\n    .then(\n      (newState) => {\n        this.setState({\n          ...newState,\n          isLoading: false,\n          lastQueryRequest: cloneDeep(queryRequest)\n        })\n      }\n    )\n  }\n\n  /**\n   * Execute the initial query passed into the component\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeInitialQueryRequest() {\n    this.setState({\n      isLoading: true,\n      isLoadingNewData: true,\n      chartSelectionIndex: 0,\n      loadNowStarted: true\n    })\n    SynapseClient\n      .getQueryTableResults(this.props.initQueryRequest, this.props.token, this.updateParentState)\n      .then(\n        (data: QueryResultBundle) => {\n          const lastQueryRequest: QueryBundleRequest = cloneDeep(this.props.initQueryRequest!)\n          const hasMoreData = data.queryResult.queryResults.rows.length === SynapseConstants.PAGE_SIZE\n          const isAllFilterSelectedForFacet = cloneDeep(this.state.isAllFilterSelectedForFacet)\n          let { chartSelectionIndex } = this.state\n          if (this.props.facet) {\n            if (!data.facets) {\n              throw Error('Error on query request, must include facets in partmask to show facets')\n            }\n            data.facets.forEach((el: FacetColumnResultValues) => {\n              if (el.facetType === 'enumeration') {\n                // isAll is only true iff there are no facets selected or all elements are selected\n                const { facetValues } = el\n                const isAllFalse = facetValues.every(facet => !facet.isSelected)\n                const isAllTrue =  facetValues.every(facet => facet.isSelected)\n                const isByDefaultSelected = isAllFalse || isAllTrue\n                isAllFilterSelectedForFacet[el.columnName] = isByDefaultSelected\n                if (el.columnName === this.props.facet && !isAllFalse) {\n                  // Note - this picks the first selected facet\n                  chartSelectionIndex = facetValues.sort((a, b) => b.count - a.count).findIndex(facet => facet.isSelected)\n                }\n              }\n            })\n          }\n          const newState = {\n            isAllFilterSelectedForFacet,\n            hasMoreData,\n            data,\n            chartSelectionIndex,\n            lastQueryRequest,\n            isLoading: false,\n            isLoadingNewData: false,\n            asyncJobStatus: undefined\n          }\n          this.setState(newState)\n        }\n      ).catch((err) => {\n        console.log('Failed to get data ', err)\n      })\n  }\n\n  public updateParentState (update: QueryWrapperState) {\n    this.setState(update)\n  }\n\n  /**\n   * Render the children without any formatting\n   */\n  public render() {\n    const { isLoading } = this.state\n    const { facetAliases = {} } = this.props\n    // inject props in children of this component\n    const childrenWithProps = (React.Children.map(this.props.children, (child: any) => {\n      return React.cloneElement(child, {\n        facetAliases,\n        isAllFilterSelectedForFacet: this.state.isAllFilterSelectedForFacet,\n        data: this.state.data,\n        token: this.props.token,\n        executeInitialQueryRequest: this.executeInitialQueryRequest,\n        executeQueryRequest: this.executeQueryRequest,\n        getLastQueryRequest: this.getLastQueryRequest,\n        getNextPageOfData: this.getNextPageOfData,\n        isLoading: this.state.isLoading,\n        isLoadingNewData: this.state.isLoadingNewData,\n        facet: this.props.facet,\n        rgbIndex: this.props.rgbIndex,\n        unitDescription: this.props.unitDescription,\n        updateParentState: this.updateParentState,\n        isQueryWrapperChild: true,\n        hasMoreData: this.state.hasMoreData,\n        lastFacetSelection: this.state.lastFacetSelection,\n        chartSelectionIndex: this.state.chartSelectionIndex,\n        getInitQueryRequest: this.getInitQueryRequest,\n        asyncJobStatus: this.state.asyncJobStatus,\n        showBarChart: this.props.showBarChart\n      })\n    }))\n\n    const loadingCusrorClass = isLoading ? 'SRC-logo-cursor' : ''\n    if (this.props.showMenu) {\n      // menu is to the left of the child components so we let that add its\n      // own html\n      return (\n        <div className={`${loadingCusrorClass}`}>\n          {childrenWithProps}\n        </div>\n      )\n    }\n    return (\n      <div className={`${loadingCusrorClass}`}>\n        {childrenWithProps}\n      </div>\n    )\n  }\n}\n","import { library } from '@fortawesome/fontawesome-svg-core'\nimport { faAngleLeft, faAngleRight } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport * as React from 'react'\nimport ReactMeasure from \"react-measure\"\nimport ReactTooltip from \"react-tooltip\"\nimport { getColorPallette } from './ColorGradient'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport { FacetColumnResultValueCount } from '../utils/jsonResponses/Table/FacetColumnResult'\nimport { getIsValueSelected } from '../utils/modules/facetUtils'\nlibrary.add(faAngleLeft)\nlibrary.add(faAngleRight)\n\nexport const PREVIOUS_ITEM_CLICK = 'left click'\nexport const NEXT_CLICK = 'right click'\n\ntype Rect = {\n  height: number\n  width: number\n  top: number\n  left: number\n  right: number\n  bottom: number\n}\n\ntype MeasureRect = {\n  bounds: Rect\n}\n\nexport type StackedBarChartState = {\n  selectedFacets: {}\n  dimensions: MeasureRect\n}\n\nexport type StackedBarChartProps = {\n  loadingScreen: JSX.Element\n  link?: string\n  linkText?: string\n}\n\ntype Info = {\n  value: string\n  count: number\n  index: number\n}\n\ntype InternalProps = StackedBarChartProps & QueryWrapperChildProps\n/**\n * Make a simple stacked bar chart\n *\n * @class StackedBarChart\n * @extends {React.Component}\n */\nexport default class StackedBarChart extends\n    React.Component<InternalProps, StackedBarChartState> {\n\n  constructor(props: InternalProps) {\n    super(props)\n    this.handleHover = this.handleHover.bind(this)\n    this.handleExit = this.handleExit.bind(this)\n    this.handleClick = this.handleClick.bind(this)\n    this.handleArrowClick = this.handleArrowClick.bind(this)\n    this.getTextForChartSelection = this.getTextForChartSelection.bind(this)\n    this.onMeasureResize = this.onMeasureResize.bind(this)\n    this.rgba2rgb = this.rgba2rgb.bind(this)\n    // the text currently under the cursor\n    this.state = {\n      // the dimensions of the bar chart itself\n      dimensions: { bounds: { height: 1, width: 1, top: 0, left: 0, right: 0, bottom: 0 } },\n      // the text of the current slice\n      // the count of this facet value occurence\n      selectedFacets: {}\n    }\n    this.extractPropsData = this.extractPropsData.bind(this)\n  }\n\n  /**\n   * Updates the hover text and update the view\n   *\n   * @memberof StackedBarChart\n   */\n  public handleHover(event: React.MouseEvent<SVGRectElement>) {\n    // add box shadow\n    event.currentTarget.style.boxShadow = '25px 20px'\n  }\n\n  /**\n   * Update the hover text and the view\n   *\n   * @param {*} event\n   * @memberof StackedBarChart\n   */\n  public handleExit(event: React.MouseEvent<SVGRectElement>) {\n    // remove box shadow\n    event.currentTarget.style.boxShadow = ''\n  }\n\n  /**\n   * Handle column click event\n   */\n  public handleClick = (dict: Info) => (_event: React.MouseEvent<SVGElement>) => {\n    // https://medium.freecodecamp.org/reactjs-pass-parameters-to-event-handlers-ca1f5c422b9\n    this.props.updateParentState!({ chartSelectionIndex: dict.index })\n  }\n\n  public handleArrowClick = (direction: string) => (_event: React.MouseEvent) => {\n    let { chartSelectionIndex = 0 } = this.props\n    let dict: any = this.extractPropsData(this.props.data)\n    const length = Object.keys(dict).length\n    if (direction === PREVIOUS_ITEM_CLICK) {\n      chartSelectionIndex -= 1\n      // if its at zero then we want to wrap around to the end\n      chartSelectionIndex = chartSelectionIndex < 0 ? length - 1 : chartSelectionIndex\n    } else {\n      chartSelectionIndex += 1\n    }\n    chartSelectionIndex = chartSelectionIndex % length\n\n    dict = dict[chartSelectionIndex]\n    this.props.updateParentState!({ chartSelectionIndex })\n    // return is only for testing purposes\n    return chartSelectionIndex\n  }\n\n  public getTextForChartSelection(xData: any) {\n    const { chartSelectionIndex = 0 } = this.props\n    const { facetAliases = {}, facet } = this.props\n    const facetValueDisplay = xData[chartSelectionIndex] && xData[chartSelectionIndex].value\n    const filterDisplay = facetAliases[facet!] || facet\n    return (\n      <span>\n        <span className=\"SRC-text-title SRC-filter-display\">\n          {filterDisplay}\n        </span> :\n        <span className=\"SRC-facet-view SRC-text-title\">\n          {' '}\n          {facetValueDisplay === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET' ? 'unannotated' : facetValueDisplay}\n        </span>\n      </span>\n    )\n  }\n\n  public getFileCount(xData: any) {\n    const { chartSelectionIndex = 1 } = this.props\n    return xData[chartSelectionIndex] && xData[chartSelectionIndex].count\n  }\n\n  public rgba2rgb(background: number[], color: number[]) {\n    const alpha = color[3]\n    return [\n      Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5),\n      Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5),\n      Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5)\n    ]\n  }\n\n  public render() {\n    const {\n      data,\n      isLoadingNewData,\n      loadingScreen,\n      rgbIndex,\n      facet = '',\n      unitDescription,\n      isLoading,\n      lastFacetSelection,\n      isAllFilterSelectedForFacet,\n      chartSelectionIndex,\n      asyncJobStatus\n    } = this.props\n    // while loading\n    if (isLoadingNewData) {\n      return (\n        <div className=\"SRC-loadingContainer SRC-centerContentColumn\">\n          {/*\n            check loading screen is not undefined or null and show\n            it if so\n          */}\n          {!!loadingScreen && loadingScreen}\n          <div>\n            {asyncJobStatus && asyncJobStatus.progressMessage}\n          </div>\n        </div>\n      )\n    }\n    const xData = this.extractPropsData(data)\n    let total: number = 0\n    const width: number = this.state.dimensions.bounds!.width\n    // sum up the counts of data\n    for (const key in xData) {\n      if (xData.hasOwnProperty(key)) {\n        total += xData[key].count\n      }\n    }\n    const { colorPalette, textColors } = getColorPallette(rgbIndex!, xData.length)\n    const originalColor = colorPalette[0]\n\n    return (\n      <React.Fragment>\n        {/* TODO: Refactor the chart into its own component */}\n        <div className=\"SRC-bar-border SRC-bar-marginTop SRC-bar-border-top\">\n          <ReactMeasure\n            bounds={true}\n            onResize={(contentRect: any) => {\n              this.setState({ dimensions: contentRect })\n            }}\n          >\n            {({ measureRef }) => (\n              <div className=\"SRC-flex\" ref={measureRef}>\n                {xData.map((obj: FacetColumnResultValueCount, index) => {\n                  const textColor: string = textColors[index]\n                  const rgbColor: string = colorPalette[index]\n                  let rectStyle: any\n                  const isValueSelected = isAllFilterSelectedForFacet![facet] ? true : getIsValueSelected({\n                    isLoading,\n                    lastFacetSelection,\n                    columnName: facet,\n                    curFacetSelection: obj\n                  })\n                  if (isValueSelected) {\n                    rectStyle = {\n                      fill: rgbColor\n                    }\n                  } else {\n                    rectStyle = {\n                      fill: '#C4C4C4'\n                    }\n                  }\n                  const svgHeight = 80\n                  const svgWidth = obj.count / total * width\n                  const style: any = {}\n                  if (chartSelectionIndex === index) {\n                    style.filter = 'drop-shadow(5px 5px 5px rgba(0,0,0,0.5))'\n                  }\n                  const label: string = `${facet}: ${obj.value}  - ${obj.count} ${unitDescription}`\n                  // there was one bug where a new line character was in the obj.value, making data-for\n                  // break because its a special character, below we remove that\n                  const tooltipId = obj.value.replace(/(\\r\\n|\\n|\\r)/gm, '')\n                  // basic heuristic to calculate the number of pixels needed to show the value on the bar chart\n                  const value = obj.count as number\n                  const numCharsInValue = value.toString().length * 4.5 // represents width of a character\n\n                  return (\n                    // each svg represents one of the bars\n                    // will need to change this to be responsive\n                    <React.Fragment key={label}>\n                      <span data-for={tooltipId} data-tip={label}>\n                        <svg\n                          className=\"SRC-hoverBox\"\n                          height={svgHeight + 15}\n                          width={svgWidth}\n                          style={style}\n                          onClick={this.handleClick({ ...obj, index })}\n                        >\n                          <rect\n                            onMouseEnter={this.handleHover}\n                            onMouseLeave={this.handleExit}\n                            height={svgHeight}\n                            width={svgWidth}\n                            className=\"SRC-chart-rect-style\"\n                            // can't remove inline style due to dynamic fill\n                            style={rectStyle}\n                          />\n                          {index < 3 && svgWidth > numCharsInValue &&\n                            <text\n                              textAnchor=\"middle\"\n                              className=\"SRC-text-title\"\n                              fontFamily={'bold sans-serif'}\n                              fill={textColor}\n                              x={'50%'}\n                              y={'50%'}\n                            >\n                              {obj.count}\n                            </text>}\n                          {\n                            (chartSelectionIndex === index) &&\n                              (\n                                <text\n                                  fill={originalColor}\n                                  x={0}\n                                  y={svgHeight + 15}\n                                  className=\"SRC-text-shadow SRC-text-large\"\n                                >\n                                  {'\\u25CF'}\n                                </text>\n                              )\n                          }\n                        </svg>\n                      </span>\n                      <ReactTooltip delayShow={1000} id={tooltipId} />\n                    </React.Fragment>)\n                })}\n              </div>)}\n          </ReactMeasure>\n        </div>\n        <div className=\"SRC-bar-border SRC-bar-border-bottom\">\n          <p className=\"SRC-noMargin SRC-padding-chart SRC-text-title\">\n            <strong>{this.getTextForChartSelection(xData)}</strong>\n          </p>\n          <p id=\"fileCount\" className=\"SRC-noMargin SRC-padding-chart SRC-text-chart\">\n            {this.getFileCount(xData)} {unitDescription}\n          </p>\n          {\n            this.props.link &&\n              <div className=\"SRC-chart-link\">\n                <a href={`#/${this.props.link}`}> {this.props.linkText} </a>\n              </div>\n          }\n        </div>\n        <div className=\"SRC-chart SRC-chart-nav SRC-center-text\">\n          <button\n            className=\"SRC-chart-btn btn btn-default btn-sm SRC-floatRight\"\n            onClick={this.handleArrowClick(NEXT_CLICK)}\n          >\n            <FontAwesomeIcon\n              style={{ fontSize: '11px' }}\n              className=\"SRC-primary-text-color\"\n              icon=\"angle-right\"\n            />\n          </button>\n          <button\n            className=\"SRC-chart-btn btn btn-default btn-sm SRC-floatRight\"\n            onClick={this.handleArrowClick(PREVIOUS_ITEM_CLICK)}\n          >\n            <FontAwesomeIcon\n              style={{ fontSize: '11px' }}\n              className=\"SRC-primary-text-color\"\n              icon=\"angle-left\"\n            />\n          </button>\n        </div>\n      </React.Fragment>\n    )\n  }\n  public extractPropsData(data: any) {\n    const xData: any[] = []\n    const { facet } = this.props\n    // pull out the data corresponding to the filter in question\n    data.facets.forEach(\n      (item: any) => {\n        if (item.facetType === 'enumeration' && item.columnName === facet) {\n          item.facetValues.forEach(\n            (facetValue: any) => {\n              if (item.columnName) {\n                xData.push({ columnName: item.columnName, ...facetValue })\n              }\n            }\n          )\n        }\n      }\n    )\n    // sort the data so that the largest bars are at the front\n    xData.sort((a, b) => {\n      return b.count - a.count\n    })\n    return xData\n  }\n\n  public onMeasureResize(contentRect: any) {\n    this.setState({ dimensions: contentRect })\n  }\n}\n","const sufixes: string [] = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n\nexport default function calculateFriendlyFileSize(bytes: number) {\n  if (!bytes) {\n    return ''\n  }\n    // https://stackoverflow.com/questions/10420352/converting-file-size-in-bytes-to-human-readable-string\n  const i = Math.floor(Math.log(bytes) / Math.log(1024))\n  // tslint:disable-next-line\n  return (!bytes && '0 Bytes') || (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sufixes[i]\n}\n","import * as React from 'react'\nimport { DATASET } from '../../utils/SynapseConstants'\nimport calculateFriendlyFileSize from '../calculateFriendlyFileSize'\nimport * as Utils from './utils'\n\ntype DatasetProps = {\n  data?: any\n  schema?: any\n  secondaryLabelLimit?:number\n}\n\nclass Dataset extends React.Component<DatasetProps, {}> {\n\n  constructor(props: DatasetProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n\n  public handleLinkClick = (link: string) => (event: React.MouseEvent<HTMLButtonElement>) => {\n    event.preventDefault()\n    window.open(`https://www.synapse.org/#!Synapse:${link}`, '_blank')\n  }\n\n  public render() {\n    const { data, schema } = this.props\n    const datasetName = data[schema.datasetName]\n    const summary = data[schema.summary]\n    const tumorType = data[schema.tumorType]\n    const diseaseFocus = data[schema.diseaseFocus]\n    const id = data[schema.id]\n    const fundingAgency = data[schema.fundingAgency]\n    const fileCount = data[schema.fileCount]\n    const fileSize = calculateFriendlyFileSize(data[schema.fileSize])\n    const values = [['FUNDER', fundingAgency], ['SIZE', fileSize], ['FILES', fileCount]]\n    return (\n      <div className=\"SRC-portalCard SRC-typeDataset  \">\n        <div className=\"SRC-cardThumbnail\">\n          <Utils.Icon type={DATASET} />\n          <div>{fileSize}</div>\n        </div>\n        <div className=\"SRC-cardContent SRC-dataset\">\n          <div className=\"SRC-type\">Dataset </div>\n          <div>\n            <h3>\n              <a target=\"_self\" href={`https://www.synapse.org/#!Synapse:${id}`}>\n                {datasetName}\n              </a>\n            </h3>\n          </div>\n          <div className=\"SRC-description-dataset\">\n            <p className=\"SRC-description-text\">\n              {summary}\n            </p>\n            <div className=\"SRC-cardAction\">\n              <button className=\"SRC-datasetButton\" onClick={this.handleLinkClick(id)} type=\"button\">\n                Download Dataset\n              </button>\n            </div>\n          </div>\n          <div className=\"SRC-cardAnnotations\">\n            <Utils.ChipContainer chips={[tumorType, diseaseFocus]} />\n          </div>\n        </div>\n        <Utils.CardFooter isHeader={false} secondaryLabelLimit={this.props.secondaryLabelLimit} values={values} />\n      </div>\n    )\n  }\n}\nexport default Dataset\n","import * as React from 'react'\n\nimport ctfSvg from '../../assets/logos/ctf.svg'\nimport dhartSvg from '../../assets/logos/dhart.svg'\nimport ntapSvg from  '../../assets/logos/ntap.svg'\n\nconst logoLinks = {\n  CTF: ctfSvg,\n  'DHART SPORE':dhartSvg,\n  NTAP: ntapSvg\n}\n\ntype FunderProps = {\n  data?: any\n  schema?: any\n}\n\nexport default class Funder extends React.Component<FunderProps, {}> {\n  constructor(props: FunderProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n  public handleLinkClick = (link: string) => (event: React.MouseEvent<HTMLButtonElement>) => {\n    event.preventDefault()\n    window.open(link, '_blank')\n  }\n  public render() {\n    const { data, schema } = this.props\n    const organizationName = data[schema.organizationName]\n    const organizationPath = data[schema.organizationPath]\n    const summary = data[schema.summary]\n    const website = data[schema.website]\n    const abbreviation = data[schema.abbreviation]\n    const logo = logoLinks[abbreviation]\n    const orgPath = `${window.location.origin}/#${organizationPath}`\n    // remove leading http(s):// and trailing /\n    let websiteDisplayName = website.replace('https://', '')\n    websiteDisplayName = websiteDisplayName.replace('http://', '')\n    if (websiteDisplayName.charAt(websiteDisplayName.length - 1) === '/') {\n      websiteDisplayName = websiteDisplayName.substring(0, websiteDisplayName.length - 1)\n    }\n    const isOnOrgPath = window.location.hash.substring(1) === organizationPath\n    const style: any = {}\n    let showOrgLink\n    if (!isOnOrgPath) {\n      showOrgLink = (\n        <div className=\"SRC-marginAuto SRC-cardAction\">\n          <button onClick={this.handleLinkClick(orgPath)} type=\"button\">\n            View Funded Research\n          </button>\n        </div>\n        )\n    } else {\n      style.paddingBottom = '42px'\n    }\n    return (\n        <div className=\"SRC-portalCard SRC-typeFunder \" style={style}>\n            <div className=\"SRC-cardContent\">\n                <div className=\"SRC-type\">Organization</div>\n                <div className=\"SRC-cardThumbnail\">\n                    <img alt=\"funder logo\" className=\"SRC-logo\" src={logo} />\n                </div>\n                <div >\n                    <h3>\n                        {isOnOrgPath && organizationName}\n                        {!isOnOrgPath && <a href={orgPath}>{organizationName}</a>}\n                    </h3>\n                </div>\n                <div className=\"SRC-website\">\n                    <a rel=\"noopener noreferrer\" target=\"_blank\" href={website}>\n                        {websiteDisplayName}\n                    </a>\n                </div>\n                <div className=\"SRC-description\">{summary}</div>\n            </div>\n            {showOrgLink}\n        </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { PUBLICATION } from '../../utils/SynapseConstants'\nimport * as Utils from './utils'\n\ntype PublicationProps = {\n  data?: any\n  schema?: any\n  secondaryLabelLimit?:number\n}\n\nclass Publication extends React.Component<PublicationProps, {}> {\n\n  constructor(props: PublicationProps) {\n    super(props)\n  }\n\n  public render() {\n    const { data, schema } = this.props\n    const citation = data[schema.citation]\n    const tumorType = data[schema.tumorType]\n    const diseaseFocus = data[schema.diseaseFocus]\n    const doi = data[schema.doi]\n    const fundingAgency = data[schema.fundingAgency]\n    const projectName = data[schema.projectName]\n    const values = [['DOI', doi], ['FUNDER', fundingAgency], ['STUDY', projectName]]\n    return (\n      <div className=\"SRC-portalCard SRC-typePublication  \">\n          <div className=\"SRC-cardThumbnail\">\n              <Utils.Icon type={PUBLICATION} />\n          </div>\n          <div className=\"SRC-cardContent\">\n              <div className=\"SRC-type\">Publication</div>\n              <div >\n                  <h3>\n                      <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://dx.doi.org/${doi}`}>\n                          {citation}\n                      </a>\n                  </h3>\n              </div>\n              <div className=\"SRC-cardAnnotations\">\n                  <Utils.ChipContainer chips={[tumorType, diseaseFocus]} />\n              </div>\n          </div>\n          <Utils.CardFooter isHeader={false} secondaryLabelLimit={this.props.secondaryLabelLimit} values={values} />\n      </div>\n    )\n  }\n}\nexport default Publication\n","import * as React from 'react'\nimport { STUDY_ACTIVE, STUDY_COMPLETE } from '../../utils/SynapseConstants'\nimport * as Utils from './utils/index'\n\ntype StudyState = {\n  showMore: boolean\n  hasCreatedIndex: boolean\n}\n\ntype StudyProps = {\n  data?: any\n  schema?: any\n  secondaryLabelLimit?:number\n}\n\nexport default class Study extends React.Component<StudyProps, StudyState> {\n\n  constructor(props: StudyProps) {\n    super(props)\n    this.state = {\n      hasCreatedIndex: false,\n      showMore: false\n    }\n    this.handleClick = this.handleClick.bind(this)\n  }\n\n  public handleClick(_event: React.SyntheticEvent) {\n    this.setState({\n      showMore: !this.state.showMore\n    })\n  }\n\n  public render() {\n    const { data, schema } = this.props\n    const projectName: string = data[schema.projectName]\n    const projectLeads: string = data[schema.projectLeads] && data[schema.projectLeads].split(';').join(' / ')\n    const summary: string = data[schema.summary]\n    const diseaseFocus: string = data[schema.diseaseFocus]\n    const tumorType: string = data[schema.tumorType]\n    const projectStatus: string = data[schema.projectStatus]\n    const fundingAgency: string = data[schema.fundingAgency]\n    const dataStatus: string = data[schema.dataStatus]\n    const id: string = data[schema.id]\n    const link: string = `https://www.synapse.org/#!Synapse:${id}`\n    const values: string [][] = [\n      ['STATUS', projectStatus],\n      ['FUNDER', fundingAgency],\n      ['DATA', dataStatus]\n    ]\n    const chips: string [] = [tumorType, diseaseFocus]\n    return (\n      <div className=\"SRC-portalCard SRC-typeStudy  \">\n          <div className=\"SRC-cardThumbnail\">\n              <Utils.Icon type={projectStatus === 'Active' ? STUDY_ACTIVE : STUDY_COMPLETE}/>\n              <div>{projectStatus}</div>\n          </div>\n          <div className=\"SRC-cardContent\">\n              <div className=\"SRC-type\">Study</div>\n              <div >\n                  {' '}\n                  <h3>\n                      {' '}\n                      <a target=\"_self\" href={link}>\n                          {projectName}\n                      </a>{' '}\n                  </h3>{' '}\n              </div>\n              <div className=\"SRC-author\">{projectLeads}</div>\n              <span className=\"SRC-font-size-base\">\n                  <Utils.ShowMore summary={summary} />\n              </span>\n              <div className=\"SRC-cardAnnotations\">\n                  <Utils.ChipContainer chips={chips} />\n              </div>\n          </div>\n          <Utils.CardFooter isHeader={false} secondaryLabelLimit={this.props.secondaryLabelLimit} values={values} />\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { TOOL } from '../../utils/SynapseConstants'\nimport * as Utils from './utils'\n\ntype ToolProps = {\n  data?: any\n  schema?: any\n}\n\nexport default class Tool extends React.Component<ToolProps, {}> {\n\n  constructor(props: ToolProps) {\n    super(props)\n    this.handleLinkClick = this.handleLinkClick.bind(this)\n  }\n\n  public handleLinkClick = (link: string) => (event: React.MouseEvent<HTMLButtonElement>) => {\n    event.preventDefault()\n    window.open(link, '_blank')\n  }\n\n  public render() {\n    const { data, schema } = this.props\n    const softwareName = data[schema.softwareName]\n    const summary = data[schema.summary]\n    const softwareLink = data[schema.softwareLink]\n    return (\n            <div className=\"SRC-portalCard SRC-typeTool  \">\n                <div className=\"SRC-cardThumbnail\">\n                    <Utils.Icon type={TOOL} />\n                </div>\n                <div className=\"SRC-cardContent\">\n                    <div className=\"SRC-type\">Tool</div>\n                    <div >\n                        <h3>\n                            <a href={softwareLink} target=\"_blank\" rel=\"noopener noreferrer\">\n                                {softwareName}\n                            </a>\n                        </h3>\n                    </div>\n                    <div className=\"SRC-description\">{summary}</div>\n                </div>\n                <div className=\"SRC-cardAction\">\n                    <button onClick={this.handleLinkClick(softwareLink)} type=\"button\">\n                        Open Tool\n                    </button>\n                </div>\n            </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport ampIconHeaderSvg from '../../../assets/icons/AMP_AD/consortia-icons/amp-icon-header.svg'\nimport ampIconSvg from '../../../assets/icons/AMP_AD/consortia-icons/amp-icon.svg'\nimport moveIconHeaderSvg from '../../../assets/icons/AMP_AD/consortia-icons/move-icon-header.svg'\nimport moveIconSvg from '../../../assets/icons/AMP_AD/consortia-icons/move-icon.svg'\nimport ModelADIconHeaderSvg from '../../../assets/icons/AMP_AD/consortia-icons/ModelAD-icon-header.svg'\nimport ModelADIconSvg from '../../../assets/icons/AMP_AD/consortia-icons/ModelAD-icon.svg'\nimport resilienceIconHeaderSvg from '../../../assets/icons/AMP_AD/consortia-icons/resilience-icon-header.svg'\nimport resilienceIconSvg from '../../../assets/icons/AMP_AD/consortia-icons/resilience-icon.svg'\n\ntype ConsortiumProps = {\n  isHeader?: boolean\n  data?: any\n  schema?: any\n  secondaryLabelLimit?: number\n}\n\nexport default class Consortium extends React.Component<ConsortiumProps, {}> {\n\n  constructor(props: ConsortiumProps) {\n    super(props)\n    this.getIcon = this.getIcon.bind(this)\n  }\n\n  public getIcon(org: string, isHeader: boolean) {\n    // This CAN NOT be refactored below -- dynamic imports are currently not supported\n    // in es6, so the code below already has static references to the files below\n    // even though its baked into if else clauses.\n    const ampIconDescription = \"amp-ad icon\"\n    const moveIconDescription = \"M2OVE icon\"\n    const modelIconDescription = \"Model icon\"\n    const resillienceIconDescription = \"Resillience icon\"\n    switch (org) {\n      case 'AMP-AD':\n        if (isHeader) {\n          return <img alt={ampIconDescription} src={ampIconHeaderSvg}/>\n        }\n        return <img alt={ampIconDescription} src={ampIconSvg}/>\n      case 'M2OVE-AD':\n        if (isHeader) {\n          return <img alt={moveIconDescription} src={moveIconHeaderSvg}/>\n        }\n        return <img alt={moveIconDescription} src={moveIconSvg}/>\n      case 'MODEL-AD':\n        if  (isHeader) {\n          return <img alt={modelIconDescription} src={ModelADIconHeaderSvg}/>\n        }\n        return <img alt={modelIconDescription} src={ModelADIconSvg}/>\n      case 'Resilience-AD':\n        if (isHeader) {\n          return <img alt={resillienceIconDescription} src={resilienceIconHeaderSvg}/>\n        }\n        return <img alt={resillienceIconDescription} src={resilienceIconSvg}/>\n      default:\n        return (false)\n    }\n  }\n\n  public render() {\n    const { data, schema } = this.props\n\n    const description = data[schema['Short Description']]\n    const name = data[schema['Full Name']]\n    const org = data[schema.Program]\n\n    const path = data[schema.Path]\n    const orgPath = `${window.location.origin}/#${path}`\n\n    const isOnOrgPath = window.location.hash.substring(1) === path\n\n    return (\n      <div\n          style={{ paddingBottom: '32px' }}\n          className=\"SRC-portalCard SRC-typeStudy  \"\n      >\n        <div className=\"SRC-cardThumbnail\">\n          {this.getIcon(org, isOnOrgPath)}\n        </div>\n        <div className=\"SRC-cardContent\">\n          <div className=\"SRC-type\">Program</div>\n          <div >\n            <h3>\n                {!isOnOrgPath && <a target=\"_blank\" rel=\"noopener noreferrer\" href={orgPath}> {name} </a>}\n                {isOnOrgPath && name}\n            </h3>\n          </div>\n          <span className=\"SRC-font-size-base\">\n              {description}\n          </span>\n        </div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { UserProfile } from '../utils/jsonResponses/UserProfile'\nimport UserCard, { UserCardSize } from './UserCard'\nimport { MEDIUM_USER_CARD } from '../utils/SynapseConstants'\nimport { getUserProfileWithProfilePicAttached } from './getUserData'\nimport { UserProfileList } from '../utils/SynapseClient'\nimport { QueryResultBundle } from '../utils/jsonResponses/Table/QueryResultBundle'\n\nexport type UserCardListProps = {\n  list: string []\n  size?: UserCardSize\n  // Data should not be needed, however, it gives the option to fill in a user profile with other column\n  // fields. This is required specifically by AMP-AD Explore/People page\n  data?: QueryResultBundle\n}\n\ntype MapOwnerIdToUserProfile = {\n  [index: number]: UserProfile\n}\nexport type UserCardListState = {\n  userProfileMap: MapOwnerIdToUserProfile\n}\nexport default class UserCardList extends React.Component<UserCardListProps, UserCardListState> {\n\n  constructor(props: UserCardListProps) {\n    super(props)\n    this.state = {\n      userProfileMap: {}\n    }\n    this.update = this.update.bind(this)\n  }\n\n  componentDidMount() {\n    const { list } = this.props\n    this.update(list)\n  }\n\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set#Implementing_basic_set_operations\n  difference(setA: Set<String>, setB: Set<String>) {\n    const _difference = new Set(setA)\n    for (const elem of Array.from(setB)) {\n      _difference.delete(elem)\n    }\n    return _difference\n  }\n\n  componentDidUpdate(prevProps: UserCardListProps) {\n    // Note - Set object not fully supported by IE11, additionally there are a few caveats to using the Set object\n    // described here https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set\n    // the use below with primitives is well defined.\n    const priorListOfIds = new Set(prevProps.list)\n    const curListOfIds = new Set(this.props.list.filter(el => el))\n    // check that the props have changed by seeing that at least one element is different\n    if (this.difference(curListOfIds, priorListOfIds).size > 0) {\n      const internalData = new Set(Object.keys(this.state.userProfileMap))\n      // get the set difference between the current list and whats stored in state, describes what\n      // needs to get looked up.\n      const difference = Array.from(this.difference(curListOfIds, internalData)) as string []\n      if (difference.length > 0) {\n        this.update(difference)\n      }\n    }\n  }\n\n  update (list: string []) {\n    getUserProfileWithProfilePicAttached(list.filter(el => el)).then(\n      (data: UserProfileList) => {\n        const newEntries = {}\n        data.list.forEach(\n          (el) => {\n            const { ownerId } = el\n            newEntries[ownerId] = el\n          }\n        )\n        this.setState({\n          userProfileMap: { ...this.state.userProfileMap, ...newEntries }\n        })\n      }\n    ).catch(\n      (err: string) => {\n        console.log('Error on batch call =', err)\n      }\n    )\n  }\n\n  /**\n   * Given data this will find rows where there is no userId columnType and create faux user profiles\n   * using firstName, lastName, and instituion (company in UserProfile object).\n   * @param {QueryResultBundle} data\n   * @returns list of UserProfiles with firstName, lastName, company, userName (first letter of firstName) filled out.\n   * @memberof UserCardList\n   */\n  manuallyExtractData(data: QueryResultBundle) {\n    const firstNameIndex = data.queryResult.queryResults.headers.findIndex(el => el.name === 'firstName')\n    const lastNameIndex = data.queryResult.queryResults.headers.findIndex(el => el.name === 'lastName')\n    const institutionIndex = data.queryResult.queryResults.headers.findIndex(el => el.name === 'institution')\n    const ownerId = data.queryResult.queryResults.headers.findIndex(el => el.columnType === 'USERID')\n    const nullOwnerIdsRows = data.queryResult.queryResults.rows.filter(el => !el.values[ownerId])\n    return nullOwnerIdsRows.map<UserProfile>(\n      (el) => {\n        const values = el.values\n        return {\n          firstName: values[firstNameIndex],\n          lastName: values[lastNameIndex],\n          company: values[institutionIndex],\n          ownerId: '',\n          userName: values[firstNameIndex][0]\n        }\n      }\n    )\n  }\n\n  render() {\n    const { size = MEDIUM_USER_CARD, data, list } = this.props\n    const { userProfileMap = {} } = this.state\n    const fauxUserProfilesList = data && this.manuallyExtractData(data)\n    let fauxUserProfileIndex = 0\n    return (\n      <div className=\"SRC-card-grid-row SRC-adjust-for-bootstrap-margin\">\n        {\n          // we loop through the list from the props because thats the 'active set of data' whereas the data stored in state could be stale\n          list.map(\n            (ownerId) => {\n              const userProfile = userProfileMap[ownerId]\n              if (userProfile) {\n                return (\n                  <div key={JSON.stringify(userProfile)} className=\"SRC-grid-item SRC-narrow-grid-item\">\n                    <UserCard size={size} preSignedURL={userProfile.clientPreSignedURL} userProfile={userProfile}/>\n                  </div>\n                )\n              }\n              const fauxUserProfile = fauxUserProfilesList && fauxUserProfilesList[fauxUserProfileIndex]\n              if (!fauxUserProfile) {\n                // This could happen in one of two cases:\n                // - The props just updated with a new userlist where the data is being gathered for this particular user\n                //   OR there is no mapping for this user\n                return false\n              }\n              fauxUserProfileIndex += 1\n              return (\n                <div key={JSON.stringify(fauxUserProfile)} className=\"SRC-grid-item SRC-narrow-grid-item\">\n                  <UserCard\n                    disableLink={true}\n                    hideEmail={true}\n                    size={size}\n                    userProfile={fauxUserProfile}\n                  />\n                </div>\n              )\n            }\n          )\n        }\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { QueryBundleRequest } from '../utils/jsonResponses/Table/QueryBundleRequest'\nimport { QueryResultBundle } from '../utils/jsonResponses/Table/QueryResultBundle'\nimport {\n  AMP_CONSORTIUM,\n  DATASET,\n  FUNDER,\n  PUBLICATION,\n  STUDY,\n  TOOL,\n  GENERIC_CARD,\n  MEDIUM_USER_CARD\n} from '../utils/SynapseConstants'\nimport { Dataset, Funder, Publication, Study, Tool } from './row_renderers'\nimport { Consortium } from './row_renderers/AMPAD'\nimport GenericCard from './GenericCard'\nimport UserCardList from './UserCardList'\nimport TotalQueryResults from './TotalQueryResults'\nimport { CommonCardProps } from './CardContainerLogic'\n\nconst PAGE_SIZE: number = 25\n\nexport type CardContainerProps = {\n  data?: QueryResultBundle,\n  limit?: number,\n  isHeader?: boolean\n  title?: string\n  facetAliases?: {}\n  getLastQueryRequest?: () => QueryBundleRequest\n  getNextPageOfData?: (queryRequest: QueryBundleRequest) => void\n  isLoading?: boolean\n  facet?: string\n  unitDescription?: string\n  hasMoreData?: boolean\n  loadingScreen?: React.FunctionComponent | JSX.Element\n  backgroundColor?: string\n  showBarChart?: boolean\n} & CommonCardProps\n\ntype CardContainerState = {\n  cardLimit: number\n}\n\nexport class CardContainer extends React.Component<CardContainerProps, CardContainerState> {\n\n  constructor(props: CardContainerProps) {\n    super(props)\n    this.handleViewMore = this.handleViewMore.bind(this)\n  }\n\n  /**\n   * Handle a click on next or previous\n   *\n   * @memberof SynapseTable\n   */\n  public handleViewMore() {\n    const queryRequest = this.props.getLastQueryRequest!()\n    let offset = queryRequest.query.offset!\n    // paginate forward\n    offset += PAGE_SIZE\n    queryRequest.query.offset = offset\n    this.props.getNextPageOfData!(queryRequest)\n  }\n\n  public renderCard = (props: any, type: string) => {\n    switch (type) {\n      case STUDY:\n        return <Study {...props} />\n      case DATASET:\n        return <Dataset {...props} />\n      case FUNDER:\n        return <Funder {...props} />\n      case PUBLICATION:\n        return <Publication {...props} />\n      case TOOL:\n        return <Tool {...props} />\n      case AMP_CONSORTIUM:\n        return <Consortium {...props} />\n      case GENERIC_CARD:\n        return <GenericCard {...props} />\n      default:\n        return (<div />) // this should never happen\n    }\n  }\n  public render() {\n    const {\n      data,\n      limit = Infinity,\n      isHeader = false,\n      facet,\n      unitDescription,\n      type,\n      isLoading,\n      loadingScreen,\n      secondaryLabelLimit = 3,\n      showBarChart = true,\n      title,\n      ...rest\n    } = this.props\n    // the cards only show the loading screen on initial load, this occurs when data is undefined\n    if (!data) {\n      return (\n        <div>\n          {isLoading && loadingScreen}\n        </div>\n      )\n    } else if (data && data.queryResult.queryResults.rows.length === 0) {\n      // data was retrieved from the backend but there is none to show, we return a empty fragment\n      // there could be a more informed UX decision here but the current use case right now\n      // should display nothing\n      return <React.Fragment/>\n    }\n    const schema = {}\n    data.queryResult.queryResults.headers.forEach(\n      (element, index) => {\n        schema[element.name] = index\n      })\n\n    // We want to hide the view more button if:\n    //   1. The data fed in has !== PAGE_SIZE number of results\n    //   2. The hasMoreData prop is false\n    //   3. The limit is set to less than PAGE_SIZE\n    // below we show the view more button by following the opposite logic from above.\n    let showViewMore: boolean = limit >= PAGE_SIZE && data.queryResult.queryResults.rows.length >= PAGE_SIZE\n    showViewMore = showViewMore && this.props.hasMoreData!\n\n    const showViewMoreButton = (\n      showViewMore\n      &&\n      (\n        <div>\n          <button\n            onClick={this.handleViewMore}\n            className=\"pull-right SRC-standard-button-shape SRC-light-button\"\n          >\n            View More\n          </button>\n        </div>\n      )\n    )\n    let cards\n    if (type === MEDIUM_USER_CARD) {\n      // Hard coding ownerId as a column name containing the user profile ownerId\n      // for each row, grab the column with the ownerId\n      const userIdColumnIndex = data.queryResult.queryResults.headers.findIndex(\n        el => el.columnType === 'USERID'\n      )\n      if (userIdColumnIndex === -1) {\n        throw Error('Type MEDIUM_USER_CARD specified but no columnType USERID found')\n      }\n      const listIds = data.queryResult.queryResults.rows.map(el => el.values[userIdColumnIndex])\n      cards = <UserCardList data={data} list={listIds} size={MEDIUM_USER_CARD}/>\n    } else {\n      // render the cards\n      cards = data.queryResult.queryResults.rows.map(\n        (rowData: any, index) => {\n          if (index < limit) {\n            const key = JSON.stringify(rowData.values)\n            const propsForCard = {\n              key,\n              type,\n              schema,\n              isHeader,\n              secondaryLabelLimit,\n              data: rowData.values,\n              ...rest\n            }\n            return this.renderCard(propsForCard, type)\n          }\n          return false\n        }\n      )\n    }\n\n    return (\n      <div>\n        {title &&  <h2 className=\"SRC-card-overview-title\">{title}</h2>}\n        {(!title && unitDescription && showBarChart) &&\n          <TotalQueryResults\n            data={data}\n            facet={facet!}\n            isLoading={isLoading!}\n            unitDescription={unitDescription}\n            frontText={'Displaying'}\n          />\n        }\n        {/* ReactCSSTransitionGroup adds css fade in property for cards that come into view */}\n        {cards}\n        {showViewMoreButton}\n      </div>\n    )\n  }\n}\n\nexport default CardContainer\n","import * as React from 'react'\nimport { QueryWrapperChildProps } from './QueryWrapper'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { \n  faCaretDown,\n  faCaretUp,\n  faSearch\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { insertConditionsFromSearchParams } from '../utils/modules/sqlFunctions'\nimport TotalQueryResults from './TotalQueryResults'\nimport getColorPallette from './ColorGradient'\nimport { SEARCH_CLASS_CSS } from './QueryWrapperMenu'\n\nlibrary.add(faCaretDown)\nlibrary.add(faCaretUp)\nlibrary.add(faSearch)\n\ntype SearchState = {\n  dropdownIndex: number\n  isSearchableDropdownOpen: boolean\n  searchText: string\n  submittedSearchText: string\n}\nexport type Searchable = {\n  columnName: string\n  hintText: string\n} []\n\nexport type SearchProps = {\n  searchable: Searchable\n  isQueryWrapperMenuChild?: boolean\n}\n\ntype InternalSearchProps = QueryWrapperChildProps & SearchProps\n\nclass Search extends React.Component<InternalSearchProps, SearchState> {\n\n  constructor(props: InternalSearchProps) {\n    super(props)\n    this.state = {\n      dropdownIndex: 0,\n      isSearchableDropdownOpen: false,\n      searchText: '',\n      submittedSearchText: ''\n    }\n  }\n\n  componentDidUpdate(prevProps: InternalSearchProps) {\n    if (this.props.isLoading === false && prevProps.isLoading === true) {\n      // highlighting will sometimes outpace the render method for react, adding the slight delay \n      // mitigates this\n      setTimeout(\n        this.highlightText,\n        100\n      )\n    }\n  }\n\n  public toggleDropdown = (value: boolean) => (_: React.SyntheticEvent) => {\n    this.setState({\n      isSearchableDropdownOpen: value\n    })\n  }\n\n  public setDropdownIndex = (index: number) => (_: React.SyntheticEvent) => {\n    this.setState({\n      dropdownIndex: index,\n      isSearchableDropdownOpen: false\n    })\n  }\n\n  public highlightText = () => {\n     const { submittedSearchText, dropdownIndex } = this.state\n     const { searchable, rgbIndex, facetAliases = {}, isQueryWrapperMenuChild = true} = this.props\n     const { colorPalette } = getColorPallette(rgbIndex!, 1)\n     const originalColor = colorPalette[0]\n     const searchItem = searchable[dropdownIndex]\n\n     const highlightedSpans = document.querySelectorAll<HTMLSpanElement>('.highlight')\n     highlightedSpans.forEach(\n       (span) => {\n          span.outerHTML = span.innerText\n        }\n    )\n    if (submittedSearchText) {\n      const searchItemView = facetAliases[searchItem.columnName] || searchItem.columnName\n      const frontText = isQueryWrapperMenuChild ? `.${SEARCH_CLASS_CSS} `: ''\n      const querySelector =  frontText + `[data-search-handle=\"${searchItemView}\"]`\n      const trs = document.querySelectorAll<HTMLElement>(querySelector)\n      // Target elements and apply styles\n      trs.forEach(\n        (textElement) => {\n          if (textElement.innerHTML !== null) {\n            const regex = new RegExp(submittedSearchText, \"gi\")\n            const match = textElement.innerText.match(regex)\n            if (match) {\n              // innerHTML contains only text\n              textElement.innerHTML = textElement.innerHTML.replace(regex, (match) => {\n                return `<span style=\"background: ${originalColor}; color: white;\" class=\"highlight\">${match}</span>`\n              })\n            }\n          }\n        }\n      )\n    }\n  }\n\n  public static addEscapeCharacters = (searchText: string) => {\n    // We have to escape the following characters\n    // ' % \\\n    let escapedSearchText = searchText\n    // escape ' by adding additional '\n    escapedSearchText = escapedSearchText.split(\"'\").join(\"''\")\n    // escape % by adding \\\n    // eslint-disable-next-line no-useless-escape\n    escapedSearchText = escapedSearchText.split(\"%\").join(\"\\%\")\n    // escape \\ by adding \\\n    escapedSearchText = escapedSearchText.split(\"\\\\\").join(\"\\\\\\\\\")\n    return escapedSearchText\n  }\n\n  public search = (event: React.SyntheticEvent<HTMLFormElement>) => {\n    // form completion by default causes the page to reload, so we prevent that\n    event.preventDefault()\n    const { searchText, dropdownIndex } = this.state\n\n    const { searchable } = this.props\n    const searchItem = searchable[dropdownIndex]\n    // Always grabs initQueryRequest so that it doesn't build a chain of \n    // LIKE clauses\n    const lastQueryRequestDeepCopy = this.props.getInitQueryRequest!()\n    let { sql } = lastQueryRequestDeepCopy.query\n    const searchParams = {\n      [searchItem.columnName]: Search.addEscapeCharacters(searchText)\n    }\n    const newSql = insertConditionsFromSearchParams(searchParams, sql)\n    lastQueryRequestDeepCopy.query.sql = newSql\n    this.setState({\n      submittedSearchText: searchText\n    })\n    this.props.executeQueryRequest!(lastQueryRequestDeepCopy)\n  }\n\n  public handleChange = (event: React.FormEvent<HTMLInputElement>) => {\n   this.setState({\n     searchText: event.currentTarget.value\n   }) \n  }\n\n  render() {\n    const { searchable, data, isLoading, facet, unitDescription = '', facetAliases = {} } = this.props\n    const { isSearchableDropdownOpen, dropdownIndex, searchText, submittedSearchText } = this.state\n    const searchableItem = searchable[dropdownIndex]\n    const containerStyle: React.CSSProperties = {\n      background: '#F9F9F9',\n      height: '80px',\n      display: 'flex',\n      marginTop: 10,\n      alignItems: 'center',\n      padding: '0px 10px',\n    }\n    const fieldStyle: React.CSSProperties = {\n      background: '#FFFFFF',\n      border: '1px solid #DCDCDC',\n      margin: '0px 10px',\n      height: '51px',\n      display: 'inline-flex',\n      alignItems: 'center',\n    }\n    const ulStyle: React.CSSProperties = {\n      width: 'inherit',\n      left: -10,\n      paddingBottom: 0,\n      paddingTop: 0\n    }\n    const liStyle: React.CSSProperties = {\n      paddingLeft: '10px'\n    }\n    const caretIconStyle: React.CSSProperties = {\n      fontSize: '16px',\n      marginRight: 8\n    }\n    const labelStyle: React.CSSProperties = {\n      display: 'inline-block', whiteSpace: 'nowrap'\n    }\n    const searchIconStyle: React.CSSProperties = {\n      color: '#C4C4C4',\n      position:'absolute',\n      right: 50,\n      fontSize: 16\n    }\n    const inputStyle: React.CSSProperties = {\n      border: 1,\n      margin: 1,\n      paddingLeft: 10,\n      height: 49\n    }\n    const dropdownBtnStyle: React.CSSProperties = { \n      justifyContent: 'space-between'\n    }\n    const totalQueryResultsStyle: React.CSSProperties = {\n      margin: '20px 0px'\n    }\n    const curFacetDisplayText = facetAliases[searchableItem.columnName] || searchableItem.columnName\n    let usedUnitDescription = unitDescription\n    if (submittedSearchText !== '') {\n      usedUnitDescription = `${unitDescription} containing \"${submittedSearchText}\" in ${curFacetDisplayText}`\n    }\n    return (\n      <div>\n        <div style={containerStyle}>\n          {isSearchableDropdownOpen && <button onClick={this.toggleDropdown(false)} className={'SRC-menu-wall'} />}\n          <div className=\"SRC-centerContent SRC-fullWidth\">\n            <span style={labelStyle}> Search in </span>\n            <div style={{...fieldStyle, flex: 1, paddingLeft: 10}}>\n              <div id=\"search-dropdown\" className=\"SRC-inherit-height SRC-fullWidth\">\n                <div className=\"SRC-centerContent SRC-inherit-height\">\n                  <button style={dropdownBtnStyle} className=\"SRC-inlineFlex SRC-fullWidth\" onClick={this.toggleDropdown(!isSearchableDropdownOpen)}>\n                    { curFacetDisplayText }\n                    <FontAwesomeIcon style={caretIconStyle} icon={isSearchableDropdownOpen ? 'caret-up' : 'caret-down'} />\n                  </button>\n                </div>\n                <div className={'dropdown ' + (isSearchableDropdownOpen? 'open' : '')}>\n                  <ul aria-labelledby=\"search-dropdown\" style={ulStyle} className=\"SRC-search-dropdown dropdown-menu SRC-forceLeftDropdown dropdown-menu-left\">\n                    {\n                      searchable.map(\n                        (el, index) => {\n                          const displayName = facetAliases[el.columnName] || el.columnName\n                          return (\n                            <li \n                              style={liStyle}\n                              onClick={this.setDropdownIndex(index)}\n                              key={displayName}\n                              className=\"SRC-hand-cursor SRC-primary-background-color-hover\"\n                            >\n                              {displayName }\n                            </li>\n                          )\n                        }\n                      )\n                    }\n                  </ul>\n                </div>\n              </div>\n            </div>\n            <form style={{...fieldStyle, flex: 3, alignItems: 'center'}} onSubmit={this.search}>\n              <input\n                placeholder={`e.g. \"${searchableItem.hintText}\"`} \n                style={inputStyle}\n                onChange={this.handleChange}\n                value={searchText}\n                type=\"text\"\n                className=\"SRC-fullWidth\"\n              />\n              <FontAwesomeIcon size={'sm'} style={searchIconStyle} icon={'search'} />\n            </form>\n          </div>\n        </div>\n        <TotalQueryResults\n          style={totalQueryResultsStyle}\n          isLoading={isLoading!}\n          data={data}\n          facet={facet!}\n          frontText={'Displaying'}\n          unitDescription={usedUnitDescription}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Search","import { CSSTransition, TransitionGroup } from 'react-transition-group'\nimport * as React from 'react'\nimport { SynapseConstants } from '../utils/'\nimport { getColorPallette } from './ColorGradient'\nimport { Facets } from './Facets'\nimport QueryCount from './QueryCount'\nimport QueryWrapper from './QueryWrapper'\nimport StackedBarChart from './StackedBarChart'\nimport SynapseTable, { SynapseTableProps } from './SynapseTable'\nimport CardContainer from './CardContainer'\nimport { CommonCardProps } from './CardContainerLogic'\nimport { StackedBarChartProps } from './StackedBarChart'\nimport { KeyValue, isGroupByInSql } from '../utils/modules/sqlFunctions'\nimport { FacetColumnValuesRequest } from '../utils/jsonResponses/Table/FacetColumnRequest'\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus, faSearch } from '@fortawesome/free-solid-svg-icons'\nimport Search, { SearchProps } from './Search'\n\nlibrary.add(faPlus)\nlibrary.add(faSearch)\n\ntype MenuState = {\n  activeMenuIndices: number []\n  accordionGroupIndex: number,\n}\n\nexport type MenuConfig = {\n  sql: string\n  facet?: string\n}\n\n// represents the entirety of the menu\nexport const MENU_DROPDOWN_CSS = 'SRC-menuLayout'\n// represent an accordiong 'group' within the menu\nexport const ACCORDION_GROUP_CSS = 'SRC-accordion-key'\n// represents the single accordiong group which is active within the menu\nexport const ACCORDION_GROUP_ACTIVE_CSS = 'SRC-IS-ACTIVE'\n// for search component querying on cardcontainer\nexport const SEARCH_CLASS_CSS = 'SRC-search-component'\n\ninterface MenuSearchParams extends KeyValue {\n  menuIndex: string\n  facetValue: string\n}\n\ntype CommonMenuProps = {\n  tableConfiguration?: SynapseTableProps\n  cardConfiguration?: CommonCardProps\n  stackedBarChartConfiguration?: StackedBarChartProps\n  searchConfiguration?: SearchProps\n  showBarChart?: boolean\n  unitDescription?: string\n}\n\ntype AccordionConfig = {\n  searchConfiguration?: SearchProps\n  menuConfig: MenuConfig []\n  name: string\n} & CommonMenuProps\n\nexport type QueryWrapperMenuProps = {\n  facetAliases?: {}\n  menuConfig?: MenuConfig []\n  accordionConfig?: AccordionConfig []\n  isConsistent?: boolean\n  token?: string\n  rgbIndex: number\n  searchParams?: MenuSearchParams\n  name?: string\n} & CommonMenuProps\n\ntype Info = {\n  isSelected: boolean\n  originalColor: string\n  hoverWhiteTextClass?: string\n}\n\nexport default class QueryWrapperMenu extends React.Component<QueryWrapperMenuProps, MenuState> {\n\n  constructor(props: QueryWrapperMenuProps) {\n    super(props)\n    // See note about initializing props from state here\n    //  - https://stackoverflow.com/questions/40063468/react-component-initialize-state-from-props/47341539#47341539\n    const { searchParams, accordionConfig } = this.props\n    let activeMenuIndices = []\n    const indexFromURLOrDefaultZero = (searchParams && Number(searchParams.menuIndex)) || 0\n    if (accordionConfig) {\n      activeMenuIndices = new Array(accordionConfig.length).fill(0)\n    } else {\n      activeMenuIndices = [indexFromURLOrDefaultZero]\n    }\n    this.state = {\n      activeMenuIndices,\n      accordionGroupIndex: 0\n    }\n    this.handleHoverLogic = this.handleHoverLogic.bind(this)\n    this.switchFacet = this.switchFacet.bind(this)\n    this.getUnitDescription = this.getUnitDescription.bind(this)\n    this.getPartMask = this.getPartMask.bind(this)\n    this.getSelectedFacets = this.getSelectedFacets.bind(this)\n    this.getTableLoadingScreen = this.getTableLoadingScreen.bind(this)\n  }\n\n  componentDidUpdate(prevProps: QueryWrapperMenuProps, _prevState: MenuState) {\n    /*\n      Update the row count or the menu index if the props changed by looking at whether the sql or the rgbIndex\n      changed\n    */\n    let { activeMenuIndices } = this.state\n    const { rgbIndex, accordionConfig } = this.props\n    if (rgbIndex !== prevProps.rgbIndex) {\n      activeMenuIndices = accordionConfig ? new Array(accordionConfig.length).fill(0): [0] \n      this.setState({\n        activeMenuIndices,\n        accordionGroupIndex: 0,\n      })\n    }\n  }\n\n  /**\n   * Handle the user hovering over a facet selection, it must be programatically\n   * handled because the color used is dynamic\n   *\n   * @memberof Menu\n   */\n  public handleHoverLogic = (info: Info) => (event: React.MouseEvent<HTMLDivElement>) => {\n    // This prevents a bug where there is both light text and a light background,\n    // otherwise SRC-hoverWhiteText would be placed on the group and item keys statically\n    if (!event.currentTarget.classList.contains('SRC-hoverWhiteText')) {\n      event.currentTarget.classList.add('SRC-hoverWhiteText')\n    }\n    if (!info.isSelected && event.currentTarget.tagName === 'DIV') {\n      event.currentTarget.style.backgroundColor = info.originalColor\n    }\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public switchFacet = (menuIndexIn: number, accordionIndexIn: number) => (_: React.SyntheticEvent<HTMLDivElement>) => {\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    // there's an odd bug where clicking a menu item twice will select the first tab,\n    // this is a fix for that, but this shouldn't be necessary\n    const isClickingCurrentSelection = accordionGroupIndex === accordionIndexIn && activeMenuIndices[accordionIndexIn] === menuIndexIn\n    activeMenuIndices[accordionIndexIn] = menuIndexIn\n    if (!isClickingCurrentSelection) {\n      this.setState({ activeMenuIndices, accordionGroupIndex: accordionIndexIn })\n    }\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public toggleGroupAccordionIndex = (accordionGroupIndexIn: number) => (_event: React.SyntheticEvent<HTMLDivElement>) => {\n    const { accordionGroupIndex } = this.state\n    if (accordionGroupIndex === accordionGroupIndexIn) {\n      return\n    } else {\n      this.setState({\n        accordionGroupIndex: accordionGroupIndexIn\n      })\n    }\n  }\n\n  public render() {\n    const { stackedBarChartConfiguration, name, menuConfig, token, accordionConfig } = this.props\n    const { activeMenuIndices } = this.state\n    let sql = ''\n    if (menuConfig) {\n      sql = menuConfig[activeMenuIndices[0]].sql\n    }\n    const hasGroupByInSql = isGroupByInSql(sql)\n    const menuDropdown = this.renderMenuDropdown()\n    const queryWrapper = this.renderQueryChildren()\n    const showBarChart = stackedBarChartConfiguration !== undefined\n    return (\n      <React.Fragment>\n        {\n          name && sql && !hasGroupByInSql\n          &&\n          <h3 id=\"exploreCount\" className=\"SRC-boldText\">\n            <QueryCount token={token} name={name} sql={sql} />\n          </h3>\n        }\n        {\n          (hasGroupByInSql || accordionConfig)\n          &&\n          <h3 id=\"exploreCount\" className=\"SRC-boldText\">\n            {name}\n          </h3>\n        }\n        <div className=\"break\">\n          <hr/>\n        </div>\n        <div className=\"row\">\n          <div className={`col-xs-12 col-sm-3 col-lg-2 SRC-menuLayout ${showBarChart ? 'SRC-menuPadding' : 'SRC-menuPaddingLess'}`}>\n            {menuDropdown}\n          </div>\n          <div className=\"col-xs-12 col-sm-9 col-lg-10\">\n            {queryWrapper}\n          </div>\n        </div>\n      </React.Fragment>\n    )\n  }\n\n  private renderQueryChild(menuConfig: MenuConfig [], queryConfig: CommonMenuProps, groupIndex: number)  {\n    const {\n      token,\n      rgbIndex = 0,\n      isConsistent = false,\n      searchParams,\n      accordionConfig = [],\n      facetAliases = {}\n    } = this.props\n    const {\n      cardConfiguration,\n      tableConfiguration,\n      stackedBarChartConfiguration,\n      unitDescription = '',\n      searchConfiguration\n    } = queryConfig\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    let facetValue = ''\n    let menuIndexFromProps = ''\n    if (searchParams) {\n      ({ facetValue = '', menuIndex: menuIndexFromProps } = searchParams)\n    }\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const isSelected: boolean = groupIndex === accordionGroupIndex && activeMenuIndices[accordionGroupIndex] === index\n      const {\n        facet,\n        sql,\n      } = config\n      const name = accordionConfig[groupIndex] && accordionConfig[groupIndex].name\n      const hasGroupByInSql = isGroupByInSql(sql)\n      // only show search component if its the last item in the menu config\n      const showSearch = index === menuConfig.length - 1 && searchConfiguration !== undefined\n      const showBarChart = stackedBarChartConfiguration !== undefined && !showSearch && !hasGroupByInSql\n      const aliasedFacet: string = facet && (facetAliases[facet] || facet)\n\n      // search class is only used for testing, no css is actually applied\n      let searchClass = showSearch ? SEARCH_CLASS_CSS : ''\n      if (!isSelected) {\n        searchClass = 'SRC-hidden'\n      }\n\n      // Get props for query wrapper\n      const usedUnitDescription = this.getUnitDescription(unitDescription, aliasedFacet, showSearch, accordionConfig.length > 0, name)\n      const selectedFacets = this.getSelectedFacets(Number(menuIndexFromProps) === index, facet, facetValue)\n      const partMask = this.getPartMask(facet, hasGroupByInSql)\n      const tableLoadingScreen = this.getTableLoadingScreen(hasGroupByInSql, stackedBarChartConfiguration, tableConfiguration)\n\n      return (\n        <span key={facet} className={searchClass}>\n          <QueryWrapper\n            showBarChart={showBarChart}\n            loadNow={isSelected}\n            showMenu={true}\n            initQueryRequest={{\n              partMask,\n              concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n              query: {\n                sql,\n                selectedFacets,\n                isConsistent,\n                limit: 25,\n                offset: 0\n              }\n            }}\n            unitDescription={usedUnitDescription}\n            facet={facet}\n            token={token}\n            rgbIndex={rgbIndex}\n            facetAliases={facetAliases}\n          >\n            {showBarChart ? <StackedBarChart {...stackedBarChartConfiguration!} /> : <React.Fragment/>}\n            {!showSearch ? <Facets />:  <React.Fragment/>}\n            {showSearch ? <Search searchable={searchConfiguration!.searchable}/> : <React.Fragment/>}\n            {/*\n                Using a conditional render fails here because QueryWrapper can't clone an undefined element\n                which will happen if either configuration is undefined.\n            */}\n            {tableConfiguration ? <SynapseTable {...{...tableConfiguration, loadingScreen: tableLoadingScreen }}/> : <React.Fragment/>}\n            {cardConfiguration ? <CardContainer {...cardConfiguration}/> : <React.Fragment/>}\n          </QueryWrapper>\n        </span>\n      )\n      }\n    )\n  }\n\n  public getUnitDescription (unitDescription: string, aliasedFacet: string, showSearch: boolean, isAccordionConfigDefined: boolean, name: string ) {\n    if (isAccordionConfigDefined && !showSearch) {\n      return `${name} Tools by ${aliasedFacet}`\n    }\n    if (isAccordionConfigDefined && showSearch) {\n      // This is also a hardcoded setting to detect if search within a tools accordion is being shown\n      return `${name} Tools`\n    }\n    return unitDescription\n  }\n\n  public getPartMask (facet: string | undefined, hasGroupByInSql: boolean) {\n    let partMask = SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS | SynapseConstants.BUNDLE_MASK_QUERY_RESULTS;\n    if (facet) {\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_FACETS\n    } else {\n      // Needed to calculate the total count for TotalQueryResults\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_COUNT\n    }\n    if (hasGroupByInSql) {\n      // necessary for creating the where clause in the synapse table link, columnModels distinguishes non aggregate functions\n      // from select columns\n      partMask = partMask | SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS\n    }\n    return partMask\n  }\n\n  public getSelectedFacets (isSelected: boolean, facet: string | undefined, facetValue: string | undefined): FacetColumnValuesRequest [] {\n    if (isSelected && facet && facetValue) {\n      return [\n        {\n          concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',\n          facetValues: [facetValue],\n          columnName: facet\n        }\n      ]\n    }\n    return []\n  }\n  \n  public getTableLoadingScreen (hasGroupByInSql: boolean, stackedBarChartConfiguration: StackedBarChartProps | undefined, tableConfiguration: SynapseTableProps | undefined): JSX.Element {\n    if (hasGroupByInSql && stackedBarChartConfiguration && tableConfiguration) {\n      // Since the bar chart doesnt show when theres a a groupy statement we use the \n      // loadingScreen from the chart configuration\n      return stackedBarChartConfiguration.loadingScreen\n    }\n    return <></>\n  }\n\n  private renderQueryChildren() {\n    const {\n      accordionConfig,\n      menuConfig,\n    } = this.props\n    const {\n      accordionGroupIndex,\n    } = this.state\n    if (accordionConfig) {\n      return accordionConfig.map(\n        (el, index) => {\n          return (\n            <div key={JSON.stringify(el)} className={accordionGroupIndex === index ? '' : 'SRC-hidden'}>\n              {this.renderQueryChild(el.menuConfig, el, index)}\n            </div>\n          )\n        }\n      )\n    } else {\n      return this.renderQueryChild(menuConfig!, this.props, 0)\n    }\n  }\n\n  private renderMenuDropdown() {\n    const { accordionConfig, menuConfig, searchConfiguration } = this.props\n    const { accordionGroupIndex } = this.state\n    const { rgbIndex } = this.props\n    const { colorPalette } = getColorPallette(rgbIndex, 5)\n    const lightColor = '#F5F5F5'\n    if (accordionConfig) {\n      return accordionConfig.map(\n        (el, index) => {\n          const isActive = accordionGroupIndex === index\n          const primaryColor = colorPalette[0]\n          let style: React.CSSProperties = {\n            background: isActive ? primaryColor : lightColor,\n            color: isActive ? 'white' : '',\n          }\n          let indicatorClasses = isActive ? 'SRC-whiteText SRC-pointed-triangle-down' : ' SRC-hand-cursor '\n          if (isActive) {\n            style.borderTopColor = primaryColor\n          }\n          const hoverEnter: Info = {\n            isSelected: isActive,\n            originalColor: primaryColor,\n          }\n          const hoverLeave: Info = {\n            isSelected: isActive,\n            originalColor: lightColor\n          }\n          const iconContainerStyle: React.CSSProperties = {\n            marginLeft: 5\n          }\n          const iconStyle: React.CSSProperties = {\n            fontSize: '0.55em'\n          }\n          return (\n            <div key={JSON.stringify(el)} className={isActive ? ACCORDION_GROUP_ACTIVE_CSS : ''}>\n              <div \n                style={style}\n                role={isActive ? \"\": \"button\"}\n                onMouseEnter={this.handleHoverLogic(hoverEnter)}\n                onMouseLeave={this.handleHoverLogic(hoverLeave)}\n                className={`${ACCORDION_GROUP_CSS} SRC-gap SRC-menu-button-base SRC-background-unset ${indicatorClasses}`}\n                onClick={!isActive ? this.toggleGroupAccordionIndex(index) : undefined }\n              >\n                {el.name}\n                <span style={iconContainerStyle}>\n                  {\n                    !isActive\n                    &&\n                    <FontAwesomeIcon style={iconStyle} color={primaryColor} icon={'plus'} />\n                  }\n                </span>\n              </div>\n              <TransitionGroup component={null}>\n                {\n                  isActive\n                  &&\n                  <CSSTransition\n                    // The component doesn't run a transition on mount, we override this\n                    // by setting appear to true because otherwise the triangle indicator wouldn't show\n                    appear={true}\n                    key={JSON.stringify(el)}\n                    classNames=\"SRC-accordion-menu\"\n                    timeout={{ enter: 1000, exit: 500 }}\n                  >\n                    <div className={\"SRC-accordion-menu\"}>\n                      {this.renderFacetMenu(el.menuConfig, index, el.searchConfiguration)}\n                    </div>\n                  </CSSTransition>\n                }\n              </TransitionGroup>\n            </div>\n          )\n        }\n      )\n    }\n    return this.renderFacetMenu(menuConfig!, 0, searchConfiguration)\n  }\n\n  private renderFacetMenu(menuConfig: MenuConfig [], curLevel: number, searchConfiguration?: SearchProps) {\n    const { rgbIndex, accordionConfig, facetAliases = {} } = this.props\n    const { activeMenuIndices, accordionGroupIndex } = this.state\n    const { colorPalette } = getColorPallette(rgbIndex, 5)\n    let originalColor = colorPalette[0]\n    let defaultColor = '#F5F5F5'\n    if (accordionConfig) {\n      originalColor = colorPalette[2]\n      defaultColor = colorPalette[4]\n    }\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      let searchIconStyle: React.CSSProperties = {\n        margin: 'auto 0',\n        opacity: 0.4\n      }\n      const { facet } = config\n      const isSelected: boolean = activeMenuIndices[accordionGroupIndex] === index && curLevel === accordionGroupIndex\n      const style: React.CSSProperties = {}\n      const isSearchConfig = (index === menuConfig.length -1 ) && searchConfiguration\n      let selectedStyling: string = ''\n      if (isSelected) {\n        // we have to programatically set the style since the color is chosen from a color\n        // wheel\n        style.background = originalColor\n        // below has to be set so the pseudo element created will inherit its color\n        // appropriately\n        style.borderLeftColor = originalColor\n        selectedStyling = 'SRC-pointed-triangle-right SRC-whiteText'\n        searchIconStyle.color = 'white'\n      } else {\n        // change background to class\n        selectedStyling = 'SRC-blackText'\n        style.background = defaultColor\n      }\n      const infoEnter: Info = { isSelected, originalColor }\n      const infoLeave: Info = { isSelected, originalColor: defaultColor }\n      const facetDisplayValue: string = facet && facetAliases[facet] || facet\n      return (\n        <div\n          onMouseEnter={this.handleHoverLogic(infoEnter)}\n          onMouseLeave={this.handleHoverLogic(infoLeave)}\n          key={config.facet}\n          className={`SRC-hand-cursor SRC-background-unset ${selectedStyling} SRC-menu-button-base SRC-gap`}\n          onClick={this.switchFacet(index, curLevel)}\n          onKeyPress={this.switchFacet(index, curLevel)}\n          role=\"button\"\n          tabIndex={0}\n          style={style}\n        >\n          {isSearchConfig ? \n            'Search'\n            :\n            facetDisplayValue\n          }\n          {\n            isSearchConfig &&\n            <span>\n              <FontAwesomeIcon className={selectedStyling} size={'sm'} style={searchIconStyle} icon=\"search\"/>\n            </span>\n          }\n        </div>\n      )\n    })\n  }\n\n}\n","import * as React from 'react'\nimport { FileEntity } from '../utils/jsonResponses/FileEntity'\nimport { uploadFile, createEntity, updateEntity, lookupChildEntity, getEntity } from '../utils/SynapseClient'\nimport { FileUploadComplete } from '../utils/jsonResponses/FileUploadComplete'\nimport { EntityId } from '../utils/jsonResponses/EntityId'\nimport { EntityLookupRequest } from '../utils/jsonResponses/EntityLookupRequest'\n\ntype UploaderState = {\n  token?: string,\n  error?: any,\n  totalFilesToUploadCount: number,\n  filesUploadedCount: number,\n  isUploading?: boolean,\n  successfullyUploaded: boolean\n}\n\nexport type UploaderProps = {\n  token?: string,\n  parentContainerId: string\n}\n\nexport default class Uploader extends React.Component<UploaderProps, UploaderState> {\n  private readonly inputOpenFileRef: React.RefObject<HTMLInputElement>\n\n  constructor(props: UploaderProps) {\n    super(props)\n    this.state = {\n      token: '',\n      isUploading: false,\n      filesUploadedCount: 0,\n      totalFilesToUploadCount: 0,\n      successfullyUploaded: false\n    }\n    this.inputOpenFileRef = React.createRef()\n  }\n\n  showOpenFileDlg = () => {\n    if (this.inputOpenFileRef && this.inputOpenFileRef.current) {\n      this.inputOpenFileRef.current.click()\n    }\n  }\n\n  handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files) {\n      this.handleFilesChanged(event.target.files)\n    }\n  }\n\n  finishedProcessingOneFile = () => {\n    const incrementedFilesUploadedCount = this.state.filesUploadedCount + 1\n    const isStillUploading = incrementedFilesUploadedCount < this.state.totalFilesToUploadCount\n    this.setState(\n      {\n        isUploading: isStillUploading,\n        filesUploadedCount: incrementedFilesUploadedCount,\n        successfullyUploaded: !isStillUploading\n      })\n  }\n\n  handleUploadError = (error: any) => {\n    this.finishedProcessingOneFile()\n    this.setState({ error })\n  }\n\n  handleFilesChanged = (selectorFiles: FileList) => {\n    this.setState(\n      {\n        error: undefined,\n        isUploading: true,\n        filesUploadedCount: 0,\n        totalFilesToUploadCount: selectorFiles.length,\n        successfullyUploaded: false,\n      })\n    Array.from(selectorFiles).forEach((file) => {\n      // check for existing filename in parent folder before upload (add new version if exists).\n      // note that the parent container (project/folder) is configurable.\n      const newFileEntity: FileEntity = {\n        parentId: this.props.parentContainerId,\n        name: file.name,\n        concreteType: 'org.sagebionetworks.repo.model.FileEntity',\n        dataFileHandleId: '',\n      }\n      const entityLookupRequest: EntityLookupRequest = { entityName: file.name, parentId: this.props.parentContainerId }\n      lookupChildEntity(entityLookupRequest, this.props.token).then((entityId: EntityId) => {\n        // ok, found an entity of the same name.\n        getEntity<FileEntity>(this.props.token, entityId.id).then((existingEntity: FileEntity) => {\n          if (existingEntity.concreteType === 'org.sagebionetworks.repo.model.FileEntity') {\n            this.updateEntityFile(existingEntity, file)\n          } else {\n            this.updateEntityFile(newFileEntity, file)\n          }\n        })\n      }).catch((error: any) => {\n        if (error.statusCode === 404) {\n          // great, it's a new file!\n          this.updateEntityFile(newFileEntity, file)\n        } else {\n          this.handleUploadError(error)\n        }\n      })\n    })\n  }\n\n  updateEntityFile = (fileEntity: FileEntity, file: File) => {\n    uploadFile(this.props.token, file.name, file).then((fileUploadComplete: FileUploadComplete) => {\n      const isCreate = fileEntity.dataFileHandleId === ''\n      fileEntity.dataFileHandleId = fileUploadComplete.fileHandleId\n      const createOrUpdate = isCreate ? createEntity : updateEntity\n      createOrUpdate(fileEntity, this.props.token).then(() => {\n        this.finishedProcessingOneFile()\n      })\n    }).catch((error: any) => {\n      this.handleUploadError(error)\n    })\n  }\n\n  render() {\n    return (\n      <div>\n        {/** This input field is used for it's functionally (browse for files), the button acts as the UI. */}\n        <input\n          ref={this.inputOpenFileRef}\n          type=\"file\"\n          style={{ display: 'none' }}\n          onChange={this.handleChange}\n          multiple={true}\n        />\n        <button type=\"button\" onClick={this.showOpenFileDlg} className=\"SRC-uploadButton\">Browse...</button>\n        {\n          this.state.isUploading &&\n          <React.Fragment>\n            <span style={{ marginLeft: '10px' }}>\n              {this.state.filesUploadedCount} / {this.state.totalFilesToUploadCount} file(s)\n            </span>\n            <span style={{ marginLeft: '2px' }} className={'spinner'} />\n          </React.Fragment>\n        }\n        {\n          this.state.successfullyUploaded &&\n          <span style={{ marginLeft: '10px' }}>\n            Successfully uploaded {this.state.totalFilesToUploadCount} file(s) to\n            <a \n              style={{ marginLeft: '2px' }} \n              href={`https://www.synapse.org/#!Synapse:${this.props.parentContainerId}`} \n              rel=\"noopener noreferrer\" \n              target=\"_blank\">{this.props.parentContainerId}\n            </a>\n          </span>\n        }\n        {\n          this.state.error &&\n          <p>\n            Upload error!\n          </p>\n        }\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { FileEntity } from '../utils/jsonResponses/FileEntity'\nimport { getEntity, getFileEntityContent, uploadFile, updateEntity } from '../utils/SynapseClient'\nimport { Entity } from '../utils/jsonResponses/Entity'\nimport { FileUploadComplete } from '../utils/jsonResponses/FileUploadComplete'\n\ntype FileContentDownloadUploadDemoState = {\n  token?: string,\n  error?: any,\n  isLoading?: boolean,\n  fileContent?: string,\n  targetEntity?: FileEntity\n}\n\nexport type FileContentDownloadUploadDemoProps = {\n  token?: string,\n  targetEntityId: string\n}\n\nexport default class FileContentDownloadUploadDemo\n  extends React.Component<FileContentDownloadUploadDemoProps, FileContentDownloadUploadDemoState> {\n  constructor(props: FileContentDownloadUploadDemoProps) {\n    super(props)\n    this.state = {\n      token: '',\n      isLoading: false,\n    }\n  }\n\n  public componentDidMount() {\n    const { token, targetEntityId } = this.props\n    // must be logged in to download content\n    if (token) {\n      this.setState({ isLoading: true })\n      getEntity(token, targetEntityId).then((entity: Entity) => {\n        // if file entity\n        if (entity.concreteType === 'org.sagebionetworks.repo.model.FileEntity') {\n          const fileEntity: FileEntity = entity as FileEntity\n          getFileEntityContent(token, fileEntity).then((content) => {\n            this.setState({ fileContent: content, targetEntity: fileEntity, isLoading: false })\n          })\n        } else {\n          this.setState({ error: 'invalid type', isLoading: false })\n        }\n      }).catch((err) => {\n        this.setState({ error: err, isLoading: false })\n      })\n    }\n  }\n\n  updateFileContent = (event: React.MouseEvent<HTMLButtonElement>) => {\n    // create a new FileHandle, and update the FileEntity\n    if (this.props.token && this.state.targetEntity && this.state.fileContent) {\n      this.setState({ isLoading: true })\n      const newFileContent = new Blob([this.state.fileContent], {\n        type: 'text/plain'\n      })\n      uploadFile(this.props.token, this.state.targetEntity.name, newFileContent)\n        .then((fileUploadComplete: FileUploadComplete) => {\n          // now update the entity!\n          if (this.state.targetEntity) {\n            this.state.targetEntity.dataFileHandleId = fileUploadComplete.fileHandleId\n            updateEntity(this.state.targetEntity, this.props.token).then((entity: Entity) => {\n              const fileEntity = entity as FileEntity\n              // updated the target entity, force it to get the updated entity\n              this.setState({ targetEntity: fileEntity, isLoading: false })\n            }).catch((err: string) => {\n              this.setState({ error: err, isLoading: false })\n            })\n          }\n        }).catch((err: string) => {\n          this.setState({ error: err, isLoading: false })\n        })\n    }\n  }\n  handleContentChange = (event: React.ChangeEvent<HTMLTextAreaElement>) => {\n    this.setState({ fileContent: event.target.value })\n  }\n\n  render() {\n    return (\n      <div>\n        {\n          this.state.fileContent &&\n          <React.Fragment>\n            <div>\n              <textarea\n                style={{ width: '100%', height: '300px' }}\n                value={this.state.fileContent}\n                onChange={this.handleContentChange}\n              />\n            </div>\n            <button onClick={this.updateFileContent}>Update File Content...</button>\n          </React.Fragment>\n        }\n        {\n          this.state.isLoading &&\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        }\n\n        {\n          this.state.error &&\n          <p>\n            Download error!\n          </p>\n        }\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\n// tslint:disable-next-line:import-name\nimport Plotly from 'plotly.js-basic-dist'\n// tslint:disable-next-line:import-name\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { SynapseClient } from '../utils'\nimport { ProjectFilesStatisticsRequest, ProjectFilesStatisticsResponse, FilesCountStatistics } from '../utils/jsonResponses/Statistics'\nconst Plot = createPlotlyComponent(Plotly)\n\nexport type StatisticsPlotProps = {\n  request: ProjectFilesStatisticsRequest\n  token?: string\n  endpoint?: string\n  title?: string\n  xtitle?: string\n  ytitle?: string\n  isHorizontal?: boolean\n  xaxistype?: string\n  showlegend?: boolean\n}\n\ntype StatisticsPlotState = {\n  isLoaded: boolean\n  plotData?: ProjectFilesStatisticsResponse\n}\n\nclass StatisticsPlot extends React.Component<StatisticsPlotProps, StatisticsPlotState> {\n\n  constructor(props: StatisticsPlotProps) {\n    super(props)\n    this.state = {\n      isLoaded: false,\n      plotData: {} as ProjectFilesStatisticsResponse\n    }\n  }\n\n  public componentDidMount() {\n    this.fetchPlotlyData()\n  }\n  /**\n   * Get data for plotly\n   *\n   * @returns data corresponding to plotly widget\n   */\n  fetchPlotlyData = async () => {\n    const { token, request, endpoint } = this.props\n    return SynapseClient.getProjectStatistics(request, token, endpoint).then(\n      (data: ProjectFilesStatisticsResponse) => {\n        this.setState({\n          isLoaded: true,\n          plotData: data\n        })\n      }\n    ).catch(\n      (err: any) => {\n        console.log('Error on call to get statistics ', err)\n      }\n    )\n  }\n\n  getTrace = (traceName:string, stats: FilesCountStatistics[], orientation: string) => {\n    let x: string[] = [];\n    let y: number[] = [];\n    const trace = {\n      orientation,\n      x,\n      y,\n      name: traceName,\n      type: 'bar'\n    }\n    for (const statPoint of stats){\n      const month = new Date(statPoint.rangeStart).toLocaleString('default', { month: 'long' })\n      trace.x.push(month)\n      trace.y.push(statPoint.filesCount)\n    }\n    return trace\n  }\n\n  showPlot = () => {\n    if (!this.state.isLoaded || !this.state.plotData) {\n      return\n    }\n    const {\n            title,\n            xtitle,\n            ytitle,\n            isHorizontal,\n            xaxistype,\n            showlegend\n        } = this.props\n    const plotData = this.state.plotData\n    const layout: any = {\n      showlegend,\n      title,\n      barmode: 'stack'\n    }\n    if (xtitle) {\n      layout.xaxis = {\n        title: xtitle\n      }\n    }\n    if (xaxistype) {\n      layout.xaxis = {\n        ...layout.xaxis,\n        xaxistype: xaxistype.toLowerCase()\n      }\n    }\n    if (ytitle) {\n      layout.yaxis = {\n        title: ytitle\n      }\n    }\n    // init plot_data\n    const orientation: string = isHorizontal ? 'h' : 'v'\n    const traces: any = []\n    if (plotData.fileDownloads && plotData.fileDownloads.months && plotData.fileDownloads.months.length > 0) {\n      // add file downloads trace\n      traces.push(this.getTrace('File Downloads', plotData.fileDownloads.months, orientation))\n    }\n    if (plotData.fileUploads && plotData.fileUploads.months && plotData.fileUploads.months.length > 0) {\n      // add file uploads trace\n      traces.push(this.getTrace('File Uploads', plotData.fileUploads.months, orientation))\n    }\n    if (traces.length > 0)\n      return <Plot layout={layout} data={traces} />\n    else\n      return <></>\n  }\n\n  public render() {\n    if (!this.state.isLoaded) {\n      return null\n    }\n    return (this.showPlot())\n  }\n}\nexport default StatisticsPlot\n","import * as React from 'react'\nimport Login from '../../lib/containers/Login'\nimport { SynapseVersion } from '../../lib/utils/jsonResponses/SynapseVersion'\nimport { SynapseClient, SynapseConstants } from '../../lib/utils/'\nimport EntityForm from '../../lib/containers/EntityForm'\nimport QueryWrapperMenu, { MenuConfig } from '../../lib/containers/QueryWrapperMenu'\nimport Uploader from '../../lib/containers/Uploader'\nimport FileContentDownloadUploadDemo from '../../lib/containers/FileContentDownloadUploadDemo'\nimport { QueryBundleRequest } from 'lib/utils/jsonResponses/Table/QueryBundleRequest'\nimport { OIDCAuthorizationRequest } from 'lib/utils/jsonResponses/OIDCAuthorizationRequest'\nimport { OIDCAuthorizationRequestDescription } from 'lib/utils/jsonResponses/OIDCAuthorizationRequestDescription'\nimport { AccessCodeResponse } from 'lib/utils/jsonResponses/AccessCodeResponse'\nimport { OAuthClientPublic } from 'lib/utils/jsonResponses/OAuthClientPublic'\nimport { QueryTableResults } from 'lib/utils/jsonResponses/EvaluationQueryTable/QueryTableResults'\nimport StatisticsPlot from 'lib/containers/StatisticsPlot'\n\ntype DemoState = {\n  token: string\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  cardSelection: string\n  cardSql: string\n  tabOne: any\n  tabTwo: any\n  showTabOne: boolean\n  userFormDataSynId?: string,\n  evaluationQueryString?: string,\n  evaluationQueryResults?: QueryTableResults\n}\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n\n */\nclass Demo extends React.Component<{}, DemoState> {\n  entityFormRef: any\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    this.entityFormRef = React.createRef()\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      token: '',\n      version: 0,\n      cardSql: 'SELECT * FROM syn16859448',\n      cardSelection: SynapseConstants.TOOL,\n      showTabOne: false,\n      tabOne:\n      {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          synapseId: 'syn16787123',\n        },\n        menuConfig: [\n          {\n            title: 'Data',\n            facetDisplayValue: 'Organism',\n            facet: 'dataStatus',\n            sql: 'SELECT projectStatus, dataStatus, tumorType, diseaseFocus FROM syn16787123',\n          },\n          {\n            title: 'Data',\n            facetDisplayValue: 'Study',\n            facet: 'projectStatus',\n            sql: 'SELECT createdBy FROM syn16787123',\n          }\n        ],\n        rgbIndex: 2\n      }\n    ,\n      tabTwo: {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          synapseId: 'syn16858331',\n        },\n        menuConfig: [\n          {\n            facet: 'assay',\n            sql: 'SELECT createdBy FROM syn16858331',\n          },\n          {\n            facet: 'dataType',\n            sql: 'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          },\n          {\n            facet: 'diagnosis',\n            sql: 'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          }\n        ] as MenuConfig[]\n        ,\n        rgbIndex: 5\n      },\n      evaluationQueryString: 'select objectId,createdOn,entityId,team,SpecAtSens,auc,pAuc,AUC_rank,AUC_bayes,randBayes,writeUp,archivedWriteUp,archivedImage,archivedModelState from evaluation_8533484 where status == \"SCORED\" and createdOn > 1490639746000 order by \"auc\" DESC limit 100 offset 0'\n    }\n    this.makeSampleQueryCall = this.makeSampleQueryCall.bind(this)\n    this.getVersion = this.getVersion.bind(this)\n    this.handleChange = this.handleChange.bind(this)\n    this.removeHandler = this.removeHandler.bind(this)\n    this.handleCardSelection = this.handleCardSelection.bind(this)\n    this.onSubmitEntityForm = this.onSubmitEntityForm.bind(this)\n    this.onEntityFormSubmitted = this.onEntityFormSubmitted.bind(this)\n    this.getOAuth2RequestDescription = this.getOAuth2RequestDescription.bind(this)\n    this.onOAuth2RequestConsent = this.onOAuth2RequestConsent.bind(this)\n    this.onGetEvaluationSubmissions = this.onGetEvaluationSubmissions.bind(this)\n    this.handleEvaluationQueryChange = this.handleEvaluationQueryChange.bind(this)\n  }\n\n\n  public onSubmitEntityForm() {\n    this.entityFormRef.current.submitForm()\n  }\n\n  public onEntityFormSubmitted(synId: string) {\n    this.setState({ userFormDataSynId: synId })\n  }\n\n  /**\n   * Get the current version of Synapse\n   */\n  public getVersion(): void {\n    // IMPORTANT: Your component should have a property (with default) to change the endpoint.  This is necessary for Synapse.org integration.\n    // Pass your endpoint through to the rpc call:\n    // SynapseClient.getVersion('https://repo-staging.prod.sagebase.org')\n    SynapseClient.getVersion()\n      .then((data: SynapseVersion) => this.setState({ version: data.version }))\n      .catch((error: any) => {\n        // Handle HTTPError.  Has statusCode and message.\n        console.error('Get version failed', error)\n      })\n  }\n\n    /**\n   * Verify a oauth client information\n   */\n  public getOAuth2Client(): void {\n    SynapseClient.getOAuth2Client('100002')\n      .then((data: OAuthClientPublic) => console.log(data))\n      .catch((error: any) => {\n        console.error('Get OAuthClientPublic failed', error)\n      })\n  }\n\n  /**\n   * Verify a oauth client request\n   */\n  public getOAuth2RequestDescription(): void {\n    const OAUTH2REQUEST:OIDCAuthorizationRequest = {\n      clientId: '100002',\n      scope: 'openid',\n      claims: '{\"id_token\":{\"team\":{\"values\":[\"101\"]},\"given_name\":{\"essential\":true},\"family_name\":{\"essential\":true},\"email\":{\"essential\":true},\"company\":{\"essential\":false}},\"userinfo\":{\"team\":{\"values\":[\"101\"]},\"given_name\":{\"essential\":true},\"family_name\":{\"essential\":true},\"email\":{\"essential\":true},\"company\":{\"essential\":false}}}',\n      responseType: 'code',\n      redirectUri: 'https://data.braincommons.org/user/login/synapse/login',\n      nonce: 'abcdefg'\n    }\n    \n    SynapseClient.getOAuth2RequestDescription(OAUTH2REQUEST, this.state.token)\n      .then((data: OIDCAuthorizationRequestDescription) => console.log(data))\n      .catch((error: any) => {\n        console.error('Get OIDCAuthorizationRequestDescription failed', error)\n      })\n  }\n\n  /**\n   * Verify a oauth client consent\n   */\n  public onOAuth2RequestConsent(): void {\n    const OAUTH2REQUEST:OIDCAuthorizationRequest = {\n      clientId: '100002',\n      scope: 'openid',\n      claims: '{\"id_token\":{\"team\":{\"values\":[\"101\"]},\"given_name\":{\"essential\":true},\"family_name\":{\"essential\":true},\"email\":{\"essential\":true},\"company\":{\"essential\":false}},\"userinfo\":{\"team\":{\"values\":[\"101\"]},\"given_name\":{\"essential\":true},\"family_name\":{\"essential\":true},\"email\":{\"essential\":true},\"company\":{\"essential\":false}}}',\n      responseType: 'code',\n      redirectUri: 'https://data.braincommons.org/user/login/synapse/login',\n      nonce: 'abcdefg'\n    }\n    \n    SynapseClient.consentToOAuth2Request(OAUTH2REQUEST, this.state.token)\n      .then((token: AccessCodeResponse) => console.log(`Successful consent.  Would redirect to ${OAUTH2REQUEST.redirectUri} with access_code=${token.access_code}`))\n      .catch((error: any) => {\n        console.error('Get OIDCAuthorizationRequestDescription failed', error)\n      })\n  }\n    /**\n   * Verify evaluation query\n   */\n  public onGetEvaluationSubmissions(): void {\n    SynapseClient.getEvaluationSubmissions(this.state.evaluationQueryString!, this.state.token)\n    .then((results: QueryTableResults) => this.setState({evaluationQueryResults: results}))\n    .catch((error: any) => {\n      console.error('Get Evaluation QueryTableResults failed', error)\n    })\n  }\n\n  public handleEvaluationQueryChange(event: React.FormEvent<HTMLInputElement>): void {\n    const target = event.currentTarget\n    const value = target.value\n    this.setState({evaluationQueryString: value})\n  }\n  /**\n   * Make a query on synapse\n   */\n  public makeSampleQueryCall(): void {\n    // Example table (view) query.\n    // See https://docs.synapse.org/rest/POST/entity/id/table/query/async/start.html\n    const QUERY: QueryBundleRequest = {\n      entityId: 'syn12335586',\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask:\n        SynapseConstants.BUNDLE_MASK_QUERY_RESULTS |\n        SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n        SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n        SynapseConstants.BUNDLE_MASK_QUERY_FACETS,\n      query: {\n        includeEntityEtag: true,\n        isConsistent: false,\n        limit: 100,\n        offset: 0,\n        sql: 'SELECT * FROM syn12335586'\n      },\n    }\n    SynapseClient.getQueryTableResults(QUERY)\n      .then((data: any) => console.log(data))\n      .catch((error: any) => {\n        console.error(error)\n      })\n  }\n  /**\n   * Update internal state\n   * @param {Object} updatedState new state to be updated by the component\n   */\n  public handleChange(updatedState: {}): void {\n    this.setState(updatedState)\n  }\n\n  public removeHandler(): void {\n    this.setState({ showMarkdown: !this.state.showMarkdown })\n  }\n\n  public handleCardSelection = (event: React.ChangeEvent<HTMLSelectElement>) => {\n    const value = event.target.value\n    let sql = ''\n    switch (value) {\n      case SynapseConstants.AMP_CONSORTIUM:\n        sql = 'SELECT * FROM syn17024173'\n        break\n      case SynapseConstants.DATASET:\n        sql = 'SELECT * FROM syn16859580'\n        break\n      case SynapseConstants.TOOL:\n        sql = 'SELECT * FROM syn16859448'\n        break\n      // peculiar edge case here that breaks the app..\n      // react doesn't set state when this sql statement is used below\n      // case SynapseConstants.FUNDER:\n      //   sql = 'SELECT * FROM syn16858699'\n      //   break\n      case SynapseConstants.PUBLICATION:\n        sql = 'SELECT * FROM syn16857542'\n        break\n    }\n    this.setState(\n      {\n        cardSql: sql,\n        cardSelection: value\n      }\n    )\n  }\n\n  public componentDidMount() {\n    // Note:  All portals should do this once on the initial app load.\n    // This looks for the session token cookie (HttpOnly, unable to directly access), and initialize the session if it does exists.\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n    .then((sessionToken: any) => this.handleChange({ token: sessionToken }))\n    .catch((error: any) => {\n      console.error(error)\n    })\n  }\n  public render(): JSX.Element {\n    let token: string | undefined = ''\n    token = ''\n    const userFormSynLink = `https://www.synapse.org/#!Synapse:${this.state.userFormDataSynId}`\n    return (\n      <div>\n        <p className=\"App-intro text-center\">Synapse production version: {this.state.version}</p>\n        {\n            (this.state.token && this.state.token !== '') &&\n            <div className=\"bg-success text-center\" role=\"alert\">\n              You are logged in.&nbsp;\n              <button\n                onClick={() => {SynapseClient.signOut()}}\n              >\n                  <span aria-hidden=\"true\">Sign out</span>\n              </button>\n            </div>\n        }\n        {\n          (!this.state.token || this.state.token === '') &&\n          <div>\n            <Login\n              token={SynapseClient.IS_DEV_ENV ? token : this.state.token}\n              theme={'light'}\n              icon={true}\n            />\n            <hr />\n          </div>\n        }\n        {\n          (this.state.token && this.state.token !== '') &&\n          <div className=\"container\">\n            <EntityForm\n              parentContainerId=\"syn20355732\"\n              token={this.state.token!}\n              formSchemaEntityId=\"syn20184776\"\n              formUiSchemaEntityId=\"syn20184771\"\n              initFormData={false}\n              ref={this.entityFormRef}\n              synIdCallback={this.onEntityFormSubmitted}\n            />\n          </div>\n        }\n        {\n          (this.state.token && this.state.token !== '') &&\n          !this.state.userFormDataSynId &&\n          <div className=\"container\">\n            <button\n              onClick={this.onSubmitEntityForm}\n              className=\"btn btn-info\"\n            >\n              Programmatically Call Submit\n            </button>\n          </div>\n        }\n        {\n          (this.state.token && this.state.token !== '') &&\n          this.state.userFormDataSynId &&\n          <div className=\"container\">\n            <a href={userFormSynLink} target=\"_blank\">User Form Data Synapse FileEntity created/updated</a>\n          </div>\n        }\n        {\n          (this.state.token && this.state.token !== '') &&\n          <div className=\"container\">\n            <h5>Upload File(s) Demo</h5>\n            <Uploader\n              token={this.state.token!}\n              parentContainerId=\"syn18987891\"\n            />\n            <hr />\n          </div>\n        }\n        {\n          (this.state.token && this.state.token !== '') &&\n          <div className=\"container\">\n            <h5>Download File Content Demo (syn12196718)</h5>\n            <FileContentDownloadUploadDemo\n              token={this.state.token!}\n              targetEntityId=\"syn12196718\"\n            />\n            <hr />\n          </div>\n        }\n        {\n          (this.state.token && this.state.token !== '') &&\n          <div className=\"container\">\n            <h5>Project Statistics Demo</h5>\n            <StatisticsPlot\n              token={this.state.token!}\n              request={ {\n                concreteType: 'org.sagebionetworks.repo.model.statistics.ProjectFilesStatisticsRequest',\n                objectId: 'syn5585645',\n                fileDownloads: true,\n                fileUploads: true\n              }}\n            />\n            <hr />\n          </div>\n        }\n        {\n          <div className=\"container\">\n            <button\n              onClick={this.getOAuth2RequestDescription}\n              className=\"btn btn-info\"\n            >\n              Test getOAuth2RequestDescription\n            </button>\n            <br />\n            <button\n              onClick={this.onOAuth2RequestConsent}\n              className=\"btn btn-info\"\n            >\n              Test onOAuth2RequestConsent\n            </button>\n            <br />\n            <button\n              onClick={this.getOAuth2Client}\n              className=\"btn btn-info\"\n            >\n              Test getOAuth2Client\n            </button>\n            <hr />\n          </div>\n        }\n        { \n          (this.state.token && this.state.token !== '') &&\n          <div className=\"container\">\n            <input\n              placeholder=\"Evaluation Query\"\n              className=\"form-control\"\n              type=\"text\"\n              value={this.state.evaluationQueryString}\n              onChange={this.handleEvaluationQueryChange}\n            />\n            <button\n              onClick={this.onGetEvaluationSubmissions}\n              className=\"btn btn-info\"\n            >\n              Execute evaluation query\n            </button>\n          </div>\n        }\n        {\n          (this.state.evaluationQueryResults) &&\n          <table>\n            <tr> {this.state.evaluationQueryResults.headers.map((value) => {\n              return <th>{value}</th>\n            })} </tr>\n            {\n              this.state.evaluationQueryResults.rows.map((row) => {\n                return <tr> {row.values.map((value) => { return <td>{value}</td> })} </tr>\n              })\n            }\n          </table>\n        }\n        {this.state.isLoading ? <div className=\"container\"> Loading markdown.. </div> : ''}\n        <div className=\"container\">\n          <form>\n            <label>\n              Pick a card type\n            <select value={this.state.cardSelection} onChange={this.handleCardSelection}>\n                <option value={SynapseConstants.AMP_CONSORTIUM}>{SynapseConstants.AMP_CONSORTIUM}</option>\n                <option value={SynapseConstants.DATASET}>{SynapseConstants.DATASET}</option>\n                <option value={SynapseConstants.TOOL}>{SynapseConstants.TOOL}</option>\n                {/* <option value={SynapseConstants.FUNDER}>{SynapseConstants.FUNDER}</option> */}\n                <option value={SynapseConstants.PUBLICATION}>{SynapseConstants.PUBLICATION}</option>\n              </select>\n            </label>\n          </form>\n        </div>\n\n        <div className=\"container\">\n          <button\n            className=\"btn btn-default\"\n            onClick={() => {this.setState({showTabOne: !this.state.showTabOne})}}\n          >\n            toggle tabs for query wrapper menu\n          </button>\n          <a href=\"#table\"> Table Demo </a>\n          <QueryWrapperMenu\n            isConsistent={true}\n            name={'Demo'}\n            token={SynapseClient.IS_DEV_ENV ? token! : this.state.token!}\n            unitDescription={this.state.showTabOne ? this.state.tabOne.unitDescription : this.state.tabTwo.unitDescription}\n            tableConfiguration={this.state.showTabOne ? this.state.tabOne.tableConfiguration : this.state.tabTwo.tableConfiguration}\n            menuConfig={this.state.showTabOne ? this.state.tabOne.menuConfig : this.state.tabTwo.menuConfig}\n            rgbIndex={this.state.showTabOne ? this.state.tabOne.rgbIndex : this.state.tabTwo.rgbIndex}\n            stackedBarChartConfiguration={\n              {\n                loadingScreen: <div/>\n              }\n            }\n          />\n        </div>\n      </div>\n    )\n  }\n}\nexport default Demo\n","import * as React from 'react'\nimport QueryWrapperMenu, { MenuConfig, QueryWrapperMenuProps } from '../../../lib/containers/QueryWrapperMenu'\nimport { SynapseConstants } from '../../../lib/utils'\nimport { GenericCardSchema } from '../../../lib/containers/GenericCard'\n\ntype DemoState = {\n  token: string\n  ownerId: string\n  isLoading: boolean\n  showMarkdown: boolean\n  version: number\n  tabOne: QueryWrapperMenuProps\n  tabTwo: QueryWrapperMenuProps\n  tabThree: QueryWrapperMenuProps\n  activeTab: number\n}\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nclass QueryWrapperMenuDemo extends React.Component<{rgbIndex: number}, DemoState> {\n  /**\n   * Maintain internal state of user session\n   */\n  constructor(props: any) {\n    super(props)\n    const experimentalSql = \"SELECT * FROM syn20337467 WHERE toolType = 'experimental' LIMIT 100\" \n    const computationalSql = \"SELECT * FROM syn20337467 WHERE toolType = 'computational' LIMIT 100\" \n    const genericCardSchema: GenericCardSchema = {\n      title: 'Title',\n      type: 'Generic Tool',\n      subTitle: 'softwareType',\n      description: 'summary',\n      icon: 'icon',\n      secondaryLabels: [\n        'contributor',\n        'diagnosis',\n        'program',\n      ]\n    }\n    this.state = {\n      isLoading: true,\n      ownerId: '',\n      showMarkdown: true,\n      activeTab: 1,\n      tabThree: {\n        stackedBarChartConfiguration: {\n          loadingScreen: <div> Im loading as fast I can! </div>\n        },\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          synapseId: 'syn11346063'\n        },\n        searchConfiguration: {\n          searchable: [\n            {\n              columnName: 'study',\n              hintText: 'study name'\n            },\n          ]\n        },\n        menuConfig: [\n          {\n            facet: 'species',\n            sql: 'SELECT * FROM syn11346063 LIMIT 1000',\n          },\n          {\n            facet: 'study',\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n          {\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n        ] as MenuConfig[]\n        ,\n        rgbIndex: 5\n      },\n      tabTwo:\n      {\n        name: 'Demo',\n        unitDescription: 'persons',\n        cardConfiguration: {\n          genericCardSchema,\n          type: SynapseConstants.MEDIUM_USER_CARD,\n          loadingScreen: <div style={{height: 450}}> I'm loading as fast I can! </div>\n        },\n        rgbIndex: 1,\n        facetAliases: {\n          grant: 'Grant'\n        },\n        accordionConfig: [\n          {\n            name: 'Compuational',\n            cardConfiguration: {\n              genericCardSchema,\n              type: SynapseConstants.GENERIC_CARD,\n              loadingScreen: <div style={{height: 450}}> I'm loading as fast I can! </div>\n            },  \n            menuConfig: [\n              {\n                facet: 'grant',\n                sql: computationalSql,\n              },\n              {\n                facet: 'diagnosis',\n                sql: computationalSql,\n              },\n              {\n                facet: 'modelType',\n                sql: computationalSql,\n              },\n            ],\n          },\n          {\n            name: 'Experimental',\n            cardConfiguration: {\n              genericCardSchema,\n              type: SynapseConstants.GENERIC_CARD,\n              loadingScreen: <div style={{height: 450}}> I'm loading as fast I can! </div>\n            },  \n            menuConfig: [\n              {\n                facet: 'program',\n                sql: experimentalSql,\n              },\n              {\n                facet: 'reagentType',\n                sql: experimentalSql,\n              },\n              {\n                facet: 'softwareType',\n                sql: experimentalSql,\n              },\n            ],\n          },\n        ],\n      }\n    ,\n      tabOne: {\n        unitDescription: 'datum',\n        tableConfiguration: {\n          title: 'title',\n          synapseId: 'syn11346063'\n        },\n        searchConfiguration: {\n          searchable: [\n            {\n              columnName: 'study',\n              hintText: 'study name'\n            },\n          ]\n        },\n        menuConfig: [\n          {\n            facet: 'diagnosis',\n            sql: 'SELECT study, assay, count(distinct id) AS files, concat(organ) AS organs' +\n            ' FROM syn17024112 WHERE species=\\'Human\\' AND assay=\\'rnaSeq\\' group by 1,2 order by 3 desc limit 1000',\n          },\n          {\n            facet: 'PORTALS-712',\n            sql: 'SELECT dataType, assay, fileFormat, COUNT(distinct id) AS Files ' +\n              'FROM syn11346063 WHERE (study LIKE \\'%MODEL-AD_5XFAD%\\') GROUP BY 1, 2, 3 ORDER BY 4 DESC',\n          },\n          {\n            facet: 'study',\n            sql: 'SELECT * FROM syn11346063 limit 1000',\n          },\n          // {\n          //   facet: 'dataType',\n          //   sql: 'SELECT id, fundingAgency, assay, diagnosis, dataType FROM syn16858331',\n          //   synapseId: 'syn16858331',\n          //   title: 'title',\n          //   unitDescription: 'descriptive unit'\n          // },\n        ] as MenuConfig[]\n        ,\n        rgbIndex: 5\n      }\n      ,\n      token: '',\n      version: 0\n    }\n    this.handleChange = this.handleChange.bind(this)\n    this.removeHandler = this.removeHandler.bind(this)\n    this.rgba2rgb = this.rgba2rgb.bind(this)\n  }\n\n  public rgba2rgb(background: number[], color: number[]) {\n    const alpha = color[3]\n    return [\n      Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5),\n      Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5),\n      Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5)\n    ]\n  }\n\n  /**\n   * Update internal state\n   * @param {Object} updatedState new state to be updated by the component\n   */\n  public handleChange(updatedState: {}): void {\n    this.setState(updatedState)\n  }\n\n  public removeHandler(): void {\n    this.setState({ showMarkdown: !this.state.showMarkdown })\n  }\n\n  public render(): JSX.Element {\n    const { \n      activeTab\n    } = this.state\n    let props: QueryWrapperMenuProps = {} as QueryWrapperMenuProps\n    if (activeTab === 0) {\n      props = this.state.tabOne\n    } else if (activeTab === 1) {\n      props = this.state.tabTwo \n    } else {\n      props = this.state.tabThree\n    }\n    return (\n      <div className=\"container\">\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({activeTab: 0})}}\n        >\n          With Group By\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({activeTab: 1})}}\n        >\n          With Tools\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({activeTab: 2})}}\n        >\n          Standard\n        </button>\n        <h2>Demo of table</h2>\n          <QueryWrapperMenu\n            token={''}\n            isConsistent={true}\n            {...props}\n          />\n        </div>\n    )\n  }\n}\nexport default QueryWrapperMenuDemo\n","import * as React from 'react'\nimport CardContainer from './CardContainer'\nimport { QueryBundleRequest } from '../utils/jsonResponses/Table/QueryBundleRequest'\nimport { QueryResultBundle } from '../utils/jsonResponses/Table/QueryResultBundle'\nimport { SynapseClient, SynapseConstants } from '../utils'\nimport { cloneDeep } from '../utils/modules'\nimport { getNextPageOfData } from '../utils/modules/queryUtils'\nimport { GenericCardSchema, IconOptions } from './GenericCard'\nimport { insertConditionsFromSearchParams, KeyValue, SQLOperator } from '../utils/modules/sqlFunctions'\n\nexport interface CardLink {\n  baseURL: string\n  // the keys that will go into the url\n  URLColumnNames: string []\n}\n\n\nexport interface LabelLink extends CardLink {\n  // the columns whos value will be paired with the columns URLColumnNames\n  matchColumnName: string\n}\n\n// Specify the indices in the values [] that should point to links\nexport type LabelLinkConfig = LabelLink []\n\nexport type CommonCardProps = {\n  type: string\n  genericCardSchema?: GenericCardSchema\n  hasInternalLink?: boolean\n  iconOptions?: IconOptions\n  secondaryLabelLimit?: number\n  titleLinkConfig?: CardLink\n  labelLinkConfig?: LabelLinkConfig\n  loadingScreen?: React.FunctionComponent | JSX.Element\n}\n\nexport type CardContainerLogicProps = {\n  token?: string\n  limit?: number\n  title?: string\n  unitDescription?: string\n  sqlOperator?: SQLOperator\n  searchParams?: KeyValue\n  facet?: string\n  loadingScreen?: JSX.Element\n  genericCardSchema?: GenericCardSchema\n  backgroundColor?:string\n  isHeader?:boolean\n  sql: string\n} & CommonCardProps\n\ntype State = {\n  data: QueryResultBundle | undefined\n  isLoading: boolean\n  queryRequest: QueryBundleRequest\n  totalResultsNoFacet: number,\n  hasMoreData: boolean\n}\n\n/**\n * Class wraps around CardContainer and serves as a standalone logic container for rendering cards.\n * This same logic exists in QueryWrapper, but the two serve two distinct purposes, making this component\n * sufficiently distinct.\n *\n * @class CardContainerLogic\n * @extends {React.Component}\n */\nexport default class CardContainerLogic extends React.Component<CardContainerLogicProps, State> {\n\n  public static defaultProps = {\n    token: ''\n  }\n\n  public static defaultState = {\n    data: undefined,\n    isLoading: true,\n    queryRequest: {} as QueryBundleRequest,\n    totalResultsNoFacet: 0,\n    hasMoreData: true\n  }\n\n  constructor(props: CardContainerLogicProps) {\n    super(props)\n    this.executeInitialQueryRequest = this.executeInitialQueryRequest.bind(this)\n    this.getLastQueryRequest = this.getLastQueryRequest.bind(this)\n    this.getNextPageOfData = this.getNextPageOfData.bind(this)\n    this.state = CardContainerLogic.defaultState\n  }\n\n  /**\n   * Compute default query request\n   *\n   * @memberof QueryWrapper\n   */\n  public componentDidMount() {\n    this.executeInitialQueryRequest()\n  }\n\n  /**\n   * @memberof QueryWrapper\n   *\n   */\n  public componentDidUpdate(prevProps: CardContainerLogicProps) {\n    /**\n     *  If component updates and the token has changed (they signed in) then the data should be pulled in. Or if the\n     *  sql query has changed of the component then perform an update.\n     */\n\n    if (this.props.token !== '' && prevProps.token === '') {\n      this.executeInitialQueryRequest()\n    }\n    if (prevProps.sql !== this.props.sql) {\n      this.executeInitialQueryRequest()\n    }\n  }\n\n  /**\n   * Pass down a deep clone (so no side affects on the child's part) of the\n   * last query request made\n   *\n   * @returns\n   * @memberof QueryWrapper\n   */\n  public getLastQueryRequest(): QueryBundleRequest {\n    return cloneDeep(this.state.queryRequest)\n  }\n\n  /**\n   * Grab the next page of data, pulling in 25 more rows.\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public async getNextPageOfData(queryRequest: QueryBundleRequest) {\n    this.setState({\n      isLoading: true\n    })\n\n    await getNextPageOfData(queryRequest, this.state.data!, this.props.token)\n    .then(\n      (newState) => {\n        this.setState({\n          ...newState,\n          isLoading: false,\n          queryRequest: cloneDeep(queryRequest)\n        })\n      }\n    )\n  }\n\n  /**\n   * Execute the initial query passed into the component\n   *\n   * @param {*} queryRequest Query request as specified by\n   *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html\n   * @memberof QueryWrapper\n   */\n  public executeInitialQueryRequest() {\n    this.setState({\n      isLoading: true,\n    })\n\n    let sqlUsed = this.props.sql\n    if (this.props.searchParams) {\n      sqlUsed = insertConditionsFromSearchParams(this.props.searchParams, this.props.sql, this.props.sqlOperator)\n    }\n\n    // we don't set this in the state because it hardcodes the sql query, on componentDidUpdate\n    // we need the sql to change\n    const initQueryRequest: QueryBundleRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask:\n        SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n        SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n        SynapseConstants.BUNDLE_MASK_QUERY_RESULTS |\n        SynapseConstants.BUNDLE_MASK_QUERY_COUNT\n        ,\n      query: {\n        sql: sqlUsed,\n        isConsistent: false,\n        limit: 25,\n        offset: 0,\n      }\n    }\n\n    SynapseClient\n      .getQueryTableResults(initQueryRequest, this.props.token)\n      .then(\n        (data: QueryResultBundle) => {\n          const queryRequestWithoutCount = cloneDeep(initQueryRequest)\n          queryRequestWithoutCount.partMask = (\n            SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n            SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n            SynapseConstants.BUNDLE_MASK_QUERY_RESULTS\n          )\n\n          const hasMoreData = data.queryResult.queryResults.rows.length === SynapseConstants.PAGE_SIZE\n          const newState = {\n            hasMoreData,\n            data,\n            queryRequest: queryRequestWithoutCount,\n            isLoading: false,\n            totalResultsNoFacet: data.queryCount!\n          }\n          this.setState(newState)\n        }\n      ).catch((err) => {\n        console.log('Failed to get data ', err)\n      })\n  }\n\n  /**\n   * Render the children without any formatting\n   */\n  public render() {\n    // only forward the necessary props\n    const {\n      sql,\n      searchParams,\n      token,\n      ...rest\n    } = this.props\n    return (\n      <CardContainer\n        {...rest}\n        data={this.state.data}\n        getLastQueryRequest={this.getLastQueryRequest}\n        getNextPageOfData={this.getNextPageOfData}\n        hasMoreData={this.state.hasMoreData}\n        isLoading={this.state.isLoading}\n      />\n    )\n  }\n\n}\n","export enum FileHandleAssociateType {\n  FileEntity = 'FileEntity',\n  TableEntity = 'TableEntity',\n  WikiAttachment = 'WikiAttachment',\n  WikiMarkdown = 'WikiMarkdown',\n  UserProfileAttachment = 'UserProfileAttachment',\n  MessageAttachment = 'MessageAttachment',\n  TeamAttachment = 'TeamAttachment',\n  SubmissionAttachment = 'SubmissionAttachment',\n  VerificationSubmission = 'VerificationSubmission',\n  AccessRequirementAttachment = 'AccessRequirementAttachment',\n  DataAccessRequestAttachment = 'DataAccessRequestAttachment',\n  DataAccessSubmissionAttachment = 'DataAccessSubmissionAttachment'\n}\n\nexport type FileHandleAssociation = {\n  fileHandleId:\tstring //\tThe ID of the FileHandle.\n  associateObjectId:\tstring //\tThe ID of the object associated with the file\n  associateObjectType:\tFileHandleAssociateType //\tEnumeration of all possible objects types that can be associated with a file.\n}","import * as React from 'react'\n\ntype BookmarksProps = {\n  footnotes: string\n}\n\nclass Bookmarks extends React.Component<BookmarksProps, {}> {\n\n  constructor(props: BookmarksProps) {\n    super(props)\n    this.renderBookmarks = this.renderBookmarks.bind(this)\n  }\n\n  /**\n   * Returns bookmarks\n   *\n   * @returns JSX for the embedded bookmarks in the markdown passed in as a prop\n   * @memberof Bookmarks\n   */\n  public renderBookmarks() {\n    const copyFootnotes: string = String(this.props.footnotes)\n\n    // find all the links embedded in the markdown below\n    const regex = /Synapse widget&gt;<\\/span>(.*)</g\n    let matchedGroup: RegExpExecArray | null\n    const output = []\n    // below we use regex.exec to find the find matched group containing the citation source\n    while ((matchedGroup = regex.exec(copyFootnotes))) {\n      output.push(matchedGroup[1])\n    }\n\n    // return all the links formatted accordingly\n    return output.map(\n      (el, index) => {\n        const isBeforeLastElement = index < output.length - 1\n        return (\n          <React.Fragment key={index}>\n            <button className=\"SRC-markdown-bookmark\" id={`bookmark${index}`}>[{index + 1}]</button>\n            <span dangerouslySetInnerHTML={{ __html: el }} />\n            {isBeforeLastElement && <br/>}\n          </React.Fragment>\n        )\n      }\n    )\n  }\n\n  public render() {\n    return (\n      <React.Fragment>\n        <hr />\n        {this.renderBookmarks()}\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Bookmarks\n","import * as React from 'react'\nimport { BatchFileResult } from '../../utils/jsonResponses/BatchFileResult'\nimport { FileEntity } from '../../utils/jsonResponses/FileEntity'\nimport { FileHandle } from '../../utils/jsonResponses/FileHandle'\nimport { getEntity, getFiles } from '../../utils/SynapseClient'\nimport { BatchFileRequest } from '../../utils/jsonResponses/BatchFileRequest'\nimport { FileHandleAssociation, FileHandleAssociateType } from '../../utils/jsonResponses/FileHandleAssociation'\n\ntype SynapseImageProps = {\n  wikiId?: string\n  synapseId?: string\n  token?: string\n  fileName?: string\n  fileResults?: FileHandle []\n  params: any\n}\n\ntype SynapseImageState = {\n  preSignedURL: string\n}\n\nclass SynapseImage extends React.Component<SynapseImageProps, SynapseImageState> {\n\n  constructor(props: SynapseImageProps) {\n    super(props)\n    this.getEntity = this.getEntity.bind(this)\n    this.getSynapseFiles = this.getSynapseFiles.bind(this)\n    this.state = {\n      preSignedURL: ''\n    }\n  }\n\n  public getEntity() {\n    const { token, synapseId } = this.props\n    if (synapseId) {\n      getEntity<FileEntity>(token, synapseId).then(\n        // https://docs.synapse.org/rest/org/sagebionetworks/repo/model/FileEntity.html\n        (data: FileEntity) => {\n          const fileHandleAssociationList = [\n            {\n              associateObjectId: synapseId,\n              associateObjectType: FileHandleAssociateType.FileEntity,\n              fileHandleId: data.dataFileHandleId\n            }\n          ]\n          this.getSynapseFiles(fileHandleAssociationList, data.dataFileHandleId)\n        }\n      )\n    }\n  }\n  public getSynapseFiles(fileHandleAssociationList: FileHandleAssociation [], id: string) {\n    // overload the method for two different use cases, one where\n    // the image is attached to an entity and creates a list on the spot,\n    // the other where list is passed in from componentDidMount in MarkdownSynapse\n    const request: BatchFileRequest = {\n      includeFileHandles: false,\n      includePreSignedURLs: true,\n      includePreviewPreSignedURLs: false,\n      requestedFiles: fileHandleAssociationList\n    }\n    getFiles(request, this.props.token).then(\n      (data: BatchFileResult) => {\n        const { preSignedURL } = data.requestedFiles.filter(el => el.fileHandleId === id)[0] // this.matchToHandle(this.compareById(id, 'fileHandleId'), data.requestedFiles)\n        this.setState({\n          preSignedURL: preSignedURL\n        })\n      }\n    ).catch(\n      err => {\n        console.error('Error on getting image ', err)\n      }\n    )\n  }\n  public componentDidMount() {\n    if (!this.props.wikiId) {\n      // Get file handle as external attachment\n      this.getEntity()\n    } else {\n      // Can get presigned url right away from wiki association\n      const { fileName, fileResults = [] } = this.props\n      const { id } = fileResults.filter(el => el.fileName === fileName)[0]\n      const fileHandleAssociationList: FileHandleAssociation [] = [\n        {\n          associateObjectId: this.props.wikiId,\n          associateObjectType: FileHandleAssociateType.WikiAttachment,\n          fileHandleId: id\n        }\n      ]\n      this.getSynapseFiles(fileHandleAssociationList, id)\n    }\n  }\n\n  public render() {\n    const imgStyle: React.CSSProperties = {}\n    const { params = {}} = this.props\n    const { align = '' } = params\n    const alignLowerCase = align.toLowerCase()\n    let className = ''\n    if (alignLowerCase === 'left') {\n      className = 'floatLeft'\n    }\n    if (alignLowerCase === 'right') {\n      className = 'floatright'\n    }\n    if (alignLowerCase === 'center') {\n      className = 'align-center'\n    }\n    if (!this.state.preSignedURL) {\n      return null\n    }\n    return (\n      <React.Fragment>\n        <img\n          alt=\"synapse\"\n          className={\"img-fluid  \"  + className}\n          src={this.state.preSignedURL}\n          style={imgStyle}\n        />\n      </React.Fragment>\n    )\n  }\n}\nexport default SynapseImage\n","import * as React from 'react'\n// tslint:disable-next-line:import-name\nimport Plotly from 'plotly.js-basic-dist'\n// tslint:disable-next-line:import-name\nimport createPlotlyComponent from 'react-plotly.js/factory'\nimport { QueryResultBundle } from '../../utils/jsonResponses/Table/QueryResultBundle'\nimport { getFullQueryTableResults } from '../../utils/SynapseClient'\nimport { SynapseConstants } from '../../utils/'\nconst Plot = createPlotlyComponent(Plotly)\n\ntype SynapsePlotProps = {\n  token?: string\n  ownerId?: string\n  wikiId?: string\n  widgetparamsMapped?: any\n}\n\ntype SynapsePlotState = {\n  isLoaded: boolean\n  queryData: QueryResultBundle\n}\n\nclass SynapsePlot extends React.Component<SynapsePlotProps, SynapsePlotState> {\n\n  constructor(props: SynapsePlotProps) {\n    super(props)\n    this.state = {\n      isLoaded: false,\n      queryData: {} as QueryResultBundle\n    }\n    this.fetchPlotlyData = this.fetchPlotlyData.bind(this)\n    this.showPlot = this.showPlot.bind(this)\n  }\n\n  public componentDidMount() {\n    this.fetchPlotlyData()\n  }\n  /**\n   * Get data for plotly\n   *\n   * @returns data corresponding to plotly widget\n   */\n  public fetchPlotlyData() {\n    const { token } = this.props\n    const { query } = this.props.widgetparamsMapped\n    const queryRequest = {\n      concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n      partMask: SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n      query: {\n        sql: query\n      }\n    }\n    getFullQueryTableResults(queryRequest, token).then(\n      (data: QueryResultBundle) => {\n        this.setState({\n          isLoaded: true,\n          queryData: data\n        })\n      }\n    ).catch(\n      (err: any) => {\n        console.log('Error on full table query ', err)\n      }\n    )\n  }\n\n  public showPlot() {\n    if (!this.state.isLoaded) {\n      return\n    }\n    const {\n            title,\n            xtitle,\n            ytitle,\n            type,\n            xaxistype,\n            showlegend\n        } = this.props.widgetparamsMapped\n    const queryData = this.state\n    const isHorizontal = this.props.widgetparamsMapped.horizontal.toLowerCase()\n    const layout: any = {\n      showlegend,\n      title\n    }\n    if (xtitle) {\n      layout.xaxis = {\n        title: xtitle\n      }\n    }\n    if (xaxistype) {\n      layout.xaxis = {\n        ...layout.xaxis,\n        xaxistype: xaxistype.toLowerCase()\n      }\n    }\n    if (ytitle) {\n      layout.yaxis = {\n        title: ytitle\n      }\n    }\n    // init plot_data\n    const plotData: any = []\n    const orientation = isHorizontal ? 'v' : 'h'\n    const headers = queryData.queryData.queryResult.queryResults.headers\n    for (let i = 0; i < headers.length - 1; i += 1) {\n      // make an entry for each set of data points\n      plotData[i] = {\n        orientation,\n        name: headers[i + 1].name,\n        type: type.toLowerCase(),\n        x: [],\n        y: []\n      }\n    }\n    // grab all the data\n    for (const row of queryData.queryData.queryResult.queryResults.rows) {\n      for (let j = 1; j < row.values.length; j += 1) {\n        // create pairs of data\n        const rowValues: any = row.values\n        plotData[j - 1].x.push(rowValues[0])\n        plotData[j - 1].y.push(rowValues[j])\n      }\n    }\n    return <Plot layout={layout} data={plotData} />\n  }\n\n  public render() {\n    if (!this.state.isLoaded) {\n      return null\n    }\n    return (this.showPlot())\n  }\n}\nexport default SynapsePlot\n","export enum StepStateEnum {\n  TODO,\n  PROGRESS,\n  COMPLETED,\n  EXCLUDED,\n  ERROR\n}\n\nexport type Step = {\n  id: string;\n  title: string;\n  order: number;\n  state: StepStateEnum;\n  inProgress: boolean;\n  rules: any[];\n  default: string;\n  excluded?: boolean;\n  final?: boolean;\n  description?: string;\n  copy?: string;\n  static?: boolean;\n  child?: boolean;\n  children?: string[];\n};\n\nexport enum NavActionEnum {\n  PREVIOUS,\n  NEXT,\n  GO_TO_STEP,\n  SAVE,\n  SUBMIT,\n  VALIDATE,\n  NONE\n}\n\nexport enum StatusEnum {\n  PROGRESS,\n  ERROR,\n  SAVE_SUCCESS,\n  SUBMIT_SUCCESS,\n  ERROR_CRITICAL\n}\n\nexport interface SummaryFormat {\n  screen: Step;\n  label: string;\n  value: string;\n}\n","import * as React from 'react'\nimport { FileHandleResults } from '../utils/jsonResponses/FileHandleResults'\nimport { SynapseClient, SynapseConstants } from '../utils/'\nimport Bookmarks from './widgets/Bookmarks'\nimport SynapseImage from './widgets/SynapseImage'\nimport SynapsePlot from './widgets/SynapsePlot'\nimport UserCard from './UserCard'\nimport { WikiPage } from '../utils/jsonResponses/WikiPage'\nconst TOC_CLASS = {\n  1: 'toc-indent1',\n  2: 'toc-indent2',\n  3: 'toc-indent3',\n  4: 'toc-indent4',\n  5: 'toc-indent5',\n  6: 'toc-indent6'\n}\n\ndeclare var katex: any\n\ndeclare var markdownitSynapse: any\ndeclare var markdownit: any\ndeclare var markdownitSub: any\ndeclare var markdownitSup: any\ndeclare var markdownitCentertext: any\ndeclare var markdownitSynapseHeading: any\ndeclare var markdownitSynapseTable: any\ndeclare var markdownitStrikethroughAlt: any\ndeclare var markdownitContainer: any\ndeclare var markdownitEmphasisAlt: any\ndeclare var markdownitInlineComments: any\ndeclare var markdownitBr: any\ndeclare var sanitizeHtml: any\n\ndeclare var markdownitMath: any\n\nexport type MarkdownSynapseProps = {\n  errorMessageView?: React.FunctionComponent;\n  token?: string;\n  ownerId?: string;\n  wikiId?: string;\n  markdown?: string;\n}\nconst md = markdownit({ html: true })\n\ntype MarkdownSynapseState = {\n  md: any;\n  data: Partial<WikiPage>\n  fileHandles?: FileHandleResults;\n  errorMessage: string;\n}\n/**\n * Basic Markdown functionality for Synapse, supporting Images/Plots/References/Bookmarks/buttonlinks\n *\n * @class Markdown\n * @extends {React.Component}\n */\nexport default class MarkdownSynapse extends React.Component<MarkdownSynapseProps, MarkdownSynapseState> {\n  public markupRef: React.RefObject<HTMLInputElement>\n\n  /**\n   * Creates an instance of Markdown.\n   * @param {*} props\n   */\n  constructor(props: MarkdownSynapseProps) {\n    super(props)\n    // markdownitSynapse wraps around markdownit object and uses its own dependencies\n    markdownitSynapse.init_markdown_it(md,\n                                       markdownitSub,\n                                       markdownitSup,\n                                       markdownitCentertext,\n                                       markdownitSynapseHeading,\n                                       markdownitSynapseTable,\n                                       markdownitStrikethroughAlt,\n                                       markdownitContainer,\n                                       markdownitEmphasisAlt,\n                                       markdownitInlineComments,\n                                       markdownitBr\n    )\n\n    const mathSuffix = ''\n    // Update the internal markdownit object with the wrapped synapse object\n    md.use(markdownitSynapse, mathSuffix).use(markdownitMath, mathSuffix)\n    const data: any = {}\n    if (this.props.markdown) {\n      data.markdown = this.props.markdown\n    }\n    this.state = {\n      md,\n      errorMessage: '',\n      fileHandles: undefined,\n      data,\n    }\n    this.markupRef = React.createRef()\n    this.handleLinkClicks = this.handleLinkClicks.bind(this)\n    // handle widgets and math markdown\n    this.processWidgets = this.processWidgets.bind(this)\n    this.processWidgetOrDomElement = this.processWidgetOrDomElement.bind(this)\n    this.processMath = this.processMath.bind(this)\n    // handle init calls to get wiki related items\n    this.getWikiAttachments = this.getWikiAttachments.bind(this)\n    this.getWikiPageMarkdown = this.getWikiPageMarkdown.bind(this)\n    // handle rendering widgets\n    this.renderWidget = this.renderWidget.bind(this)\n    this.renderSynapseButton = this.renderSynapseButton.bind(this)\n    this.renderSynapseImage = this.renderSynapseImage.bind(this)\n    this.renderSynapsePlot = this.renderSynapsePlot.bind(this)\n    this.renderSynapseTOC = this.renderSynapseTOC.bind(this)\n    this.getErrorView = this.getErrorView.bind(this)\n    this.createHTML = this.createHTML.bind(this)\n    this.addBookmarks = this.addBookmarks.bind(this)\n    this.addIdsToReferenceWidgets = this.addIdsToReferenceWidgets.bind(this)\n    this.addIdsToTocWidgets = this.addIdsToTocWidgets.bind(this)\n  }\n\n  public componentWillUnmount() {\n    // @ts-ignore TODO: find better documentation on typescript/react event params\n    this.markupRef.current!.removeEventListener('click', this.handleLinkClicks)\n  }\n\n  // Manually handle clicks to anchor tags where the scrollto isn't handled by page hash\n  public handleLinkClicks(event: React.MouseEvent<HTMLElement>) {\n\n    const genericElement = event.target as HTMLElement\n    if (genericElement.tagName === 'A' || genericElement.tagName === 'BUTTON') {\n      const anchor = event.target as HTMLAnchorElement\n      if (anchor.id.substring(0, 3) === 'ref') {\n        event.preventDefault()\n        // its a reference, so we scroll to the appropriate bookmark\n        const referenceNumber = Number(event.currentTarget.id.substring(3)) // e.g. ref2 => '2'\n        const goTo = this.markupRef.current!.querySelector(\n          `#bookmark${referenceNumber}`\n        )\n        try {\n          goTo!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center'\n          })\n        } catch (e) {\n          console.log('error on scroll', e)\n        }\n      } else if (event.currentTarget.id !== null && anchor.getAttribute('data-anchor')) {\n        event.preventDefault()\n        // handle table of contents widget\n        const idOfContent = anchor.getAttribute('data-anchor')\n        const goTo = this.markupRef.current!.querySelector(`#${idOfContent}`)\n        try {\n          goTo!.scrollIntoView({\n            behavior: 'smooth',\n            block: 'center',\n            inline: 'center'\n          })\n        } catch (e) {\n          console.log('error on scroll', e)\n        }\n      }\n    }\n  }\n\n  /**\n   * Given input text, generate markdown object to be passed onto inner html of some container.\n   * @param {String} markdown The text being written in plain markdown\n   * @returns {Object} Dictionary to be passed into dangerouslySetInnerHTML with markdown text\n   */\n  public createHTML(markdown?: string) {\n    if (!markdown) {\n      return { __html: '' }\n    }\n    const initText = this.state.md.render(markdown)\n    const cleanText = sanitizeHtml(initText, {\n      allowedAttributes: {\n        a: ['href', 'target'],\n        button: ['class'],\n        div: ['class', 'style'],\n        h1: ['toc'],\n        h2: ['toc'],\n        h3: ['toc'],\n        h4: ['toc'],\n        h5: ['toc'],\n        h6: ['toc'],\n        li: ['class'],\n        ol: ['class'],\n        span: ['*'],\n        table: ['class'],\n        th: ['class'],\n        thead: ['class'],\n        ul: ['class']\n      },\n      allowedTags: [\n        'span',\n        'code',\n        'h1',\n        'h2',\n        'h3',\n        'h4',\n        'h5',\n        'p',\n        'b',\n        'i',\n        'em',\n        'strong',\n        'a',\n        'id',\n        'table',\n        'tr',\n        'td',\n        'tbody',\n        'th',\n        'thead',\n        'button',\n        'div',\n        'image',\n        'ol',\n        'ul',\n        'li',\n        'svg',\n        'g',\n        'br',\n        'hr',\n        'summary',\n        'details'\n      ]\n    })\n    return { __html: cleanText }\n  }\n\n  /**\n   * Find all math identified elements of the form [id^=\\\"mathjax-\\\"]\n   * (e.g. <dom element id=\"mathjax-10\"> text </dom element>)\n   * and transform them to their math markedown equivalents\n   */\n  public processMath() {\n    if (!this.markupRef.current) {\n      return\n    }\n    // use regex to grab all elements\n    const mathExpressions = this.markupRef.current.querySelectorAll(\n      '[id^=\"mathjax-\"]'\n    )\n    // go through all obtained elements and transform them with katex\n    mathExpressions.forEach((element: any) => {\n      katex.render(element.textContent, element, {\n        delimiters: [\n          {\n            display: true,\n            left: '$$',\n            right: '$$'\n          },\n          {\n            display: false,\n            left: '\\\\(',\n            right: '\\\\)'\n          },\n          {\n            display: true,\n            left: '\\\\[',\n            right: '\\\\]'\n          }\n        ],\n        throwOnError: false\n      })\n    })\n  }\n  /**\n   * Process all the corresponding bookmark tags of the references made throughout the page\n   *\n   * @memberof MarkdownSynapse\n   */\n  public addBookmarks() {\n    markdownitSynapse.resetFootnotes()\n    this.createHTML(this.state.data.markdown)\n    const footnotesHtml = this.createHTML(markdownitSynapse.footnotes()).__html\n    if (footnotesHtml.length > 0) {\n      return (<Bookmarks footnotes={footnotesHtml} />)\n    }\n    // ts doesn't like functions without explicit return statements\n    return\n  }\n\n  /**\n   * Get wiki page markdown and file attachment handles\n   */\n  public async getWikiPageMarkdown() {\n    const { ownerId, wikiId = '', token } = this.props\n    try {\n      const wikiPage = await SynapseClient.getEntityWiki(token,ownerId,wikiId)\n      try {\n        const fileHandles = await this.getWikiAttachments(wikiId ? wikiId: wikiPage.id)\n        this.setState({\n          data: wikiPage,\n          fileHandles\n        })\n      } catch(fileHandlesErr) {\n        console.error('fileHandlesErr = ', fileHandlesErr)\n      }\n    } catch (err) {\n      console.error('Error on wiki markdown load\\n', err)\n    }\n}\n  public async getWikiAttachments(wikiId: string) {\n    const {\n      token,\n      ownerId,\n    } = this.props\n    if (!ownerId) {\n      console.error('Cannot get wiki attachments without ownerId on Markdown Component')\n      return undefined\n    }\n    return await SynapseClient.getWikiAttachmentsFromEntity(\n      token,\n      ownerId,\n      wikiId\n    ).then((data) => {\n      return data\n    })\n    .catch((err) => {\n      this.setState({\n        errorMessage: err.reason\n      })\n      console.error('Error on wiki attachment load ', err)\n      return undefined\n    })\n  }\n  /**\n   * If theres an error loading the wiki page show an informative message\n   * likely a priveledge issue -- (e.g. not signed-in)\n   *\n   * @returns view that presents error message on error, otherwise null\n   */\n  public getErrorView() {\n    if (this.state.errorMessage && this.props.errorMessageView) {\n      const ErrorView = this.props.errorMessageView as React.FC\n      return (\n        <ErrorView>\n          {this.state.errorMessage}\n        </ErrorView>\n      )\n    }\n    return\n  }\n\n  public addIdsToReferenceWidgets(text: string) {\n    const referenceRegex = /<span id=\"wikiReference.*?<span data-widgetparams.*?span>/g\n    let referenceCount = 1\n\n    return text.replace(\n      referenceRegex,\n      () => {\n        // replace all reference tags with id's of the form id=\"ref<number>\"\" that we can read onClick\n        const current = referenceCount\n        referenceCount += 1\n        return `<a href=\"\" id=\"ref${current}\">[${current}]</a>`\n      }\n    )\n  }\n\n  public addIdsToTocWidgets(text: string) {\n    const tocId = 'SRC-header-'\n    let tocIdCount = 1\n    const TOC_HEADER_REGEX = /<h[1-6] toc=\"true\">.*<\\/h[1-6]>/gm\n\n    return text.replace(TOC_HEADER_REGEX, (match: string) => {\n      // replace with id of the form id=\"toc\" so we can read them with onclick events\n      const curTocId = tocIdCount\n      tocIdCount += 1\n      const matchWithId = `${match.substring(0, 3)} id=\"${tocId}${curTocId}\"${match.substring(3)}`\n      return matchWithId\n    })\n  }\n\n  /**\n   * The 'main' method of this class that process all the markdown and transforms it to the appropriate\n   * Synapse widgets.\n   *\n   * @returns JSX of the markdown into widgets\n   * @memberof MarkdownSynapse\n   */\n  public processWidgets() {\n    // create initial markup\n    let markup = this.createHTML(this.state.data.markdown).__html\n    // process reference widgets\n    markup = this.addIdsToReferenceWidgets(markup)\n    // process table of contents widgets\n    markup = this.addIdsToTocWidgets(markup)\n\n    // capture and process all other widgets\n    // (<span data-widgetparams.*?span>) captures widgets\n    const widgetRegex = /(<span data-widgetparams.*?span>)/\n    // widgets is an array of either plain text/html or specific synapse markdown\n    const widgets = markup.split(widgetRegex)\n    if (markup.length > 0) {\n      return this.processWidgetOrDomElement(widgets, markup)\n    }\n    return\n  }\n\n  /**\n   *  When the markdown string is transfered over the network certain characters get transformed,\n   * this does a simple transformation back to the original user's string.\n   *\n   * @param {string} xml\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public decodeXml(xml: string) {\n    const escapedOneToXmlSpecialMap = {\n      '&amp;': '&',\n      '&gt;': '>',\n      '&lt;': '<',\n      '&quot;': '\"'\n    }\n    return xml.replace(/(&quot;|&lt;|&gt;|&amp;)/g, (str, item) => {\n      return escapedOneToXmlSpecialMap[item]\n    })\n  }\n\n  /**\n   * Given widgetMap renders it in a React component (or originalMarkup in special cases.)\n   *\n   * @param {string} widgetMatch The synapse widget to be rendered\n   * @param {string} originalMarkup The original markup text, this is a special case for widgets that\n   * are html specific.\n   * @returns JSX of the widget to render\n   * @memberof MarkdownSynapse\n   */\n  public processWidgetMappings(widgetMatch: string, originalMarkup: string) {\n    // General workflow -\n    //   1. Capture widget parameters\n    //   2. Transform any widget xml parameters to standard text\n    //   3. Split those parameters into a map\n    //   4. Render that widget based on its parameters\n\n    // steps 1,2\n    const widgetParamsRegex = /data-widgetparams=(\"(.*?)\")/\n    const widgetParamsMatchWithXML = widgetMatch.match(widgetParamsRegex)\n    const widgetParamsString = this.decodeXml(widgetParamsMatchWithXML![2])\n\n    // widgetParamsString look like {<widget>?param1=xxx&param2=yyy}\n    const questionIndex = widgetParamsString.indexOf('?')\n    if (questionIndex === -1) {\n      // e.g. toc is passed, there are no params\n      return this.renderWidget(widgetParamsString, {}, originalMarkup)\n    }\n    const widgetType = widgetParamsString.substring(0, questionIndex)\n    const widgetparamsMapped = {}\n    // map out params and their values\n    widgetParamsString\n      .substring(questionIndex + 1)\n      .split('&')\n      .forEach((keyPair) => {\n        let [key, value] = keyPair.split('=')\n        value = decodeURIComponent(value)\n        widgetparamsMapped[key] = value\n      })\n    return this.renderWidget(widgetType, widgetparamsMapped, originalMarkup)\n  }\n\n  /**\n   * Takes in widgetsToBe and parse it out to its respective html element\n   *\n   * @param {string[]} widgetsToBe This is an array of either synapse widgets, e.g. {plot?=...} or plain html\n   * that is not going to be process further.\n   * @param {string} originalMarkup This is the original markup that's maintained only because the table of contents\n   * widget renderer relies on it.\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public processWidgetOrDomElement(widgetsToBe: string[], originalMarkup: string) {\n    const widgets = []\n    let index = 0\n    for (const text of widgetsToBe) {\n      // test if widget is present\n      if (text.indexOf('<span data-widgetparams') !== -1) {\n        // process widget\n        widgets.push(this.processWidgetMappings(text, originalMarkup))\n      } else {\n        // Else its plain html/text.\n        \n        /* \n           Note-- variable `element` introduces a major bug which is that there can be no synapse widgets\n           contained inside html directly.\n            \n           .e.g\n                input:           <a> <span widget-params=\"....\"> </a>\n                expected output: <a> <SynapseWidget/> </a>\n                current output:  <a></a> <SynapseWidget> <a></a>\n           \n           There needs to be a complete rework of the rendering to recursively process the markdown.\n           Along the lines of -\n            - Tokenize the html, recurse on it until theres a leaf, render that as an html element or widget\n        */ \n        const key = index.toString() + text\n        const element = <span key={key} dangerouslySetInnerHTML={{ __html: text }} />\n        widgets.push(\n          element\n        )\n        index += 1\n      }\n    }\n    return widgets\n  }\n\n  /**\n   *  Given widgetType renders the apppropriate widget\n   *\n   * @param {string} widgetType The type of synapse widget. (e.g. 'image', 'plot')\n   * @param {*} widgetparamsMapped The parameters for this widget\n   * @param {string} originalMarkup The original markup.\n   * @returns\n   * @memberof MarkdownSynapse\n   */\n  public renderWidget(\n    widgetType: string,\n    widgetparamsMapped: any,\n    originalMarkup: string\n  ) {\n    // we make keys out of the widget params\n    const key = JSON.stringify(widgetparamsMapped)\n    widgetparamsMapped.reactKey = key\n    switch (widgetType) {\n      case 'buttonlink':\n        return this.renderSynapseButton(widgetparamsMapped)\n      case 'image':\n        return this.renderSynapseImage(widgetparamsMapped)\n      case 'plot':\n        return this.renderSynapsePlot(widgetparamsMapped)\n      case 'toc':\n        return this.renderSynapseTOC(originalMarkup)\n      case 'badge':\n        return this.renderUserBadge(widgetparamsMapped)\n      default:\n        return\n    }\n  }\n\n  public renderSynapseButton(widgetparamsMapped: any) {\n    let buttonClasses = ''\n    const {\n      align = '',\n      highlight = '',\n    } = widgetparamsMapped\n    const alignLowerCase = align.toLowerCase()\n    if (alignLowerCase === 'left') {\n      buttonClasses += 'floatLeft '\n    }\n    if (alignLowerCase === 'right') {\n      buttonClasses += 'floatright '\n    }\n    if (highlight === 'true') {\n      buttonClasses += ' SRC-primary-button '\n    } else {\n      buttonClasses += 'SRC-light-button '\n    }\n    if (alignLowerCase === 'center') {\n      return (\n        <div style={{textAlign: 'center'}}>\n          <a\n            key={widgetparamsMapped.reactKey}\n            href={widgetparamsMapped.url}\n            className={\"SRC-standard-button-shape \" +  buttonClasses}\n            role=\"button\"\n          >\n            {widgetparamsMapped.text}\n          </a>\n        </div>\n      )\n    }\n    return (\n      <a\n        key={widgetparamsMapped.reactKey}\n        href={widgetparamsMapped.url}\n        className={\"SRC-standard-button-shape \" +  buttonClasses}\n        role=\"button\"\n      >\n        {widgetparamsMapped.text}\n      </a>\n    )\n  }\n  public renderSynapsePlot(widgetparamsMapped: any) {\n    return (\n      <SynapsePlot\n        key={widgetparamsMapped.reactKey}\n        token={this.props.token}\n        ownerId={this.props.ownerId}\n        wikiId={this.props.wikiId || this.state.data.id}\n        widgetparamsMapped={widgetparamsMapped}\n      />\n    )\n  }\n\n  public renderSynapseImage(widgetparamsMapped: any) {\n    const { reactKey } = widgetparamsMapped\n    if (widgetparamsMapped.fileName) {\n      if (!this.state.fileHandles) {\n        // ensure files are loaded\n        return\n      }\n      // if file name is attached then the fileHandle ID is located\n      // in this wiki's file attachment list\n      return (\n        <SynapseImage\n          params={widgetparamsMapped}\n          key={reactKey}\n          token={this.props.token}\n          fileName={widgetparamsMapped.fileName}\n          wikiId={this.props.wikiId || this.state.data.id}\n          fileResults={this.state.fileHandles.list}\n        />\n      )\n    }\n    if (widgetparamsMapped.synapseId) {\n      // otherwise this image's fileHandle ID is not located\n      // in the file attachment list and will be loaded first\n      return (\n        <SynapseImage\n          params={widgetparamsMapped}\n          key={reactKey}\n          token={this.props.token}\n          synapseId={widgetparamsMapped.synapseId}\n        />\n      )\n    }\n    return\n  }\n  public renderSynapseTOC(originalMarkup: string) {\n    const elements: any[] = []\n    const TOC_HEADER_REGEX_WITH_ID = /<h([1-6]) id=\"(.*)\" .*toc=\"true\">(.*)<\\/h[1-6]>/gm\n    let text = ''\n    originalMarkup.replace(TOC_HEADER_REGEX_WITH_ID, (p1, p2, p3, p4) => {\n      text += p4\n      elements.push(\n        <div key={p4}>\n          <a className={`link ${TOC_CLASS[Number(p2)]}`} data-anchor={p3}>\n            {' '}{p4}{' '}\n          </a>\n        </div>\n      )\n      return ''\n    })\n    return (<div key={text}>{elements}</div>)\n  }\n\n  public renderUserBadge(widgetparamsMapped: any) {\n    return (\n      <UserCard\n        key={JSON.stringify(widgetparamsMapped)}\n        size={SynapseConstants.SMALL_USER_CARD}\n        alias={widgetparamsMapped.alias}\n      />\n    )\n  }\n\n  public async componentDidMount() {\n    if (this.state.data.markdown) {\n      return\n    }\n    // we use this.markupRef.current && because in testing environment refs aren't defined\n    // @ts-ignore\n    this.markupRef.current && this.markupRef.current!.addEventListener('click', this.handleLinkClicks)\n    // unpack and set default value if not specified\n    // get wiki attachments\n    await this.getWikiPageMarkdown()\n    this.processMath()\n  }\n\n  // on component update find and re-render the math/widget items accordingly\n  public async componentDidUpdate(prevProps: MarkdownSynapseProps) {\n    let shouldUpdate = this.props.token !== prevProps.token\n    shouldUpdate = shouldUpdate || (this.props.ownerId !== prevProps.ownerId)\n    shouldUpdate = shouldUpdate || (this.props.wikiId !== prevProps.wikiId)\n\n    // we have to carefully update the component so it doesn't encounter an infinite loop\n    if (shouldUpdate) {\n      await this.getWikiPageMarkdown()\n    }\n    this.processMath()\n  }\n\n  public render() {\n    return (\n      <div className=\"markdown\" ref={this.markupRef}>\n        {this.getErrorView()}\n        <span>{this.processWidgets()}</span>\n        <div>{this.addBookmarks()}</div>\n      </div>\n    )\n  }\n}\n","import * as React from 'react';\n\nexport type HeaderProps = {\n  bodyText?: string; //should never take user input only use cardcoded text from a parent component. Uses dangerouslySetInnerHTML\n  title: string;\n};\n\nexport default function Header(props: HeaderProps) {\n  return (\n    <>\n      <h2>{props.title}</h2>\n      {props.bodyText && (\n        <div dangerouslySetInnerHTML={{ __html: props.bodyText }}></div>\n      )}\n      <hr></hr>\n    </>\n  );\n}\n","import './StepsSideNav.scss';\n\nimport * as React from 'react';\nimport { Step, StepStateEnum } from './types';\n\nimport { FlipProp, IconDefinition } from '@fortawesome/fontawesome-svg-core';\nimport {\n  faCheckCircle,\n  faCircle,\n  faBan,\n  faExclamationCircle\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nexport type StepsSideNavProps = {\n  stepList: Step[];\n  onStepChange: Function;\n  isWizardMode?: boolean;\n};\n\nexport default function StepsSideNav(props: StepsSideNavProps) {\n  const nonChildSteps = props.stepList.filter(step => step.child !== true);\n\n  const getIcon = (\n    state: StepStateEnum,\n    isExcluded: boolean | undefined,\n    isStatic: boolean | undefined,\n    isSubmit: boolean | undefined\n  ): { iconDef: IconDefinition; flip: FlipProp | undefined } => {\n    let iconDef: IconDefinition = faCircle;\n    let flip: FlipProp | undefined = undefined;\n    if (isStatic || isSubmit) {\n      return {\n        iconDef,\n        flip\n      };\n    }\n\n    if (isExcluded) {\n      iconDef = faBan;\n      flip = 'horizontal';\n    } else if (state == StepStateEnum.COMPLETED) {\n      iconDef = faCheckCircle;\n    } else if (state == StepStateEnum.ERROR) {\n      iconDef = faExclamationCircle;\n    }\n    return { iconDef, flip };\n  };\n\n  const getItemClass = (\n    isInProgress: boolean,\n    isStatic: boolean = false\n  ): string => {\n    let liClassName = 'item';\n    if (isInProgress) {\n      liClassName = `${liClassName} pointed `;\n    }\n    if (isStatic) {\n      liClassName = `${liClassName} static`;\n    }\n    return liClassName;\n  };\n\n  const getListItem = (\n    step: Step,\n    isWizard: boolean,\n    isRenderChild = false\n  ): JSX.Element => {\n    if (!step || (step.child && !isRenderChild)) {\n      return <></>;\n    }\n    const renderStepName = (\n      step: Step,\n      isWizard: boolean,\n      callback: Function\n    ): JSX.Element => {\n      if (!step.inProgress && (!isWizard || !!step.final)) {\n        return (\n          <button className=\"btn btn-link\" onClick={() => callback(step)}>\n            {step.title}\n          </button>\n        );\n      } else {\n        return <span>{step.title}</span>;\n      }\n    };\n    const icon = getIcon(step.state, step.excluded, step.static, step.final);\n    const itemClass = getItemClass(step.inProgress, step.static);\n\n    return (\n      <div className={itemClass}>\n        <FontAwesomeIcon icon={icon.iconDef} flip={icon.flip} />\n        {renderStepName(step, isWizard, props.onStepChange)}\n      </div>\n    );\n  };\n\n  return (\n    <div\n      className=\"SRC-menuLayout json-forms-menu\"\n      style={{ flex: '1' }}\n    >\n      <ul>\n        {nonChildSteps.map((step: Step, i: number) => {\n          return (\n            <li className=\"item-wrap\" key={i + step.id}>\n              {getListItem(step, !!props.isWizardMode)}\n              {step.children && step.children.length > 0 && (\n                <div className=\"subMenu\">\n                  <ul>\n                    {step.children &&\n                      step.children.map((stepChildId: string, j: number) => {\n                        const childStep = props.stepList.find(\n                          step => step.id === stepChildId\n                        );\n                        return typeof childStep === 'undefined' ? (\n                          <></>\n                        ) : (\n                          <li className=\"item-wrap\" key={j + stepChildId}>\n                            {getListItem(childStep, !!props.isWizardMode, true)}\n                          </li>\n                        );\n                      })}\n                  </ul>\n                </div>\n              )}\n            </li>\n          );\n        })}\n      </ul>\n    </div>\n  );\n}\n","import * as React from 'react'\nimport { Step, NavActionEnum } from './types'\nimport {\n  faChevronLeft,\n  faChevronRight,\n} from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nexport interface NavButtonsProps {\n  isWizardMode?: boolean\n  previousStepIds: string[]\n  onNavAction: Function\n  steps: Step[]\n  currentStep: Step\n  isFormSubmitted?: boolean\n}\n\nexport interface NextStepLinkProps {\n  onNavAction: Function\n  steps: Step[]\n  nextStepId: string | undefined\n}\n\nexport function NavButtons(props: NavButtonsProps): JSX.Element {\n  // in wizard mode we build an array of the previous steps. In regular mode back goes to\n  // a previous order step\n  const canGoBack = (props: NavButtonsProps): boolean => {\n    if (props.isWizardMode) {\n      return props.previousStepIds && props.previousStepIds.length > 0\n    } else {\n      return props.steps.findIndex(step => step.id === props.currentStep.id) > 0\n    }\n  }\n\n  const previousButton = canGoBack(props) ? (\n    <button\n      type=\"button\"\n      onClick={e => props.onNavAction(NavActionEnum.PREVIOUS)}\n      className=\"btn btn-link nav-link prev\"\n    >\n      <FontAwesomeIcon icon={faChevronLeft} />\n    </button>\n  ) : (\n    <></>\n  )\n\n  const nextButton = !props.currentStep.final ? (\n    <button\n      type=\"button\"\n      onClick={e => props.onNavAction(NavActionEnum.NEXT)}\n      className=\"btn btn-link nav-link next\"\n    >\n      <FontAwesomeIcon icon={faChevronRight} />\n    </button>\n  ) : (\n    <></>\n  )\n\n  const saveButton = (\n    <button\n      type=\"button\"\n      className=\"btn btn-action save\"\n      disabled={props.isFormSubmitted}\n      onClick={e => props.onNavAction(NavActionEnum.SAVE)}\n    >\n      SAVE\n    </button>\n  )\n\n  return (\n    <div>\n      <hr></hr>\n      <div className=\"buttonWrapper pull-right\">\n        {previousButton} {nextButton} {saveButton}\n      </div>\n    </div>\n  )\n}\n\nexport function NextStepLink(props: NextStepLinkProps): JSX.Element {\n  const nextStep = props.steps.find(step => step.id === props.nextStepId)\n  if (typeof nextStep === 'undefined') {\n    return <></>\n  }\n  return (\n    <span className=\"nav-link\">\n      <a onClick={e => props.onNavAction(nextStep)}>{nextStep.title}</a>\n      <FontAwesomeIcon icon={faChevronRight}></FontAwesomeIcon>\n    </span>\n  )\n}\n","import * as React from 'react'\n\ninterface DataDebugProps {\n    formSchema: any;\n    formData: any;\n    hidden: boolean;\n}\n\nexport default function DataDebug(props: DataDebugProps) {\n    const myData = <div>\n\n    <h6>Data</h6>\n    <pre>{JSON.stringify(props.formData, null, 2)}</pre>\n    <h6>Schema</h6>\n    <pre>{/*JSON.stringify(props.formSchema, null, 2)*/}</pre>\n    </div>\n    return (<>{!props.hidden &&  myData}</>)\n\n}","import * as React from 'react';\n\nimport { faTrash } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { SummaryFormat, Step } from './types';\nimport _ from 'lodash';\n\nexport interface SummaryTableProps {\n  isWizard?: boolean;\n  formData: any;\n  callbackFn: Function;\n  steps: Step[];\n}\n\nexport function getFlatData(formData: any, steps: Step[]): SummaryFormat[] {\n  //takes nested json and converts it into flattened item list\n  function flatten(\n    object: any,\n    flattenedObject: any,\n    prefix: string\n  ): string[] {\n    const separator = '.';\n    Object.keys(object).forEach(key => {\n      if (object[key] === null) {\n        flattenedObject[prefix + key] = '';\n      } else if (\n        //if the value is a proper array\n        _.isArray(object[key]) &&\n        !_.isString(object[key]) &&\n        object[key].length > 1\n      ) {\n        for (let i in object[key]) {\n          if (\n            _.isArray(object[key][i]) ||\n            (_.isObject(object[key]) && !_.isString(object[key][i]))\n          ) {\n            flatten(\n              object[key][i],\n              flattenedObject,\n              `${prefix}${key}${separator}${i}${separator}`\n            );\n          } else {\n            flattenedObject[`${prefix}${key}${separator}${i}`] = object[key][i];\n          }\n        }\n      } else if (_.isObject(object[key]) && !_.isDate(object[key])) {\n        flatten(object[key], flattenedObject, `${prefix}${key}${separator}`);\n      } else {\n        flattenedObject[prefix + key] = object[key];\n      }\n    });\n    return flattenedObject;\n  }\n\n  const flatData = flatten(_.cloneDeep(formData), [], '');\n  const flatFormData = _.keys(flatData).map(key => {\n    let val = flatData[key];\n    if (flatData[key] === false) {\n      val = 'false';\n    }\n    if (flatData[key] === true) {\n      val = 'true';\n    }\n    const boundary = key.indexOf('.');\n    return {\n      screen: _.find(steps, { id: key.substring(0, boundary) }),\n      label: key.substring(boundary + 1),\n      value: val\n    };\n  });\n\n  const result = flatFormData\n    .filter(item => item.screen && typeof item.value !== 'undefined')\n    .map(item => {\n      return {\n        label: item.label,\n        value: item.value,\n        screen: item.screen!\n      };\n    })\n    .sort((a, b) => a.screen.order - b.screen.order);\n\n  return result;\n}\n\nexport default function SummaryTable(props: SummaryTableProps): JSX.Element {\n  let flatFormData: SummaryFormat[] = [];\n  flatFormData = getFlatData(_.cloneDeep(props.formData), props.steps);\n  const deleteButton = (screenId: string, isShow?: boolean): JSX.Element => {\n    if (!isShow) {\n      return <></>;\n    }\n    return (\n      <button className=\"btn\" onClick={() => props.callbackFn(screenId)}>\n        <FontAwesomeIcon icon={faTrash} color=\"red\"></FontAwesomeIcon>\n      </button>\n    );\n  };\n\n  let prevScreenId = '';\n  const table = (\n    <>\n      <table className=\"table summary-table-header\">\n        <thead>\n          <tr>\n            <th>Step</th>\n            <th>Data Name</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n      </table>\n\n      <div className=\"scroll-area table-body\">\n        <table className=\"table summary-table\">\n          <tbody>\n            {flatFormData.map((line: SummaryFormat, i: number) => {\n              return (\n                <tr key={i + line.screen.id + line.label}>\n                  <td>\n                    {prevScreenId !== line.screen.id &&\n                      (prevScreenId = line.screen.id) && (\n                        <span>\n                          {line.screen.title}\n                          {deleteButton(line.screen.id, props.isWizard)}\n                        </span>\n                      )}\n                  </td>\n                  <td>{line.label}</td>\n                  <td>{line.value}</td>\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </div>\n    </>\n  );\n\n  return (\n    <>\n      <h4> Your Data </h4>\n      <div className=\"panel panel-default padding-full wrap\">\n        <div className=\"summary scroll-area\">{table}</div>\n      </div>\n    </>\n  );\n}\n","import React from 'react';\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\n\nexport type WarningModalProps = {\n  title: string\n  copy: string | JSX.Element\n  confirmCopy?: string\n  className?: string\n  show: boolean\n  onOK: Function\n  onCancel: Function\n  callbackArgs: any\n}\n\nexport default function WarningModal(props: WarningModalProps) {\n \n  return (\n    <Modal show={props.show} animation={false} className={props.className}>\n      <Modal.Header closeButton={false} onHide={() => props.onCancel()}>\n        <Modal.Title>{props.title}</Modal.Title>\n      </Modal.Header>\n      <Modal.Body>{props.copy}</Modal.Body>\n      <Modal.Footer>\n        <Button variant=\"secondary\" onClick={() => props.onCancel()}>\n          Cancel\n        </Button>\n        <Button variant=\"success\" onClick={() => props.onOK(...props.callbackArgs)}>\n          <span>{props.confirmCopy || 'OK'}</span>\n        </Button>\n      </Modal.Footer>\n    </Modal>\n  );\n}\n\n","import './DrugUploadTool.scss'\n\nimport * as React from 'react'\nimport _ from 'lodash'\nimport { Engine } from 'json-rules-engine'\nimport {\n  default as Form,\n  UiSchema,\n  AjvError,\n  ErrorListProps,\n} from 'react-jsonschema-form'\n\nimport { Step, StepStateEnum, NavActionEnum, StatusEnum } from './types'\nimport Header from './Header'\nimport StepsSideNav from './StepsSideNav'\nimport { NavButtons, NextStepLink } from './NavButtons'\nimport DataDebug from './DataDebug'\nimport SummaryTable from './SummaryTable'\nimport WarningModal from './WarningModal'\nimport Switch from 'react-switch'\nimport { Prompt } from 'react-router-dom'\n\nexport type FormSchema = {\n  properties?: any\n  definitions?: any\n}\n\nexport interface IFormData {\n  [screen_name: string]: {\n    included?: boolean\n  }\n}\n\nexport type DrugUploadFormProps = {\n  schema: FormSchema\n  uiSchema: UiSchema\n  navSchema: {\n    steps: any[]\n  }\n  formData: IFormData\n  onSubmit: Function\n  onSave: Function\n  formTitle: string\n  formClass?: string\n  isWizardMode?: boolean\n  callbackStatus?: StatusEnum\n}\n\ntype DrugUploadFormState = {\n  formData: IFormData // form data that prepopulates the form\n  currentStep: Step\n  nextStep?: Step\n  steps: Step[]\n  previousStepIds: string[]\n  hasValidated?: boolean //validation has been called and it passed\n  doShowErrors: boolean //if we should show error summary at the top of the page\n  doShowHelp: boolean\n  modalContext?: { action: Function; arguments: any[] }\n  hasUnsavedChanges: boolean\n  isSubmitted?: boolean\n}\n\ntype RulesEvent = {\n  type: string\n  params: {\n    next: string\n  }\n}\n\ntype RulesResult = {\n  events: RulesEvent[]\n}\n\nexport interface SummaryFormat {\n  label: string\n  value: string\n}\n\nexport default class DrugUploadForm extends React.Component<\n  DrugUploadFormProps,\n  DrugUploadFormState\n> {\n  excludeWarningText = `This action will clear the entire contents of this page. Only this page will be effected.\n  Are you sure you want to clear the data enterred on this page?`\n  excludeWarningHeader = `Clear Entered Data`\n  unsavedDataWarning = `You might have some unsaved data. Are you sure you want to leave?`\n  formRef: any //ref to form for submission\n  navAction: NavActionEnum = NavActionEnum.NONE\n  uiSchema: {}\n  nextStep: Step | undefined\n\n  constructor(props: DrugUploadFormProps) {\n    super(props)\n\n    //will modify the ui:help to render html vs text\n    this.uiSchema = stringToElementForProp(\n      _.cloneDeep(props.uiSchema),\n      'ui:help',\n    )\n    //create steps array from the navSchema\n    const steps = props.navSchema.steps\n      .map((step, i) => {\n        return {\n          ...step,\n          inProgress: i === 0 ? true : false,\n        }\n      })\n      .sort((a, b) => a.order - b.order)\n\n    this.formRef = React.createRef()\n    this.state = {\n      currentStep: steps[0],\n      steps: steps,\n      previousStepIds: [],\n      formData: props.formData,\n      doShowErrors: false,\n      doShowHelp: true,\n      hasUnsavedChanges: false,\n    }\n  }\n\n  onUnload = (ev: any) => {\n    {\n      if (this.state.hasUnsavedChanges) {\n        ev.preventDefault()\n        return (ev.returnValue = this.unsavedDataWarning)\n      }\n      return\n    }\n  }\n  // Setup the `beforeunload` event listener\n  setupBeforeUnloadListener = () => {\n    window.addEventListener('beforeunload', this.onUnload)\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('beforeunload', this.onUnload)\n  }\n\n  componentDidUpdate(prevProps: DrugUploadFormProps) {\n    const shouldUpdate = this.props.callbackStatus !== prevProps.callbackStatus\n    const isSuccess =\n      this.props.callbackStatus === StatusEnum.SAVE_SUCCESS ||\n      this.props.callbackStatus === StatusEnum.SUBMIT_SUCCESS\n    if (shouldUpdate && isSuccess) {\n      this.setState({ hasUnsavedChanges: false })\n      if (this.props.callbackStatus === StatusEnum.SUBMIT_SUCCESS) {\n        this.setState({ isSubmitted: true })\n        window.history.back()\n      }\n    }\n  }\n\n  componentDidMount() {\n    this.setupBeforeUnloadListener()\n    if (_.isEmpty(this.state.formData) && !this.props.isWizardMode) {\n      const result = {}\n      const defs = this.props.schema.definitions\n      Object.keys(defs).forEach((key: string) => {\n        if (\n          defs[key].properties &&\n          Object.keys(defs[key].properties).indexOf('included') > -1\n        ) {\n          _.set(result, `${key}.included`, true)\n        }\n      })\n      this.setState({ formData: result })\n    }\n  }\n\n  // get the schema slice for the current screen/step\n  getSchema = ({ id, final }: Step): FormSchema => {\n    if (final) {\n      return this.props.schema\n    }\n    //only get schema for current step. Only the portion of entire form is shown\n    // we need all the definitions bacuse we can have fieldset references there\n    const currentStepSlice = _.pick(this.props.schema, [\n      'definitions',\n      'title',\n      'type',\n      `properties.${id}`,\n    ])\n    return currentStepSlice\n  }\n\n  // find the next step\n  getNextStepId = async (\n    currentStep: Step,\n    formData: any,\n    nextStepId?: string,\n  ): Promise<string> => {\n    if (nextStepId) {\n      return nextStepId\n    }\n    if (!currentStep.rules || currentStep.rules.length === 0) {\n      return currentStep.default\n    }\n\n    // if there are rules - run the engine and go to the first next step\n    let engine = new Engine(currentStep.rules)\n\n    try {\n      const result: RulesResult = await engine.run(formData)\n      if (result.events.length > 0) {\n        return result.events[0].params.next\n      } else {\n        return currentStep.default\n      }\n    } catch (error) {\n      return currentStep.default\n    }\n  }\n\n  // called when going next, previous or a given step\n  moveStep = async (\n    formData: any,\n    nextStepId: string | undefined,\n    isError: boolean,\n    previousStack = [...this.state.previousStepIds],\n  ) => {\n    const currentStep = this.state.currentStep\n    let currentStepState: StepStateEnum\n    //we don't wnat to display errors on the page - this will be done explicitly in validation\n    this.formRef.current.setState({ errorSchema: {} })\n    //in wizard mode we can only move forwards (don't know next step yet) or backwards (do know next step)\n    const isMoveForwardInWizardMode = this.props.isWizardMode && !nextStepId\n\n    //previousStack is used for 'back' navigation is wizard mode.\n    //only need to do it if moving forward i.e. nextStepId is undefined\n    if (isMoveForwardInWizardMode) {\n      previousStack.push(currentStep.id)\n    }\n\n    if (!isError) {\n      currentStepState = StepStateEnum.COMPLETED\n\n      if (!isMoveForwardInWizardMode && this.props.isWizardMode) {\n        currentStepState = StepStateEnum.TODO\n      }\n    } else {\n      currentStepState = StepStateEnum.ERROR\n    }\n    // determine next step\n    nextStepId = await this.getNextStepId(currentStep, formData, nextStepId)\n\n    const steps = this.state.steps.map(step => {\n      if (step.id === currentStep.id) {\n        return {\n          ...step,\n          ...{ state: currentStepState, inProgress: false },\n        }\n      } else if (step.id === nextStepId) {\n        return { ...step, ...{ inProgress: true } }\n      }\n      return step\n    })\n    //if we are in wizard mode we want to make sure that we include the step we are about to go to\n    if (isMoveForwardInWizardMode) {\n      _.set(formData, `${nextStepId}.included`, true)\n    }\n\n    //at this point the form is valid and submitted and the data reflects the latest\n    const nextStep = this.state.steps.find(step => step.id === nextStepId)!\n    // clean up unused screens in wizard before getting to submit\n    if (this.props.isWizardMode && nextStep.final) {\n      Object.keys(formData).forEach(key => {\n        if (formData[key].included === undefined) {\n          formData[key] = {}\n        }\n      })\n    }\n\n    this.saveStepState(previousStack, steps, nextStep!, formData)\n  }\n\n  //save the state of the current screen\n  saveStepState = (\n    previousStepIds: string[],\n    steps: Step[],\n    currentStep: Step,\n    formData: any,\n  ) => {\n    this.setState({\n      previousStepIds,\n      steps,\n      currentStep,\n      formData,\n      hasValidated: false,\n      doShowErrors: false,\n    })\n  }\n\n  //--------- fns to support navigation --------------------//\n  goPrevious = async (formData: any, isError: boolean) => {\n    let previousStepId: string | undefined\n    const previousStack: string[] = [...this.state.previousStepIds]\n    // in wizard mode we go to the previously visited screen.\n    // In regular mode go to the screen with previous index\n    if (this.props.isWizardMode) {\n      previousStepId = previousStack.pop()\n      if (!this.isSubmitScreen()) {\n        //since we don't know if we'll get back to that step again - exclude it. We will include it again if we\n        // get to it.\n        _.set(formData, `${this.state.currentStep.id}.included`, undefined)\n      }\n    } else {\n      const currentIndex = _.findIndex(this.state.steps, {\n        id: this.state.currentStep.id,\n      })\n      if (currentIndex > 0) {\n        previousStepId = this.state.steps[currentIndex - 1].id\n      }\n    }\n    if (!_.isUndefined(previousStepId)) {\n      return this.moveStep(formData, previousStepId, isError, previousStack)\n    }\n  }\n\n  triggerAction = (navAction: NavActionEnum) => {\n    // we don't need to validate on save so bypassing submit\n    if (navAction === NavActionEnum.SAVE) {\n      return this.props.onSave(this.state.formData)\n    } else {\n      this.navAction = navAction\n      this.formRef.current.submit()\n    }\n  }\n\n  // triggered when we click on the step name in left nav (doesn't happen in wizard mode)\n  triggerStepChange = (step: Step) => {\n    this.nextStep = step\n    this.triggerAction(NavActionEnum.GO_TO_STEP)\n  }\n\n  onError = (args: any) => {\n    this.setState({\n      doShowErrors: true,\n      hasValidated: false,\n    })\n    if (this.navAction === NavActionEnum.VALIDATE) {\n      const modifiedSteps = this.setStepStatusForFailedValidation(\n        args.props,\n        this.state.steps,\n        this.getSchema(this.state.currentStep),\n      )\n      this.setState({ steps: modifiedSteps })\n    }\n  }\n\n  setStepStatusForFailedValidation = (\n    errors: AjvError[],\n    steps: Step[],\n    currentSchemaProperties: any,\n  ): Step[] => {\n    //error property is in the format: step.somevalue.etc  .welcome.submission_name example\n    //find all the steps where there is an error\n    const stepsWithError = errors.map(\n      error => _.trimStart(error.property, '.').split('.')[0],\n    )\n    //find all steps in current schema\n    const stepsInCurrentSchema = Object.keys(currentSchemaProperties)\n    const updatedSteps: Step[] = steps.map(step => {\n      if (stepsWithError.indexOf(step.id) > -1) {\n        return {\n          ...step,\n          state: StepStateEnum.ERROR,\n        }\n      } else if (stepsInCurrentSchema.indexOf(step.id) > -1) {\n        return {\n          ...step,\n          state: StepStateEnum.COMPLETED,\n        }\n      } else {\n        return step\n      }\n    })\n    return updatedSteps\n  }\n\n  //we are constantly saving form data. Needed to overwrite on-error behavior\n  handleOnChange({ formData }: any) {\n    //this is just for form updates. submit screen goes different route\n    if (!this.isSubmitScreen()) {\n      const hasUnsavedChanges = !_.isEqual(this.state.formData, formData)\n      this.setState({ formData, hasUnsavedChanges })\n    }\n  }\n\n  performAction(navAction: NavActionEnum, hasError: boolean) {\n    const formData = this.state.formData\n\n    switch (navAction) {\n      case NavActionEnum.NEXT: {\n        return this.moveStep(formData, undefined, hasError)\n      }\n      case NavActionEnum.PREVIOUS: {\n        return this.goPrevious(formData, hasError)\n      }\n      case NavActionEnum.GO_TO_STEP: {\n        //nextStep is returned when clicked on the Steps left nav\n        if (!this.nextStep) {\n          return\n        }\n        return this.moveStep(formData, this.nextStep.id, hasError)\n      }\n\n      case NavActionEnum.SUBMIT: {\n        this.props.onSubmit(formData)\n      }\n      case NavActionEnum.VALIDATE: {\n        //we get here is we clicked validate and the data is valid.\n        // if it's not valid we handle it in onError fn\n        const currentStep = {\n          ...this.state.currentStep,\n          state: StepStateEnum.COMPLETED,\n        }\n        const steps = this.state.steps.map(step => {\n          return {\n            ...step,\n            state:\n              step.id === currentStep.id ? StepStateEnum.COMPLETED : step.state,\n          }\n        })\n\n        this.setState({ hasValidated: true, currentStep, steps })\n      }\n      default:\n        return\n    }\n  }\n\n  //we need to route things through submit - otherwise validation does not kick in\n  // it triggers internal library validation and calls the performAction with the params for action\n  onSubmit = (): any => {\n    this.performAction(\n      this.navAction,\n      this.state.currentStep.state === StepStateEnum.ERROR,\n    )\n  }\n\n  isSubmitScreen = (): boolean => {\n    return this.state.currentStep.final === true\n  }\n\n  showExcludeStateWarningModal = (\n    stepId: string,\n    isUpdateFlattenedData: boolean = false,\n  ): void => {\n    this.setState({\n      modalContext: {\n        action: this.toggleExcludeStep,\n        arguments: [stepId, true, isUpdateFlattenedData],\n      },\n    })\n  }\n\n  toggleExcludeStep = (stepId: string, isExclude: boolean): void => {\n    this.setState((prevState, props) => {\n      const steps = prevState.steps.map(stp => {\n        if (stp.id === stepId) {\n          return { ...stp, ...{ excluded: isExclude } }\n        }\n        return stp\n      })\n\n      const formDataUpdated = _.cloneDeep(prevState.formData)\n      const currentStep = _.cloneDeep(prevState.currentStep)\n      //we need this because you can exclude on the ifnal screen so the currentStep.id\n      //is not always the one we need to exclude\n      if (currentStep.id === stepId) {\n        currentStep.excluded = isExclude\n      }\n      //if exluding - blow away the data for the step\n      if (isExclude) {\n        formDataUpdated[stepId] = {}\n        //_.set(formDataUpdated, `${stepId}.included`, false);\n      } else {\n        _.set(formDataUpdated, `${stepId}.included`, true)\n      }\n      return {\n        steps,\n        formData: formDataUpdated,\n        modalContext: undefined,\n        currentStep,\n      }\n    })\n  }\n\n  private renderNotification = (status?: StatusEnum): JSX.Element => {\n    if (status === StatusEnum.SAVE_SUCCESS) {\n      return <div className=\"notification-area\"> Successfully saved </div>\n    }\n    if (status === StatusEnum.SUBMIT_SUCCESS) {\n      return <div className=\"notification-area\"> Successfully submitted </div>\n    }\n    if (status === StatusEnum.PROGRESS) {\n      return <div className=\"notification-area\"> working on it ....</div>\n    }\n    return <></>\n  }\n\n  // displays the text for screens that don't have any form data\n  private renderTextForStaticScreen = (): JSX.Element => {\n    if (!this.state.currentStep.copy) {\n      return <></>\n    }\n    const copy = this.state.currentStep.copy\n    return (\n      <div\n        className=\"static-screen\"\n        dangerouslySetInnerHTML={{ __html: copy! }}\n      />\n    )\n  }\n\n  //displays subheader for forms that can be excluded\n  renderOptionalFormSubheader = (isWizard: boolean = false): JSX.Element => {\n    if (isWizard) {\n      return <></>\n    }\n    const currentStep = this.state.currentStep\n\n    if (currentStep.excluded === true) {\n      return (\n        <div className=\"step-exclude-directions\">\n          This sub-form is currently not included in the submission.\n          <button\n            className=\"btn btn-link\"\n            onClick={() => this.toggleExcludeStep(currentStep.id, false)}\n          >\n            INCLUDE\n          </button>\n        </div>\n      )\n    } else if (currentStep.excluded === false) {\n      return (\n        <div className=\"step-exclude-directions\">\n          This sub-form is currently included in the submission.{' '}\n          <button\n            className=\"btn btn-link\"\n            onClick={() =>\n              this.showExcludeStateWarningModal(this.state.currentStep.id)\n            }\n          >\n            EXCLUDE\n          </button>\n        </div>\n      )\n    }\n    return <></>\n  }\n\n  renderHelpToggle = (\n    currentStep: Step,\n    showHelp: boolean,\n    callbackFn: Function,\n  ): JSX.Element => {\n    if (currentStep.static || currentStep.final) {\n      return <></>\n    }\n    return (\n      <>\n        <label className=\"pull-right toggle-help-label\">\n          <span>Hide help</span>\n          <Switch\n            checkedIcon={false}\n            uncheckedIcon={false}\n            height={20}\n            width={45}\n            className=\"toggle-help\"\n            offColor=\"#ccc\"\n            onColor=\"#5960a5\"\n            onChange={() => callbackFn()}\n            checked={showHelp}\n          />\n          <span>Show help</span>\n        </label>\n      </>\n    )\n  }\n\n  transformErrors = (errors: AjvError[]): AjvError[] => {\n    // if we are not in wizard mode and not trying to submit or validate we just want to skip\n    // over the errors and just set the step status\n    // https://github.com/rjsf-team/react-jsonschema-form/issues/1263\n\n    if (\n      this.navAction !== NavActionEnum.SUBMIT &&\n      this.navAction !== NavActionEnum.VALIDATE &&\n      (!this.props.isWizardMode || this.state.currentStep.final)\n    ) {\n      const currentStep = {\n        ...this.state.currentStep,\n      }\n      if (errors.length > 0) {\n        currentStep.state = StepStateEnum.ERROR\n      } else {\n        currentStep.state = StepStateEnum.COMPLETED\n      }\n\n      this.setState({ currentStep })\n\n      return []\n    }\n\n    // there is an odd behavior in the lib that in cases when we have additional fields depending on enum\n    // value if it's required and not entered we get 3 error: enum, required, and oneOf\n    // so if there is an error Oneof on a parent - ignore it and enum on a child. and just output 'required'\n    // if there is an enum error and there is required with the same prefix remove it\n\n    const reqErrors = errors.filter(error => error.name === 'required')\n    reqErrors.forEach(error => {\n      const parentPath = error.property.substring(\n        0,\n        error.property.lastIndexOf('.'),\n      )\n      _.remove(errors, (error: AjvError) => {\n        return (\n          error.property.indexOf(parentPath) > -1 &&\n          (error.name === 'enum' || error.name === 'oneOf')\n        )\n      })\n    })\n    return errors\n  }\n\n  renderErrorListTemplate = (props: ErrorListProps) => {\n    let { errors } = props\n    const currentLis = errors.map((error, i) => {\n      return renderTransformedErrorObject(\n        this.state.steps,\n        error,\n        this.uiSchema,\n        i,\n        this.props.schema,\n      )\n    })\n\n    return (\n      <div className=\"form-error-summary\">\n        <ul className=\"error-detail\">{currentLis}</ul>\n      </div>\n    )\n  }\n\n  render() {\n    return (\n      <div className=\"outter-wrap\">\n        <Prompt\n          when={this.state.hasUnsavedChanges}\n          message={this.unsavedDataWarning}\n        />\n        <Header\n          bodyText={this.state.currentStep.description}\n          title={this.props.formTitle}\n        ></Header>\n        <div>\n          <div className=\"inner-wrap\">\n            <StepsSideNav\n              stepList={this.state.steps}\n              isWizardMode={this.props.isWizardMode}\n              onStepChange={this.triggerStepChange}\n            ></StepsSideNav>\n            <div className=\"form-wrap\">\n              <div className=\"form-title\">{this.state.currentStep.title}</div>\n              {this.renderNotification(this.props.callbackStatus)}\n              <div className=\"right-top-actions\">\n                {!this.state.currentStep.static && (\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-action save pull-right\"\n                    onClick={() => this.triggerAction(NavActionEnum.VALIDATE)}\n                  >\n                    VALIDATE\n                  </button>\n                )}\n                {this.renderHelpToggle(\n                  this.state.currentStep,\n                  this.state.doShowHelp,\n                  () =>\n                    this.setState({\n                      doShowHelp: !this.state.doShowHelp,\n                    }),\n                )}\n                {this.isSubmitScreen() && (\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-action save pull-right\"\n                    disabled={this.state.isSubmitted}\n                    onClick={() => this.triggerAction(NavActionEnum.SUBMIT)}\n                  >\n                    SUBMIT\n                  </button>\n                )}\n              </div>\n              {this.renderOptionalFormSubheader(this.props.isWizardMode)}\n              <div\n                className={this.isSubmitScreen() ? 'hide-form-only' : 'wrap'}\n              >\n                {this.state.hasValidated && (\n                  <div className=\"notification-area\">\n                    Great! Your data is valid!\n                  </div>\n                )}\n                <div\n                  className={`scroll-area ${\n                    this.state.currentStep.excluded ? 'disabled' : ' '\n                  } `}\n                >\n                  <Form\n                    className={\n                      this.state.doShowHelp\n                        ? 'submissionInputForm'\n                        : 'submissionInputForm no-help'\n                    }\n                    liveValidate={false}\n                    formData={this.state.formData}\n                    schema={this.getSchema(this.state.currentStep)}\n                    uiSchema={this.uiSchema}\n                    onSubmit={this.onSubmit}\n                    onChange={args => this.handleOnChange(args)}\n                    onError={args =>\n                      this.onError({\n                        props: args,\n                        form: this.formRef,\n                      })\n                    }\n                    showErrorList={\n                      !!this.state.doShowErrors || !!this.props.isWizardMode\n                    }\n                    ErrorList={this.renderErrorListTemplate}\n                    transformErrors={this.transformErrors}\n                    ref={this.formRef}\n                    disabled={\n                      this.state.currentStep.excluded || this.state.isSubmitted\n                    }\n                  >\n                    <div style={{ display: 'none' }}>\n                      <button type=\"submit\"></button>\n                    </div>\n                  </Form>\n                  {this.renderTextForStaticScreen()}\n                  {!this.props.isWizardMode && (\n                    <NextStepLink\n                      steps={this.state.steps}\n                      nextStepId={this.state.currentStep.default}\n                      onNavAction={(step: Step) => this.triggerStepChange(step)}\n                    ></NextStepLink>\n                  )}\n                </div>\n              </div>\n\n              {this.isSubmitScreen() && (\n                <SummaryTable\n                  formData={this.state.formData}\n                  isWizard={this.props.isWizardMode}\n                  steps={this.state.steps}\n                  callbackFn={(screenId: string) =>\n                    this.showExcludeStateWarningModal(screenId, true)\n                  }\n                ></SummaryTable>\n              )}\n\n              <NavButtons\n                currentStep={this.state.currentStep}\n                steps={this.state.steps}\n                previousStepIds={this.state.previousStepIds}\n                isFormSubmitted={this.state.isSubmitted}\n                onNavAction={(e: NavActionEnum) => this.triggerAction(e)}\n              ></NavButtons>\n            </div>\n          </div>\n        </div>\n        {this.state.modalContext && (\n          <WarningModal\n            show={true}\n            title={this.excludeWarningHeader}\n            copy={this.excludeWarningText}\n            className={this.props.formClass}\n            callbackArgs={this.state.modalContext.arguments}\n            onCancel={() => this.setState({ modalContext: undefined })}\n            onOK={(stepId: string, isExclude: boolean) =>\n              this.toggleExcludeStep(stepId, isExclude)\n            }\n          ></WarningModal>\n        )}\n        <DataDebug\n          formSchema={this.getSchema(this.state.currentStep)}\n          formData={this.state.formData}\n          hidden={false}\n        ></DataDebug>\n      </div>\n    )\n  }\n}\n\n// takes in a single validation error and  and displays it in more readable manner\n// used by renderErrorListTemplate\nfunction renderTransformedErrorObject(\n  steps: Step[],\n  error: AjvError,\n  uiSchema: UiSchema,\n\n  i: number,\n  schema: any,\n): JSX.Element {\n  const propPath = _.trimStart(error.property, '.')\n  const propArr = propPath.split('.')\n\n  // some things require labels in schema (e.g. checkboxes) so this is preferred\n  const labelFromSchema = `${propArr.join('.properties.')}.title`\n  //can be overriden by label in UI\n  const regLabelFromUi = `${propPath}.ui:title`\n  //for array fields we need to change the property e.g.\n  //  ld50.experiments[0].species_other should look like 'ld50.experiments.items.species_other'\n  const arrayLabelFromUi = regLabelFromUi.replace(/\\[.*?\\]/, '.items')\n\n  let label =\n    _.get(schema.definitions, labelFromSchema) ||\n    _.get(uiSchema, regLabelFromUi) ||\n    _.get(uiSchema, arrayLabelFromUi) ||\n    error.property\n\n  const screen = _.find(steps, { id: propArr[0] }) || {\n    title: propArr[0],\n  }\n  const element = (\n    <li key={i} className=\"\">\n      <span>\n        <strong>{screen.title}: </strong>\n        {label}&nbsp; {error.message}\n      </span>\n    </li>\n  )\n  return element\n}\n\n//recursively sets property value to dangerouslySetInnerHTML of that value\nfunction stringToElementForProp(srcObject: any, key: string): object {\n  _.keys(srcObject).some(k => {\n    if (k === key) {\n      const value = srcObject[k]\n      srcObject[k] = <span dangerouslySetInnerHTML={{ __html: value }}></span>\n\n      return srcObject\n    }\n    if (srcObject[k] && typeof srcObject[k] === 'object') {\n      stringToElementForProp(srcObject[k], key)\n    }\n  })\n  return srcObject\n}\n","//https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormGroup.html\nexport type FormGroup = {\n  groupId: string\n  name: string\n  createdBy: string\n  createdOn: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormData.html\nexport type FormData = {\n  formDataId: string\n  etag: string\n  groupId: string\n  name: string\n  createdBy: string\n  createdOn: string\n  modifiedOn: string\n  dataFileHandleId:string\n  submissionStatus: SubmissionStatus\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormChangeRequest.html\nexport type FormChangeRequest = {\n  name: string\n  fileHandleId: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/FormRejection.html\nexport type FormRejection = {\n  reason: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/SubmissionStatus.html\nexport type SubmissionStatus = {\n  submittedOn: string,\n  reviewedOn: string,\n  reviewedBy: string,\n  state: StatusEnum,\n  rejectionMessage: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/StatusEnum.html\nexport enum StatusEnum {\n  WAITING_FOR_SUBMISSION = 'WAITING_FOR_SUBMISSION',\n  SUBMITTED_WAITING_FOR_REVIEW = 'SUBMITTED_WAITING_FOR_REVIEW',\n  ACCEPTED = 'ACCEPTED', \n  REJECTED = 'REJECTED'\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/ListRequest.html\nexport type ListRequest = {\n  filterByState?: StatusEnum[],\n  groupId: string,\n  nextPageToken?: string\n}\n\n// see https://docs.synapse.org/rest/org/sagebionetworks/repo/model/form/ListResponse.html\nexport type ListResponse = {\n  page: FormData[],\n  nextPageToken?: string\n}\n","import * as React from 'react'\n\nimport { SynapseClient } from '../../utils'\nimport { FileEntity } from '../../utils/jsonResponses/FileEntity'\nimport { UiSchema } from 'react-jsonschema-form'\nimport { StatusEnum } from './types'\nimport Alert from 'react-bootstrap/Alert'\nimport DrugUploadForm from './DrugUploadForm'\nimport { FormData } from '../../utils/jsonResponses/Forms'\nimport { SRC_SIGN_IN_CLASS } from '../../utils/SynapseConstants';\nimport _ from 'lodash'\n\nexport type UploadToolSearchParams = {\n  formDataId?: string //formDataId for user data form data\n  dataFileHandleId?: string //fileHandle to get userData\n  formGroupId: string\n}\n\nexport type DrugUploadToolProps = {\n  // Provide the parent container (folder/project), that should contain a folder (named <user_id>) that this user can write to.\n  formSchemaEntityId: string // Synapse file that contains the form schema.\n  formUiSchemaEntityId: string // Synapse file that contains the form ui schema.\n  formNavSchemaEntityId: string //Synapse file that consists screen nav schema\n  token?: string // user's session token\n  searchParams?: UploadToolSearchParams\n  isWizardMode?: boolean // if we are displaying the form in wizard mode\n  fileNamePath: string // path in data to specify the name of saved file\n  formTitle: string //for UI customization\n  formClass?: string // to support potential theaming\n}\n\ntype DrugUploadToolState = {\n  notification?: Notification\n  isLoading?: boolean\n  formDataId?: string; // file holding user form data\n  formData?: any // form data that prepopulates the form\n  formSchema?: any // schema that drives the form\n  formUiSchema?: UiSchema // ui schema that directs how to render the form elements\n  formNavSchema?: any // drives the steps left panel\n\n  status?: StatusEnum\n}\n\ntype Notification = {\n  name?: string\n  message?: string\n  reason?: string\n  type: StatusEnum\n}\n\nclass DrugUploadTool extends React.Component<\n  DrugUploadToolProps,\n  DrugUploadToolState\n> {\n  constructor(props: DrugUploadToolProps) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      formDataId: _.get(this.props, 'searchParams.formDataId')\n    }\n  }\n\n  async componentDidMount() {\n    await this.getData(this.props.token)\n  }\n\n  async componentDidUpdate(prevProps: DrugUploadToolProps) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      await this.getData(this.props.token)\n    }\n  }\n\n  //gets a file entity with content\n  getFileEntityData = async (\n    token: string,\n    entityId: string,\n  ): Promise<{version?: number, content: JSON}> => {\n    const entity: FileEntity = await SynapseClient.getEntity(token, entityId)\n    const entityContent = await SynapseClient.getFileEntityContent(\n      token,\n      entity,\n    )\n    return { version: entity.versionNumber, content: JSON.parse(entityContent)}\n  }\n\n  getData = async (token?: string): Promise<void> => {\n    if (!token) {\n      return\n    }\n    try {\n      let formData = {}\n      //let currentFileEntity: FileEntity;\n\n      const promises = [\n        this.getFileEntityData(token, this.props.formSchemaEntityId),\n        this.getFileEntityData(token, this.props.formUiSchemaEntityId),\n        this.getFileEntityData(token, this.props.formNavSchemaEntityId),\n      ]\n      const { searchParams } = this.props\n\n      const configData = await Promise.all(promises)\n\n      const dataFileHandleId = searchParams && searchParams.dataFileHandleId\n      if (dataFileHandleId) {\n        const fileData = await SynapseClient.getFileHandleContentFromID(\n          dataFileHandleId,\n          token,\n        )\n        formData = JSON.parse(fileData)\n      } else {\n        //if we are creating a new file - store the versions\n        formData = {\n          metadata: {\n            formSchemaVersion: configData[0].version,\n            uiSchemaVersion: configData[1].version,\n            navSchemaVersion: configData[2].version,\n          }\n        }\n      }\n      this.setState({\n        // currentFileEntity,\n        formData: formData,\n        formSchema: configData[0].content,\n        formUiSchema: configData[1].content,\n        formNavSchema: configData[2].content,\n        isLoading: false,\n      })\n    } catch (error) {\n      this.onError(error)\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  finishedProcessing = (status: StatusEnum, message?: string) => {\n    this.setState({\n      isLoading: false,\n      notification: { type: status, message: message },\n      status: status,\n    })\n    //this will show the update message for 7 seconds\n    setTimeout(() => {\n      this.setState({ status: undefined })\n    }, 7000)\n  }\n\n  onError = (error: any) => {\n    this.setState({\n      notification: {\n        type: StatusEnum.ERROR,\n        message: error.reason,\n        name: error.name,\n      },\n      status: StatusEnum.ERROR,\n      isLoading: false,\n    })\n  }\n\n  submitForm = async (formData: any) => {\n    await this.saveToFile(formData)\n\n    this.setState({\n      isLoading: true,\n    })\n\n    await SynapseClient.submitFormData(this.state.formDataId!, this.props.token)\n    this.finishedProcessing(StatusEnum.SUBMIT_SUCCESS, 'File Submitted')\n  }\n\n  createOrUpdateFormDataFile = async (\n    fileName: string,\n    fileContentsBlob: Blob,\n  ): Promise<FormData> => {\n    fileName = `${fileName}.json`\n    const fileUploadComplete = await SynapseClient.uploadFile(\n      this.props.token,\n      fileName,\n      fileContentsBlob,\n    )\n    const { searchParams } = this.props\n    const formGroupId = searchParams && searchParams.formGroupId\n    if (!formGroupId) {\n      console.error('formGroupId must be defined')\n      throw 'formGroupId must be defined'\n    }\n    try {\n      // do we need to create a new file entity, or update an existing file entity?\n      const newFileHandleId = fileUploadComplete.fileHandleId\n\n      let formData\n      if (this.state.formDataId) {\n        formData = await SynapseClient.updateFormData(\n          this.state.formDataId,\n          fileName,\n          newFileHandleId,\n          this.props.token!,\n        )\n      } else {\n        formData = await SynapseClient.createFormData(\n          formGroupId,\n          fileName,\n          newFileHandleId,\n          this.props.token!,\n        )\n      }\n\n      return formData\n    } catch (error) {\n      this.onError(error)\n      throw error\n    }\n  }\n\n  saveToFile = async (data: any) => {\n    const fileName = _.get(data, this.props.fileNamePath)\n    this.setState({\n      status: StatusEnum.PROGRESS,\n      notification: { type: StatusEnum.PROGRESS, message: 'Progress' },\n      isLoading: true,\n    })\n\n    if (!fileName) {\n      this.onError({ reason: 'Please Provide the File Name' })\n      return\n    }\n\n    try {\n      const fileContent: Blob = new Blob([JSON.stringify(data)], {\n        type: 'text/json',\n      })\n\n      const formData = await this.createOrUpdateFormDataFile(\n        fileName,\n        fileContent,\n      )\n      this.setState({\n        formDataId: formData.formDataId,\n      })\n\n      this.finishedProcessing(StatusEnum.SAVE_SUCCESS, 'File Saved')\n    } catch (error) {\n      this.onError(error)\n    }\n  }\n\n\n  isReadyToDisplayForm = (state: DrugUploadToolState): boolean => {\n    return (\n      this.state.status !== StatusEnum.ERROR_CRITICAL &&\n      state.formSchema &&\n      state.formUiSchema &&\n      state.formNavSchema &&\n      state.formData\n    )\n  }\n\n  renderLoader = (\n    state: DrugUploadToolState,\n    props: DrugUploadToolProps,\n  ): JSX.Element => {\n    if (\n      !_.includes(\n        [StatusEnum.ERROR, StatusEnum.ERROR_CRITICAL],\n        state.status,\n      ) &&\n      props.token &&\n      state.isLoading\n    ) {\n      return (\n        <div className=\"text-center\">\n          <span className={'spinner'} />\n        </div>\n      )\n    } else {\n      return <></>\n    }\n  }\n\n  renderNotification = (notification?: Notification): JSX.Element => {\n    if (!notification) {\n      return <></>\n    }\n    if (notification.type === StatusEnum.ERROR) {\n      return (\n        <Alert\n          variant=\"danger\"\n          onClose={() => this.setState({ status: undefined })}\n          dismissible\n        >\n          <Alert.Heading>Error</Alert.Heading>\n\n          <p>{notification.message}</p>\n        </Alert>\n      )\n    }\n\n    return <></>\n  }\n\n  renderUnauthenticatedView = (token: string | undefined) => {\n    if (token) {\n      return <></>\n    } else {\n      return (\n        <div className=\"panel padding-full unauthenticated text-center\">\n          Please <button className={`SRC-standard-button-shape SRC-light-button SRC-sign-in-button ${SRC_SIGN_IN_CLASS}`}> sign in </button> to initiate or continue your submission{' '}\n        </div>\n      )\n    }\n  }\n\n  render() {\n    return (\n      <div className={`SRC-ReactJsonForm ${this.props.formClass}`}>\n        {this.renderNotification(this.state.notification)}\n        {this.renderLoader(this.state, this.props)}\n        {this.renderUnauthenticatedView(this.props.token)}\n\n        {this.isReadyToDisplayForm(this.state) && (\n          <div>\n            <DrugUploadForm\n              schema={this.state.formSchema}\n              uiSchema={this.state.formUiSchema!}\n              formData={this.state.formData}\n              navSchema={this.state.formNavSchema}\n              isWizardMode={this.props.isWizardMode}\n              formTitle={this.props.formTitle}\n              formClass={this.props.formClass}\n              callbackStatus={this.state.status}\n              onSave={(data: any) => this.saveToFile(data)}\n              onSubmit={(data: any) => this.submitForm(data)}\n            ></DrugUploadForm>\n          </div>\n        )}\n      </div>\n    )\n  }\n}\n\nexport default DrugUploadTool\n","// Alina TODO:\n//  - pagination and scroll\n// - submission\n\nimport './DrugUploadTool.scss'\n\nimport * as React from 'react'\n\nimport { SynapseClient } from '../../utils'\nimport {\n  FormData,\n  ListRequest,\n  StatusEnum,\n  ListResponse,\n} from '../../utils/jsonResponses/Forms'\nimport { faTrash, faPhone } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport WarningModal from './WarningModal'\nimport Button from 'react-bootstrap/Button'\nimport Modal from 'react-bootstrap/Modal'\n\nimport moment from 'moment'\nimport { SRC_SIGN_IN_CLASS } from '../../utils/SynapseConstants'\nimport NoSubmissionsIcon from '../../assets/icons/json-form-tool-no-submissions.svg'\n\nexport type UserFileGridProps = {\n  token?: string\n  formGroupId: string\n  pathpart: string\n  formClass?: string\n  itemNoun: string\n}\n\ntype UserFileGridState = {\n  inProgress: {\n    fileList: FormData[]\n    nextPageToken?: string\n  }\n  submitted: {\n    fileList: FormData[]\n    nextPageToken?: string\n  }\n  isLoading: boolean\n  isShowInfoModal: boolean\n  modalContext?: { action: Function; arguments: any[] }\n}\n\nexport default class UserFileGrid extends React.Component<\n  UserFileGridProps,\n  UserFileGridState\n> {\n  modalTitle = 'Trash Submission?'\n  listingText = {\n    inProgress: {\n      subhead: 'In Progress',\n      noRecords: `You don't have submissions in progress`,\n    },\n    submitted: {\n      subhead: 'Submitted',\n      noRecords: `You don't have anything submitted`,\n    },\n  }\n  modalCopy = (\n    <>\n      <p>\n        This submission is currently incomplete and has not been submitted. If\n        you trash this submission, you won't be able to recover the data.\n      </p>\n      <p>Are you sure you want to trash this submission?' </p>\n    </>\n  )\n\n  constructor(props: UserFileGridProps) {\n    super(props)\n    this.state = {\n      isLoading: true,\n      isShowInfoModal: false,\n      inProgress: {\n        fileList: [],\n      },\n      submitted: {\n        fileList: [],\n      },\n    }\n  }\n\n  async componentDidMount() {\n    await this.refresh(this.props.token)\n  }\n\n  async componentDidUpdate(prevProps: UserFileGridProps) {\n    const shouldUpdate = this.props.token !== prevProps.token\n    if (shouldUpdate) {\n      await this.refresh(this.props.token)\n    }\n  }\n\n  async refresh(token?: string) {\n    if (token) {\n      await this.getUserFileListing(token, this.props.formGroupId).catch(\n        error => {\n          this.onError(error)\n        },\n      )\n    }\n  }\n\n  getUserFileListing = async (\n    token: string,\n    groupId: string,\n  ): Promise<{ inProgress: FormData[]; submitted: FormData[] }> => {\n    this.setState({\n      isLoading: true,\n    })\n    try {\n      const requestInProgress: ListRequest = {\n        filterByState: [StatusEnum.WAITING_FOR_SUBMISSION],\n        groupId,\n        nextPageToken: this.state.inProgress.nextPageToken,\n      }\n      const requestSubmitted: ListRequest = {\n        filterByState: [\n          StatusEnum.SUBMITTED_WAITING_FOR_REVIEW,\n          StatusEnum.ACCEPTED,\n          StatusEnum.REJECTED,\n        ],\n        groupId,\n        nextPageToken: this.state.submitted.nextPageToken,\n      }\n\n      const listInProgress: ListResponse = await SynapseClient.listFormData(\n        requestInProgress,\n        token,\n      )\n      const listSubmitted: ListResponse = await SynapseClient.listFormData(\n        requestSubmitted,\n        token,\n      )\n      this.setState({\n        inProgress: {\n          fileList: listInProgress.page,\n          nextPageToken: listInProgress.nextPageToken,\n        },\n        submitted: {\n          fileList: listSubmitted.page,\n          nextPageToken: listSubmitted.nextPageToken,\n        },\n      })\n      return {\n        inProgress: listInProgress.page || [],\n        submitted: listSubmitted.page || [],\n      }\n    } catch (error) {\n      this.onError(error)\n      return Promise.reject(error)\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n  onError = (args: any) => {\n    console.log(args)\n  }\n\n  deleteFile = async (token: string, formDataId: string): Promise<any> => {\n    this.setState({\n      isLoading: true,\n      modalContext: undefined,\n    })\n    try {\n      await SynapseClient.deleteFormData(formDataId, token)\n      //await this.getUserFileListing(token, this.props.formGroupId)\n      this.setState((prevState, props) => ({\n        inProgress: {\n          fileList: prevState.inProgress.fileList.filter(\n            item => item.formDataId !== formDataId,\n          ),\n          nextPageToken: prevState.inProgress.nextPageToken,\n        },\n      }))\n    } catch (error) {\n      this.onError(error)\n      return []\n    } finally {\n      this.setState({\n        isLoading: false,\n      })\n    }\n  }\n\n  setModalConfirmationState = (token: string, formDataId: string) => {\n    this.setState({\n      modalContext: {\n        action: this.deleteFile,\n        arguments: [token, formDataId],\n      },\n    })\n  }\n  /* ------------------------------------------   rendering fns  ------------------------------------------------*/\n\n  renderLoading = (\n    token: string | undefined,\n    isLoading: boolean,\n  ): JSX.Element => {\n    if (token && isLoading) {\n      return (\n        <div className=\"text-center\">\n          <span>Loading&hellip;</span>\n          <span style={{ marginLeft: '2px' }} className={'spinner'} />\n        </div>\n      )\n    } else {\n      return <></>\n    }\n  }\n\n  renderUnauthenticatedView = (token: string | undefined) => {\n    if (token) {\n      return <></>\n    } else {\n      return (\n        <div className=\"panel padding-full unauthenticated text-center\">\n          Please{' '}\n          <button\n            className={`SRC-standard-button-shape SRC-light-button ${SRC_SIGN_IN_CLASS} SRC-sign-in-button`}\n          >\n            {' '}\n            sign in{' '}\n          </button>{' '}\n          to initiate or continue your submission{' '}\n        </div>\n      )\n    }\n  }\n\n  renderSubmissionsTable = (\n    fileList: FormData[],\n    pathpart: string,\n    formGroupId: string,\n    isInProgress: boolean,\n  ): JSX.Element => {\n    if (!formGroupId) {\n      this.onError('Form Group ID is undefined')\n      return <></>\n    }\n    const textSource = isInProgress\n      ? this.listingText.inProgress\n      : this.listingText.submitted\n\n    const subhead = <h4>{textSource.subhead}</h4>\n    const tableTitleRow = isInProgress ? (\n      <tr>\n        <th>Submission Name</th>\n        <th>Edited On</th>\n        <th></th>\n        <th></th>\n      </tr>\n    ) : (\n      <tr>\n        <th>Submission Name</th>\n        <th>Submitted On</th>\n        <th>Status</th>\n        <th></th>\n      </tr>\n    )\n\n    let content = (\n      <h5 className=\"text-center no-submissions padding-full\">\n        {textSource.noRecords}\n      </h5>\n    )\n    if (fileList.length > 0) {\n      content = (\n        <table className=\"table file-table\">\n          <thead>{tableTitleRow}</thead>\n          <tbody>\n            {fileList.map((dataFileRecord, key) => {\n              if (isInProgress) {\n                return (\n                  <tr key={dataFileRecord.formDataId! + key}>\n                    <td>\n                      <a\n                        href={`${pathpart}?formGroupId=${formGroupId}&formDataId=${dataFileRecord.formDataId}&dataFileHandleId=${dataFileRecord.dataFileHandleId}`}\n                      >\n                        {dataFileRecord.name}\n                      </a>\n                    </td>\n                    <td>{moment(dataFileRecord.modifiedOn).calendar()}</td>\n                    <td>&nbsp;</td>\n                    <td className=\"text-right\">\n                      <button\n                        className=\"btn\"\n                        aria-label=\"delete\"\n                        onClick={() =>\n                          this.setModalConfirmationState(\n                            this.props.token!,\n                            dataFileRecord.formDataId!,\n                          )\n                        }\n                      >\n                        <FontAwesomeIcon\n                          icon={faTrash}\n                          aria-hidden=\"true\"\n                        ></FontAwesomeIcon>\n                      </button>\n                    </td>\n                  </tr>\n                )\n              } else {\n                return (\n                  <tr key={dataFileRecord.formDataId! + key}>\n                    <td>{dataFileRecord.name}</td>\n                    <td>{moment(dataFileRecord.modifiedOn).calendar()}</td>\n                    <td>{dataFileRecord.submissionStatus.state}</td>\n                    <td className=\"text-right\">\n                      <button\n                        className=\"btn\"\n                        aria-label=\"information\"\n                        onClick={() => this.setState({ isShowInfoModal: true })}\n                      >\n                        <FontAwesomeIcon\n                          icon={faPhone}\n                          aria-hidden=\"true\"\n                        ></FontAwesomeIcon>\n                      </button>\n                    </td>\n                  </tr>\n                )\n              }\n            })}\n          </tbody>\n        </table>\n      )\n    }\n    return (\n      <>\n        {subhead} {content}\n      </>\n    )\n  }\n\n  renderSubmissionsTables = (\n    filesInProgress: FormData[],\n    filesSubmitted: FormData[],\n    pathpart: string,\n    formGroupId: string,\n  ): JSX.Element[] | JSX.Element => {\n    if (filesInProgress.length === 0 && filesSubmitted.length === 0) {\n      return (\n        <div className=\"text-center\">\n          <img src={NoSubmissionsIcon} alt=\"no submissions\"></img>\n          <p className=\"padding-full\">You have no submissions</p>\n        </div>\n      )\n    } else {\n      return [\n        this.renderSubmissionsTable(\n          filesInProgress,\n          pathpart,\n          formGroupId,\n          true,\n        ),\n\n        this.renderSubmissionsTable(\n          filesSubmitted,\n          pathpart,\n          formGroupId,\n          false,\n        ),\n      ]\n    }\n  }\n\n  render() {\n    return (\n      <div className={`SRC-ReactJsonForm ${this.props.formClass}`}>\n        {this.renderLoading(this.props.token, this.state.isLoading)}\n        {this.renderUnauthenticatedView(this.props.token)}\n\n        {!this.state.isLoading && (\n          <div className=\"file-grid \">\n            <h3>Your Submissions</h3>\n            <div className=\"panel panel-default padding-full\">\n              {this.renderSubmissionsTables(\n                this.state.inProgress.fileList,\n                this.state.submitted.fileList,\n                this.props.pathpart,\n                this.props.formGroupId,\n              )}\n\n              <div className=\"text-center\">\n                <a\n                  className=\"btn btn-large\"\n                  href={`${this.props.pathpart}?formGroupId=${this.props.formGroupId}`}\n                >\n                  Add new {this.props.itemNoun}\n                </a>\n              </div>\n            </div>\n          </div>\n        )}\n        {this.state.modalContext && (\n          <WarningModal\n            className={this.props.formClass}\n            show={typeof this.state.modalContext !== 'undefined'}\n            title={this.modalTitle}\n            copy={this.modalCopy}\n            callbackArgs={this.state.modalContext.arguments}\n            onCancel={() => this.setState({ modalContext: undefined })}\n            onOK={(token: string, formDataId: string) =>\n              this.deleteFile(token, formDataId)\n            }\n          />\n        )}\n\n        <Modal\n          show={this.state.isShowInfoModal}\n          animation={false}\n          className={this.props.formClass}\n        >\n          <Modal.Header\n            closeButton={false}\n            onHide={() => this.setState({ isShowInfoModal: false })}\n          >\n            <Modal.Title>More Information</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            Please{' '}\n            <a href=\"mailto:synapseInfo@sagebionetworks.org\">contact us</a> for\n            more information about your submission\n          </Modal.Body>\n          <Modal.Footer>\n            <Button\n              variant=\"success\"\n              onClick={() => this.setState({ isShowInfoModal: false })}\n            >\n              OK\n            </Button>\n          </Modal.Footer>\n        </Modal>\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport { library, IconProp } from '@fortawesome/fontawesome-svg-core'\nimport { faLongArrowAltUp, faLongArrowAltDown } from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nlibrary.add(faLongArrowAltUp)\nlibrary.add(faLongArrowAltDown)\nlet Parser = require('rss-parser')\nlet rssParser = new Parser()\n\ntype RssState = {\n  rssFeed: any,\n  isLoadingError: boolean,\n  isShowingMoreItems: boolean,\n  itemId2MoreItem:{}\n}\n\nexport type RssFeedProps = {\n  url: string,\n  defaultItemsToShow: number\n}\n\nconst parser = new DOMParser()\n\nexport default class RssFeed extends React.Component<RssFeedProps, RssState> {\n  constructor(props: RssFeedProps) {\n    super(props)\n    this.state = { rssFeed: {}, isLoadingError: false, isShowingMoreItems: false, itemId2MoreItem: {} }\n  }\n\n  componentDidMount() {\n    const {\n      url\n    } = this.props\n    fetch(url)\n      .then(response => response.text())\n      .then(responseData => rssParser.parseString(responseData))\n      .then(rss => this.setState({ rssFeed: rss }))\n      .catch(err => this.setState({ isLoadingError: true }))\n  }\n\n  public onToggleReadMore = (itemId: string) => (event: React.SyntheticEvent<HTMLButtonElement>) => {\n    let feedItemContentDiv = document.getElementById(itemId)\n    if (!this.state.itemId2MoreItem[itemId]) {\n      this.state.itemId2MoreItem[itemId] = {\n          text:'View full post',\n          icon: 'long-arrow-alt-down'\n      }\n    }\n    const isShow:boolean = this.state.itemId2MoreItem[itemId].text.includes('View full post')\n    if (feedItemContentDiv) {\n      let foundMoreItem:boolean = false\n      // hide or show the elements after the More element\n      for (let i = 0; i < feedItemContentDiv.children.length; i++) {\n          // skip over children until we find the id that starts with 'more-'\n          let child = feedItemContentDiv.children[i]\n          if (foundMoreItem) {\n            if (isShow) {\n              child.classList.remove('hidden')\n            } else {\n              child.classList.add('hidden')\n            }\n          } else {\n            foundMoreItem = child.id.includes('more-')\n          }\n        }\n    }\n    // toggle, by updating text and icon\n    const newText:string = isShow ? 'Hide' : 'View full post'\n    const newIcon:IconProp = isShow ? 'long-arrow-alt-up' : 'long-arrow-alt-down'\n    this.state.itemId2MoreItem[itemId] = {\n      text: newText,\n      icon: newIcon\n    }\n    this.setState({ itemId2MoreItem: this.state.itemId2MoreItem })\n  }\n\n  public onClickShowMoreItems = () => (event: React.SyntheticEvent<HTMLButtonElement>) => {\n    this.setState({isShowingMoreItems: true})\n  }\n\n  render() {\n    return (\n      <ul className=\"srcRssFeed\">\n        {\n          this.state.rssFeed.items &&\n          this.state.rssFeed.items.map((item: any, index: any) => {\n            // There are 2 \"more\" buttons here.  One is to hide long article content.  See moreElement and onClickReadMore()\n            // The other is to hide the large number of items in a particular feed (usually a max of 10 are returned).  See state.isShowingMoreItems\n            let parsedHtml = parser.parseFromString(item['content:encoded'], 'text/html')\n            let bodyElement = parsedHtml.querySelector('body')\n            let moreElement = parsedHtml.querySelector('[id^=\"more-\"]')\n            if (moreElement && bodyElement) {\n              let foundMoreElement = false\n              const children = bodyElement.children\n              for (let i = 0; i < children.length; i++) {\n                let child = children[i]\n                if (foundMoreElement) {\n                  child.classList.add('hidden')\n                }\n                if (child === moreElement) {\n                  foundMoreElement = true\n                }\n              }\n            }\n            let isItemVisible: boolean = index < this.props.defaultItemsToShow || this.state.isShowingMoreItems\n            \n            let showMoreText: string = 'View full post'\n            let showMoreIcon: IconProp = 'long-arrow-alt-down'\n            if (this.state.itemId2MoreItem[item.guid]) {\n              showMoreText = this.state.itemId2MoreItem[item.guid].text\n              showMoreIcon = this.state.itemId2MoreItem[item.guid].icon\n            }\n            return (\n              <li key={item.guid} className={`srcRssFeedItem ${isItemVisible ? '' : 'hidden'}`}>\n                <div className=\"srcRssFeedItemContent\">\n                  <div id={item.guid} dangerouslySetInnerHTML={{ __html: parsedHtml.documentElement.innerHTML }}></div>\n                  {\n                    moreElement &&\n                    <div className=\"clearfix\">\n                      <button\n                        style={{ textAlign: 'left', margin: 0, padding: '0px 50px 25px 35px' }}\n                        className=\"SRC-primary-text-color SRC-basicButton SRC-floatRight\"\n                        onClick={this.onToggleReadMore(item.guid)}\n                      >\n                        {showMoreText}\n                        <FontAwesomeIcon key={`${item.guid}${index}`}\n                          style={{ marginLeft: '5px' }}\n                          icon={showMoreIcon}\n                        />\n                      </button>\n                    </div>\n                  }\n                </div>\n              </li>\n            )\n          })\n        }\n        {\n          this.state.rssFeed.items &&\n          this.state.rssFeed.items.length > this.props.defaultItemsToShow &&\n          !this.state.isShowingMoreItems &&\n          <div className=\"clearfix\">\n            <button className=\"btn SRC-grayBackground SRC-roundBorder SRC-floatRight\" onClick={this.onClickShowMoreItems()}>View All</button>\n          </div>\n        }\n        {\n          this.state.isLoadingError &&\n          <div>\n            Unable to load feed: {this.props.url}\n          </div>\n        }\n      </ul>\n    )\n  }\n}\n","import * as React from 'react'\n\nexport type TwitterFeedProps = {\n  href: string\n}\n\nexport default class TwitterFeed extends React.Component<TwitterFeedProps> {\n  constructor(props: TwitterFeedProps) {\n    super(props)\n  }\n\n  componentDidMount() {\n    if (typeof (window as any).twttr !== 'undefined') {\n\t\t\t(window as any).twttr.widgets.load(document.getElementById(this.props.href));\n\t\t}\n  }\n\n  render() {\n    return <div>\n      <a id={this.props.href} className=\"twitter-timeline\" data-height=\"600\" data-theme=\"light\" href={this.props.href}></a>\n    </div>\n  }\n}\n","import * as React from 'react'\nimport RssFeed from './RssFeed'\nimport TwitterFeed from './TwitterFeed'\nimport MailchimpSubscribe from 'react-mailchimp-subscribe'\n\ntype MenuState = {\n  menuIndex: number\n}\n\nexport type MenuConfig = {\n  feedName: string\n  feedDescription: string\n  feedUrl: string\n  defaultItemsToShow: number\n  mailChimpListName?: string\n  mailChimpUrl?: string\n  twitterFeedUrl?: string\n}\nexport type NewsFeedMenuProps = {\n  menuConfig: MenuConfig []\n}\n\nexport default class NewsFeedMenu extends React.Component<NewsFeedMenuProps, MenuState> {\n  constructor(props: NewsFeedMenuProps) {\n    super(props)\n    // See here - https://stackoverflow.com/questions/40063468/react-component-initialize-state-from-props/47341539#47341539\n    this.state = {\n      menuIndex: 0\n    }\n    this.switchFeed = this.switchFeed.bind(this)\n  }\n\n  /**\n   * Handle user clicking menu item, event isn't used so we denote it as an _\n   *\n   * @memberof Menu\n   */\n  public switchFeed = (menuIndex: number) => (_: React.SyntheticEvent<HTMLDivElement>) => {\n    // there's an odd bug where clicking a menu item twice will select the first tab,\n    // this is a fix for that, but this shouldn't be necessary\n    if (this.state.menuIndex !== menuIndex) {\n      this.setState({ menuIndex })\n    }\n  }\n\n  public render() {\n    const menuDropdown = this.renderMenu()\n    const { menuConfig } = this.props\n    const { feedName, feedDescription, feedUrl, defaultItemsToShow, mailChimpUrl, twitterFeedUrl, mailChimpListName } = menuConfig[this.state.menuIndex]\n\n    return (\n      <div className=\"row\">\n        <div className=\"col-xs-2 SRC-menuLayout SRC-menuPadding\">\n          {menuDropdown}\n        </div>\n        <div className=\"col-xs-10\">\n          {\n            <>\n              {\n                mailChimpUrl &&\n                <div className=\"SRC-mailchimpSubscribeContainer\">\n                  <h4>Subscribe</h4>\n                  <p className=\"SRC-marginBottomTop\">Subscribe to receive the {mailChimpListName} by e-mail, which provides information and updates related to the Portal.\n                  You can opt out at any time by using the unsubscribe link within the e-mail.\n                  We will not share your information with any third parties or use it for any other purposes.</p>\n                  <div className=\"SRC-marginBottomTop\">\n                    <MailchimpSubscribe\n                      url={mailChimpUrl}\n                    />\n                  </div>\n                </div>\n              }\n              <h3 className=\"srcRssFeed\">{feedName}</h3>\n              <p>{feedDescription}</p>\n              <RssFeed\n                key={feedUrl}\n                url={feedUrl}\n                defaultItemsToShow={defaultItemsToShow}\n              />\n            </>\n          }\n          {\n            twitterFeedUrl &&\n            <TwitterFeed\n              href={twitterFeedUrl}\n            />\n          }\n        </div>\n      </div>\n    )\n  }\n\n  private renderMenu() {\n    const { menuConfig } = this.props\n    return menuConfig.map((config: MenuConfig, index: number) => {\n      const isSelected: boolean = (index === this.state.menuIndex)\n      const style: any = {}\n      let selectedStyling: string = ''\n      if (isSelected) {\n        selectedStyling = 'SRC-pointed SRC-whiteText SRC-primary-background-color SRC-pointed-triangle-right SRC-primary-background-color-border-left'\n      } else {\n        selectedStyling = 'SRC-blackText SRC-light-background'\n      }\n      return (\n        <div\n          key={config.feedName}\n          className={`SRC-hand-cursor SRC-menu-button-base SRC-gap SRC-hoverWhiteText SRC-primary-background-color-hover ${selectedStyling}`}\n          onClick={this.switchFeed(index)}\n          role=\"button\"\n          tabIndex={0}\n          style={style}\n        >\n          {config.feedName}\n        </div>\n      )\n    })\n  }\n}","import * as React from 'react'\nimport CardContainerLogic from '../../../lib/containers/CardContainerLogic'\nimport { SynapseConstants } from '../../../lib'\nimport { GenericCardSchema } from '../../../lib/containers/GenericCard'\nimport brainSvg from './icons/brain.svg'\nimport circleSvg from './icons/circle.svg'\nimport mouseSvg from './icons/mouse.svg'\nimport resilienceadSvg from './icons/resiliencead.svg'\n\nexport default class CardContainerLogicDemo extends React.Component {\n\n  constructor(props: any) {\n    super(props)\n    this.state = {}\n  }\n\n  render() {\n    const iconOptions = {\n      'AMP-AD': circleSvg,\n      'M2OVE-AD': brainSvg,\n      'MODEL-AD': mouseSvg,\n      'Resilience-AD': resilienceadSvg\n    }\n    // @ts-ignore\n    const genericToolSchema: GenericCardSchema = {\n      type: 'Tool',\n      title: 'name',\n      subTitle: 'contact',\n      description: 'summary',\n      icon: 'type',\n      link: 'link',\n      secondaryLabels: ['subtype', 'disease', 'manifestation','Sample_Type','fundingAgency','studyName']\n    }\n    const genericCardSchemaHeader: GenericCardSchema = {\n      type: 'PROGRAM',\n      title: 'Full Name',\n      subTitle: 'Short Description',\n      description: 'Long Description',\n      icon: 'Program',\n      secondaryLabels: ['Full Name']\n    }\n    // @ts-ignore\n    const genericCardSchema: GenericCardSchema = {\n      type: 'Study',\n      title: 'Study_Name',\n      subTitle: 'Data_Contributor',\n      description: 'Study_Description',\n      icon: 'Access_Type',\n      secondaryLabels: [\n        'DataType_All',\n        'Diagnosis_or_Model_System',\n        'Number_of_Individuals',\n        'Sample_Type',\n        'Species' ,\n        'Cohort_Type',\n        'Study_Status',\n        'Consortium',\n        'Grant',\n      ]\n    }\n    return (\n      <div>\n        <hr/>\n        <p> Generic Card Rendering </p>\n        <CardContainerLogic\n          type={SynapseConstants.GENERIC_CARD}\n          // tslint:disable-next-line\n          sql={\"SELECT * FROM syn17024173\"}\n          searchParams={{ Program: 'AMP-AD' }}\n          genericCardSchema={genericCardSchemaHeader}\n          backgroundColor={'#5960a5'}\n          isHeader={true}\n          iconOptions={iconOptions}\n        />\n        {/* <div className=\"container-fluid\">\n          <div className=\"row\">\n            <div className=\"col-md-10 col-md-offset-1\">\n              <CardContainerLogic\n                type={SynapseConstants.GENERIC_CARD}\n                sql={'SELECT * FROM syn16859448'}\n                unitDescription=\"studies\"\n                genericCardSchema={genericToolSchema}\n                secondaryLabelLimit={3}\n              />\n            </div>\n          </div>\n        </div> */}\n        <CardContainerLogic\n          type={SynapseConstants.MEDIUM_USER_CARD}\n          sql={'SELECT ownerID as ownerId FROM syn13897207'}\n          loadingScreen={<div> Im loading as fast I can !!! </div>}\n        />\n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport QueryWrapper from 'lib/containers/QueryWrapper'\nimport Search, { Searchable } from 'lib/containers/Search'\nimport { SynapseConstants } from 'lib'\nimport { GenericCardSchema } from 'lib/containers/GenericCard'\nimport { CommonCardProps } from 'lib/containers/CardContainerLogic'\nimport CardContainer from 'lib/containers/CardContainer';\n\nexport const SearchDemo:React.SFC = () => {\n  const sql = \"SELECT * FROM syn20337467\" \n  const facetAliases = {\n    contributor: 'Contributor',\n    diagnosis: 'Diagnosis',\n  }\n  const searchable: Searchable = [\n    {\n      columnName: 'summary', \n      hintText: 'summary'\n    },\n    {\n      columnName: 'contributor', \n      hintText: 'Jane'\n    },\n    {\n      columnName: 'diagnosis',\n      hintText: 'LOAD'\n    },\n    {\n      columnName: 'modelType',\n      hintText: 'hint'\n    },\n  ]\n  const genericCardSchema: GenericCardSchema = {\n    title: 'Title',\n    type: 'Generic Tool',\n    subTitle: 'softwareType',\n    description: 'summary',\n    icon: 'icon',\n    secondaryLabels: [\n      'contributor',\n      'diagnosis',\n      'program'\n    ]\n  }\n  const commonCardProps: CommonCardProps = {\n    type: SynapseConstants.GENERIC_CARD,\n    genericCardSchema,\n  }\n  return (\n    <div className=\"col-xs-8 col-xs-offset-2\">\n      <QueryWrapper\n        facetAliases={facetAliases}\n        rgbIndex={5}\n        initQueryRequest={{\n          concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',\n          partMask: SynapseConstants.BUNDLE_MASK_QUERY_COLUMN_MODELS |\n            SynapseConstants.BUNDLE_MASK_QUERY_FACETS |\n            SynapseConstants.BUNDLE_MASK_QUERY_SELECT_COLUMNS |\n            SynapseConstants.BUNDLE_MASK_QUERY_COUNT |\n            SynapseConstants.BUNDLE_MASK_QUERY_RESULTS,\n          query: {\n            sql,\n            limit: 25,\n            offset: 0\n          }\n        }}\n        showBarChart={false}\n        unitDescription={'studies'}\n        >\n        <Search\n          searchable={searchable}\n          isQueryWrapperMenuChild={false}\n        />\n        <CardContainer\n          {...commonCardProps}\n        />\n      </QueryWrapper>\n    </div>\n  )\n}\n\nexport default SearchDemo","import * as React from 'react'\nimport ModalDownload from '../../../lib/containers/ModalDownload'\n\ntype State = {\n  showModal: boolean\n}\n\nclass ModalDownloadDemo extends React.Component<{}, State> {\n\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      showModal: false\n    }\n  }\n\n  onClose = () => {\n    this.setState({\n      showModal: false\n    })\n  }\n\n  onOpen = () => {\n    console.log('opening')\n    this.setState({\n      showModal: true\n    })\n  }\n\n  render () {\n    return (\n      <div className=\"container\">\n        <button onClick={this.onOpen} className=\"btn btn-primary\" > Show ModalDownload </button>\n        {\n          this.state.showModal\n          &&\n          <ModalDownload\n            sql={'SELECT * from syn17328596'}\n            entityId={'syn17328596'}\n            onClose={this.onClose}\n          />\n        }\n      </div>\n    )\n  }\n}\n\nexport default ModalDownloadDemo","import * as React from 'react'\nimport UserCard from '../../../lib/containers/UserCard'\nimport { SynapseConstants } from '../../../lib'\nimport MarkdownSynapse from '../../../lib/containers/MarkdownSynapse'\n\nexport default class UserBadgeSmallDemo extends React.Component<any, any> {\n  constructor(props: any) {\n    super(props)\n  }\n  public render() {\n    const profiles = [\n      '3376985',\n      '1131050',\n      '273960',\n      '3346401',\n      '3374422',\n      '273950',\n      '273950',\n    ]\n    return (\n      <React.Fragment>\n        <div className=\"container\">\n          <div className=\"row\">\n            <h3>User Card Small </h3>\n             <p> sans photo- </p>\n            <UserCard\n              ownerId={'273950'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <p> without text </p>\n            <UserCard\n              ownerId={'3374422'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <hr/>\n             <p> with custom link- </p>\n            <UserCard\n              ownerId={'273950'}\n              size={SynapseConstants.SMALL_USER_CARD}\n              link={'https://google.com'}\n            />\n            <UserCard\n              ownerId={'3374422'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n              link={'https://google.com'}\n            />\n            <hr/>\n            <p> without tooltip </p>\n            <div className=\"SRC-centerContent\">\n              <UserCard\n                ownerId={'3374422'}\n                hideTooltip={true}\n                size={SynapseConstants.SMALL_USER_CARD}\n              />\n              <UserCard\n                ownerId={'3346401'}\n                hideTooltip={true}\n                size={SynapseConstants.SMALL_USER_CARD}\n              />\n            </div>\n            <hr/>\n            <p> with photo- </p>\n            <UserCard\n              ownerId={'3346401'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <UserCard\n              ownerId={'1131050'}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <p> without text- </p>\n            <UserCard\n              ownerId={'273960'}\n              hideText={true}\n              size={SynapseConstants.SMALL_USER_CARD}\n            />\n            <hr/>\n            <p>inside of markdown-</p>\n              <MarkdownSynapse\n                wikiId={'588827'}\n                ownerId={'syn18380882'}\n              />\n          </div>\n          <div className=\"row\">\n            <h3> User Card Large </h3>\n            <p> with photo- </p>\n            <UserCard\n              ownerId={'1131050'}\n              // tslint:disable-next-line:jsx-no-lambda\n              size={SynapseConstants.LARGE_USER_CARD}\n              menuActions={[\n                {\n                  field: 'Projects',\n                  callback: (userProfile) => { console.log(userProfile) }\n                },\n                {\n                  field: 'Profile',\n                  callback: (userProfile) => { console.log(userProfile) }\n                },\n                {\n                  field: 'SEPERATOR',\n                },\n                {\n                  field: 'Teams',\n                  callback: (userProfile) => { console.log(userProfile) }\n                }\n              ]}\n            />\n            <br/>\n            <p> sans photo- </p>\n            <br/>\n            <UserCard\n              ownerId={'3374422'}\n              size={SynapseConstants.LARGE_USER_CARD}\n            />\n            <br/>\n            <br/>\n            <UserCard\n              ownerId={'345424'}\n              size={SynapseConstants.LARGE_USER_CARD}\n              menuActions={[\n                {\n                  field: 'Projects',\n                  callback: (userProfile) => { console.log(userProfile) }\n                },\n                {\n                  field: 'Profile',\n                  callback: (userProfile) => { console.log(userProfile) }\n                },\n                {\n                  field: 'SEPERATOR',\n                },\n                {\n                  field: 'Teams',\n                  callback: (userProfile) => { console.log(userProfile) }\n                }\n              ]}\n            />\n          </div>\n        </div>\n        <h3> User Card Medium Wrapping Example </h3>\n        <div className=\"SRC-card-grid-row\">\n          {\n            [1, 2, 3, 4, 5].map(\n              (_el, index) => {\n                return (\n                  <div className=\"SRC-grid-item\" key={index}>\n                    <UserCard\n                      hideEmail={(index % 2) === 0}\n                      menuActions={[\n                        {\n                          field: 'Projects',\n                          callback: (userProfile) => { console.log(userProfile) }\n                        },\n                        {\n                          field: 'Profile',\n                          callback: (userProfile) => { console.log(userProfile) }\n                        },\n                        {\n                          field: 'SEPERATOR',\n                        },\n                        {\n                          field: 'Teams',\n                          callback: (userProfile) => { console.log(userProfile) }\n                        }\n                      ]}\n                      ownerId={profiles[index]}\n                      size={SynapseConstants.MEDIUM_USER_CARD}\n                      link={index % 2 ? 'https://google.com' : ''}\n                    />\n                  </div>\n                )\n              }\n            )\n          }\n        </div>\n      </React.Fragment>\n    )\n  }\n}\n","import * as React from 'react'\nimport MarkdownSynapse, { MarkdownSynapseProps } from '../../../lib/containers/MarkdownSynapse'\n\ntype State = {\n  index: number,\n  markdownPropsArray: MarkdownSynapseProps []\n}\n\nexport default class MarkdownSynapseDemo extends React.Component<{}, State> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      index: 5,\n      markdownPropsArray: [\n        {\n          // footnotes with html\n          ownerId: 'syn3157182'\n        },\n        {\n          // with details tag \n          ownerId: 'syn12666371',\n          wikiId: '585317'\n        },\n        {\n          //  with references \n          ownerId:'syn17100797',\n          wikiId: '587923'\n        },\n        {\n          // with  toc \n          ownerId:'syn17100797',\n          wikiId: '587923'\n        },\n        {\n          ownerId: 'syn18142975'\n        },\n        {\n          // nested link\n          ownerId: 'syn12666371',\n          wikiId: '595383',\n        },\n      ]\n    }\n  }\n  render() {\n    const {\n      index,\n      markdownPropsArray\n    } = this.state\n    const props = markdownPropsArray[index]\n    return (\n      <div className=\"container\">\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({index: 0})}}\n        >\n          Footnotes with html\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({index: 1})}}\n        >\n          Details tag \n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({index: 2})}}\n        >\n           References \n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({index: 2})}}\n          >\n          Table of Contents\n        </button>\n        <button\n          className=\"btn btn-default\"\n          onClick={() => {this.setState({index: 4})}}\n          >\n          Show nested anchor\n        </button>\n        {/* footnotes with html */}\n        <MarkdownSynapse\n          {...props}\n        />      \n      </div>\n    )\n  }\n}\n","import * as React from 'react'\nimport NewsFeedMenu from '../../../lib/containers/NewsFeedMenu'\n\nexport const NewsFeedDemo:React.SFC = () => {\n  return (\n    <NewsFeedMenu\n      menuConfig={[\n        {\n          feedName:'Data Releases',\n          feedDescription:'The AMP-AD Knowledge Portal releases new Alzheimer\\'s disease data twice annually, in May and November. Data releases may include new data, analyses, and results; as well as changes and updates to previously released data.',\n          feedUrl:'https://portalnews.wpengine.com/?feed=rss2&cat=4',\n          defaultItemsToShow:3,\n        },\n        {\n          feedName:'Updates',\n          feedDescription:'The AMP-AD Knowledge Portal reaches the broader scientific community through multiple channels that encourage open-science collaborations. News updates include videos, events, and presentations that highlight the community behind the data.',\n          feedUrl:'https://portalnews.wpengine.com/?feed=rss2&cat=3',\n          defaultItemsToShow:3,\n          twitterFeedUrl:'https://twitter.com/AMPADPortal?ref_src=twsrc%5Etfw'\n        },\n        {\n          feedName:'Newsletter',\n          feedDescription:'The AMP-AD Knowledge Portal sends a quarterly newsletter to interested members of the scientific community, delivering consolidated information and updates related to the Portal.',\n          feedUrl:'https://portalnews.wpengine.com/?feed=rss2&cat=5',\n          defaultItemsToShow:3,\n          mailChimpListName:'AMP-AD quarterly newsletter',\n          mailChimpUrl:'https://sagebase.us7.list-manage.com/subscribe/post?u=b146de537186191a9d2110f3a&amp;id=96b614587a'\n        },\n      ]}\n    />\n  )\n}\n\n\n","import * as React from 'react'\nimport { TokenContext } from '../App'\nimport { FormGroup, FormData, ListRequest, ListResponse, StatusEnum } from 'lib/utils/jsonResponses/Forms'\nimport { SynapseClient } from 'lib'\nimport { FileUploadComplete } from 'lib/utils/jsonResponses/FileUploadComplete'\n\ntype FormServicesIntegrationDemoState = {\n  token?: string\n  formGroup?: FormGroup\n  formData?: FormData\n  myFormDataList?: ListResponse\n  formAdminFormDataList?: ListResponse\n}\n\nclass FormServicesIntegrationDemo extends React.Component<{}, FormServicesIntegrationDemoState> {\n\n  constructor(props: any) {\n    super(props)\n    this.state = {\n    }\n    this.onCreateFormGroup = this.onCreateFormGroup.bind(this)\n    this.onCreateFormData = this.onCreateFormData.bind(this)\n    this.onUpdateFormData = this.onUpdateFormData.bind(this)\n    this.onSubmitFormData = this.onSubmitFormData.bind(this)\n    this.listMyFormData = this.listMyFormData.bind(this)\n    this.listFormAdminFormData = this.listFormAdminFormData.bind(this)\n    this.onReadFormDataFileHandleContents = this.onReadFormDataFileHandleContents.bind(this)\n  }\n\n  public onCreateFormGroup(): void {\n    SynapseClient.createFormGroup('DrugUploadTool(production)', this.state.token!)\n      .then((data: FormGroup) => {\n        console.log('Successfully created FormGroup', data)\n        this.setState({ formGroup: data })\n      })\n      .catch((error: any) => console.error('Failed to create form group', error))\n  }\n  public onUpdateFormData(): void {\n    SynapseClient.uploadFile(this.state.token, 'my test file', new Blob(['hello form data 2'])).then((fileUploadComplete: FileUploadComplete) => {\n      console.log('Successfully created test file handle, now update the form data!')\n      SynapseClient.updateFormData(this.state.formData!.formDataId!, 'my test form data', fileUploadComplete.fileHandleId, this.state.token!)\n        .then((data: FormData) => {\n          console.log('Successfully updated FormData', data)\n          this.setState({ formData: data })\n        })\n        .catch((error: any) => console.error('Failed to update FormData', error))\n    }).catch((error: any) => console.error('Failed to update a new file handle:', error))\n  }\n\n  public onCreateFormData(): void {\n    SynapseClient.uploadFile(this.state.token, 'my test file', new Blob(['hello form data'])).then((fileUploadComplete: FileUploadComplete) => {\n      console.log('Successfully created test file handle, now create the form data!')\n      SynapseClient.createFormData(this.state.formGroup!.groupId!, 'my test form data', fileUploadComplete.fileHandleId, this.state.token!)\n        .then((data: FormData) => {\n          console.log('Successfully created FormData', data)\n          this.setState({ formData: data })\n        })\n        .catch((error: any) => console.error('Failed to create FormData', error))\n    }).catch((error: any) => console.error('Failed to create a new file handle:', error))\n  }\n\n  public onSubmitFormData(): void {\n    SynapseClient.submitFormData(this.state.formData!.formDataId!, this.state.token!)\n      .then((data: FormData) => {\n        console.log('Successfully submitted FormData', data)\n      })\n      .catch((error: any) => console.error('Failed to submit form data', error))\n  }\n\n  private listMyFormData = () => {\n    if (this.state.token && this.state.formGroup && !this.state.myFormDataList) {\n      let request: ListRequest = {\n        groupId: this.state.formGroup.groupId!,\n        filterByState: [StatusEnum.ACCEPTED, StatusEnum.SUBMITTED_WAITING_FOR_REVIEW, StatusEnum.WAITING_FOR_SUBMISSION]\n      }\n      SynapseClient.listFormData(request, this.state.token).then((resp: ListResponse) => {\n        console.log('Successfully got a my FormData list', resp)\n        this.setState({ myFormDataList: resp })\n      }).catch((error: any) => console.error('Failed to get my FormData list', error))\n    }\n  }\n\n  private listFormAdminFormData = () => {\n    if (this.state.token && this.state.formGroup && !this.state.formAdminFormDataList) {\n      let request: ListRequest = {\n        groupId: this.state.formGroup.groupId!,\n        filterByState: [StatusEnum.ACCEPTED, StatusEnum.SUBMITTED_WAITING_FOR_REVIEW]\n      }\n      SynapseClient.listFormDataAsFormAdmin(request, this.state.token).then((resp: ListResponse) => {\n        console.log('Successfully got FormGroup admin list', resp)\n        this.setState({ formAdminFormDataList: resp })\n      }).catch((error: any) => console.error('Failed to get FormGroup admin FormData list', error))\n    }\n  }\n\n  private onReadFormDataFileHandleContents = () => {\n    SynapseClient.getFileHandleContentFromID(this.state.formData!.dataFileHandleId, this.state.token!)\n    .then((data: string) => {\n      console.log('Successfully fetched file handle contents: ', data)\n    })\n    .catch((error: any) => console.error('Failed to read form data file handle contents', error))\n\n  }\n\n  public componentDidUpdate() {\n    this.listMyFormData()\n    this.listFormAdminFormData()\n  }\n\n  render() {\n    return (\n      <TokenContext.Consumer>\n        {\n          (token: string) => {\n            if (token !== this.state.token) {\n              this.setState({\n                token\n              })\n            }\n            if (token) {\n              return <>\n                <div>\n                  <a\n                    onClick={this.onCreateFormGroup}\n                  >\n                    Create Form Group\n                    <br />\n                  </a>\n                  {\n                    !this.state.formData && <a\n                      onClick={this.onCreateFormData}\n                    >\n                      Create Form Data\n                      <br />\n                  </a>\n                  }\n                  {\n                    this.state.formData && <a\n                      onClick={this.onReadFormDataFileHandleContents}\n                    >\n                      Get Form Data FileHandle contents\n                      <br />\n                  </a>\n                  }\n\n                  {\n                    this.state.formData && <a\n                      onClick={this.onUpdateFormData}\n                    >\n                      Update Form Data\n                      <br />\n                  </a>\n                  }\n                  {\n                    this.state.formData && <a\n                      onClick={this.onSubmitFormData}\n                    >\n                      Submit Form Data\n                      <br />\n                  </a>\n                  }\n                </div>\n                {\n                  <h3>My FormData</h3>\n                }\n                {\n                  (this.state.myFormDataList) &&\n                  <table>\n                   <thead>\n                    <tr><th>Form Data name</th><th>Data File Handle ID</th><th>Status</th><th>Rejection Reason</th></tr>\n                    </thead>\n                    <tbody>\n                    {this.state.myFormDataList.page.map((value) => {\n                      return <tr><td>{value.name}</td><td>{value.dataFileHandleId}</td><td>{value.submissionStatus.state}</td><td>{value.submissionStatus.rejectionMessage}</td></tr>\n                    })}\n                    </tbody>\n                  </table>\n                }\n                {\n                  <h3>FormGroup Admin FormData</h3>\n                }\n                {\n                  (this.state.formAdminFormDataList) &&\n                  <table>\n                    <thead>\n                    <tr><th>Form Data name</th><th>Data File Handle ID</th><th>Status</th><th>Rejection Reason</th></tr>\n                    </thead>\n                    <tbody>\n                    {this.state.formAdminFormDataList.page.map((value) => {\n                      return <tr><td>{value.name}</td><td>{value.dataFileHandleId}</td><td>{value.submissionStatus.state}</td><td>{value.submissionStatus.rejectionMessage}</td></tr>\n                    })}\n                    </tbody>\n                  </table>\n                }\n              </>\n            } else return <><p>Please log in and reload this route</p></>\n          }\n        }\n      </TokenContext.Consumer>\n    )\n  }\n}\n\nexport default FormServicesIntegrationDemo","import * as React from 'react'\nimport { Link, Route, match } from 'react-router-dom'\nimport QueryWrapperMenuDemo from './QueryWrapperMenuDemo'\nimport CardContainerLogicDemo from './CardContainerLogicDemo'\nimport SearchDemo from './SearchDemo'\nimport ModalDownloadDemo from './ModalDownloadDemo'\nimport UserCardDemo from './UserCardDemo'\nimport MarkdownSynapseDemo from './MarkdownSynapseDemo'\nimport { NewsFeedDemo } from './NewsFeedDemo'\nimport FormServicesIntegrationDemo from './FormServicesIntegrationDemo'\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\nconst App = ({ match }: { match: match }) => {\n  return (\n      <div>\n        <h2>Links to components under development </h2>\n        <ul>\n          <li>\n            <Link to={`${match.url}/QueryWrapperMenuDemo`}>QueryWrapperMenuDemo</Link>\n          </li>\n          <li>\n            <Link to={`${match.url}/SearchDemo`}>SearchDemo</Link>\n          </li>\n          <li>\n            <Link to={`${match.url}/CardContainerLogicDemo`}>CardContainerLogicDemo</Link>\n          </li>\n          <li>\n            <Link to={`${match.url}/UserBadgeDemo`}>UserBadgeDemo</Link>\n          </li>\n          <li>\n            <Link to={`${match.url}/MarkdownSynapseDemo`}>MarkdownSynapseDemo</Link>\n          </li>\n          <li>\n            <Link to={`${match.url}/NewsFeedDemo`}>NewsFeedDemo</Link>\n          </li>\n          <li>\n            <Link to={`${match.url}/FormServicesIntegrationDemo`}>FormServicesIntegrationDemo</Link>\n          </li>\n\n          <li>\n            <Link to={`${match.url}/ModalDownloadDemo`}>ModalDownload</Link>\n          </li>\n        </ul>\n\n        <Route\n          exact={true}\n          path={`${match.url}/QueryWrapperMenuDemo`}\n          render={() => <QueryWrapperMenuDemo rgbIndex={0}/>}\n        />\n\n        <Route\n          exact={true}\n          path={`${match.url}/SearchDemo`}\n          render={() => <SearchDemo />}\n        />\n\n        <Route\n          exact={true}\n          path={`${match.url}/CardContainerLogicDemo`}\n          component={CardContainerLogicDemo}\n        />\n\n        <Route\n          exact={true}\n          path={`${match.url}/UserBadgeDemo`}\n          component={() => <UserCardDemo/>}\n        />\n\n        <Route\n          exact={true}\n          path={`${match.url}/MarkdownSynapseDemo`}\n          component={() => <MarkdownSynapseDemo/>}\n        />\n        <Route\n          exact={true}\n          path={`${match.url}/NewsFeedDemo`}\n          component={() => <NewsFeedDemo/>}\n        />\n        <Route\n          exact={true}\n          path={`${match.url}/FormServicesIntegrationDemo`}\n          component={() => <FormServicesIntegrationDemo/>}\n        />\n        <Route\n          exact={true}\n          path={`${match.url}/ModalDownloadDemo`}\n          component={() => <ModalDownloadDemo/>}\n        />\n\n        <Route\n          exact={true}\n          path={match.path}\n          component={() => <div/>}\n        />\n\n      </div>\n  )\n}\n\nexport default App\n","import * as React from 'react';\nimport { Link, BrowserRouter as Router, Route } from 'react-router-dom'\nimport Login from '../../lib/containers/Login'\nimport logoSvg from '../../images/logo.svg'\nimport '../style/App.scss'\nimport '../style/DemoStyle.scss'\nimport Demo from './Demo'\nimport Playground from './playground/Playground'\nimport DrugUploadTool from '../../lib/containers/drug_upload_tool/DrugUploadTool'\nimport FileGrid from '../../lib/containers/drug_upload_tool/UserFileGrid'\nimport { SynapseClient } from '../../lib/utils/'\n\n/**\n * Demo of features that can be used from src/demo/utils/SynapseClient\n * module\n */\n\ntype AppState = {\n  token: string\n}\nexport const TokenContext = React.createContext('')\n\nexport default class App extends React.Component<{}, AppState> {\n  constructor(props: any) {\n    super(props)\n    this.state = {\n      token: '',\n    }\n  }\n\n  handleChange = (updatedState: {}): void => {\n    this.setState(updatedState)\n  }\n\n  public componentDidMount() {\n    // Note:  All portals should do this once on the initial app load.\n    // This looks for the session token cookie (HttpOnly, unable to directly access), and initialize the session if it does exists.\n    SynapseClient.detectSSOCode()\n    SynapseClient.getSessionTokenFromCookie()\n      .then((sessionToken: any) => this.handleChange({ token: sessionToken }))\n      .catch((error: any) => {\n        console.error(error)\n      })\n  }\n\n  renderLoginAndSignout(token: string): JSX.Element {\n    const signedInState = (\n      <div className=\"bg-success text-center\" role=\"alert\">\n        You are logged in.&nbsp;\n        <button\n          onClick={() => {\n            SynapseClient.signOut()\n          }}\n        >\n          <span aria-hidden=\"true\">Sign out</span>\n        </button>\n      </div>\n    )\n\n    const notSignedInState = (\n      <div className=\"text-center\">\n        <h4>Synapse Production (Google SSO redirects here)</h4>\n        <Login\n          token={SynapseClient.IS_DEV_ENV ? token : this.state.token}\n          theme={'light'}\n          icon={true}\n        />\n        <hr />\n        <h4>Synapse Staging (Google SSO redirects to staging site)</h4>\n        <Login\n          token={SynapseClient.IS_DEV_ENV ? token : this.state.token}\n          theme={'dark'}\n          icon={true}\n          googleRedirectUrl={\n            'https://staging.synapse.org/Portal/oauth2callback?oauth2provider=GOOGLE_OAUTH_2_0'\n          }\n          repoEndpoint={'https://repo-staging.prod.sagebase.org/'}\n          swcEndpoint={'https://staging.sagebase.org/'}\n        />\n        <hr />\n      </div>\n    )\n\n    if (token && token !== '') {\n      return signedInState\n    } else {\n      return notSignedInState\n    }\n  }\n\n  public render(): JSX.Element {\n    return (\n      <TokenContext.Provider value={this.state.token}>\n        <Router basename={process.env.PUBLIC_URL}>\n          <div>\n            <div className=\"App-header text-center\">\n              <img src={logoSvg} className=\"App-logo\" alt=\"logo\" />\n              <h4 className=\"white-text\">Synapse React Client Demo</h4>\n            </div>\n            {this.renderLoginAndSignout(this.state.token)}\n            <ul>\n              <li>\n                <Link to=\"/\">Demo</Link>\n              </li>\n              <li>\n                <Link to=\"/Playground\">Playground</Link>\n              </li>\n              <li>\n                <Link to=\"/drugUploadTool\">DrugUploadTool</Link>\n              </li>\n              <li>\n                <Link to=\"/contribReqForm\">ContribReq</Link>\n              </li>\n            </ul>\n\n            <Route exact={true} path=\"/\" component={Demo} />\n            <Route path=\"/Playground\" component={Playground} />\n            <Route\n              exact={true}\n              path=\"/drugUploadTool\"\n              render={props => {\n                const searchParamsProps: any = {}\n                // https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams -- needs polyfill for ie11\n                const searchParams = new URLSearchParams(props.location.search)\n                searchParams.forEach((value, key) => {\n                  searchParamsProps[key] = value\n                })\n                return !props.location.search ? (\n                  <FileGrid\n                    pathpart=\"drugUploadTool\"\n                    token={this.state.token}\n                    formClass=\"drug-upload-tool\"\n          \n                    formGroupId=\"9\"\n                    itemNoun=\"Compound\"\n                  />\n                ) : (\n                  <DrugUploadTool\n                    {...props}\n           \n                    formSchemaEntityId=\"syn20680102\"\n                    fileNamePath=\"naming.compound_name\"\n                    formUiSchemaEntityId=\"syn20693568\"\n                    formNavSchemaEntityId=\"syn20680027\"\n                    token={this.state.token}\n                    formTitle=\"Your Submission\"\n                    formClass=\"drug-upload-tool\"\n                    searchParams={searchParamsProps}\n                  />\n                )\n              }}\n            />\n\n            {/*------------------- contributions request form ---------------------------------*/}\n            <Route\n              exact={true}\n              path=\"/contribReqForm\"\n              render={props => {\n                let searchParamsProps: any = {}\n                // https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams -- needs polyfill for ie11\n                const searchParams: any = new URLSearchParams(\n                  props.location.search,\n                )\n                const iter = searchParams.entries()\n                let result = iter.next()\n                while (!result.done) {\n                  const [key, value] = result.value\n                  searchParamsProps[key] = value\n                  result = iter.next()\n                }\n                console.log('rendering line 162')\n                return !props.location.search ? (\n                  <FileGrid\n                    pathpart=\"contribReqForm\"\n                    formGroupId=\"5\"\n                    token={this.state.token}\n                    formClass=\"contribution-request\"\n                    itemNoun={'Nomination'}\n                  />\n                ) : (\n                  <DrugUploadTool\n                    {...props}\n                    formSchemaEntityId=\"syn20692910\"\n                    formUiSchemaEntityId=\"syn20692911\"\n                    formNavSchemaEntityId=\"syn20692912\"\n                    isWizardMode={true}\n                    token={this.state.token}\n                    formTitle=\"Your Submission\"\n                    formClass=\"contribution-request\"\n                    fileNamePath=\"study.submission_name\"\n                  />\n                )\n              }}\n            />\n          </div>\n        </Router>\n      </TokenContext.Provider>\n    )\n  }\n}\n","import * as React from 'react'\nimport * as ReactDOM from 'react-dom'\nimport 'react-app-polyfill/ie11'\nimport 'react-app-polyfill/stable'\nimport App from './demo/containers/App'\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n)\n","module.exports = __webpack_public_path__ + \"static/media/Data2.1104e430.svg\";","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","module.exports = __webpack_public_path__ + \"static/media/columns.94835d60.svg\";","module.exports = __webpack_public_path__ + \"static/media/expand.2b935894.svg\";","module.exports = __webpack_public_path__ + \"static/media/shrink.199a8060.svg\";","module.exports = __webpack_public_path__ + \"static/media/Publication.b630024c.svg\";","module.exports = __webpack_public_path__ + \"static/media/study-active.bc52e72b.svg\";","module.exports = __webpack_public_path__ + \"static/media/study.79d24d74.svg\";","module.exports = __webpack_public_path__ + \"static/media/study-complete.b012f80b.svg\";","module.exports = __webpack_public_path__ + \"static/media/DNA_Two.d8f80972.svg\";","module.exports = __webpack_public_path__ + \"static/media/ToolClinical.ca6b9056.svg\";","module.exports = __webpack_public_path__ + \"static/media/ToolComputational.b3b0a1a1.svg\";","module.exports = __webpack_public_path__ + \"static/media/ToolExperimental.30e19c72.svg\";","module.exports = __webpack_public_path__ + \"static/media/project.28806f03.svg\";","module.exports = __webpack_public_path__ + \"static/media/ctf.4eb55044.svg\";","module.exports = __webpack_public_path__ + \"static/media/dhart.e554b25a.svg\";","module.exports = __webpack_public_path__ + \"static/media/ntap.e9543055.svg\";","module.exports = __webpack_public_path__ + \"static/media/amp-icon-header.71a5e101.svg\";","module.exports = __webpack_public_path__ + \"static/media/amp-icon.3593ecd7.svg\";","module.exports = __webpack_public_path__ + \"static/media/move-icon-header.dd07eaeb.svg\";","module.exports = __webpack_public_path__ + \"static/media/move-icon.2f85f6de.svg\";","module.exports = __webpack_public_path__ + \"static/media/ModelAD-icon-header.d2e9fd8e.svg\";","module.exports = __webpack_public_path__ + \"static/media/ModelAD-icon.e37944bf.svg\";","module.exports = __webpack_public_path__ + \"static/media/resilience-icon-header.595fa5fa.svg\";","module.exports = __webpack_public_path__ + \"static/media/resilience-icon.b1a30ae3.svg\";","module.exports = __webpack_public_path__ + \"static/media/json-form-tool-no-submissions.e64940c0.svg\";","module.exports = __webpack_public_path__ + \"static/media/brain.c6301611.svg\";","module.exports = __webpack_public_path__ + \"static/media/circle.ed6d433a.svg\";","module.exports = __webpack_public_path__ + \"static/media/mouse.7e294e96.svg\";","module.exports = __webpack_public_path__ + \"static/media/resiliencead.7500217a.svg\";"],"sourceRoot":""}